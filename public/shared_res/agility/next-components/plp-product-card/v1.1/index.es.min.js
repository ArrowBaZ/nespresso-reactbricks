const e=e=>{const i=(e=>e.find((e=>"data"===e.nodeName)))([...e]),s=[...e].filter((e=>"data"!==e.nodeName)).reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{});if(t(i))return s;try{return{...s,...JSON.parse(i.nodeValue)}}catch(e){console.log("ERROR: No data",e)}},t=e=>null==e;class i extends HTMLElement{constructor(){super(),this.props={},this.labels=[]}connectedCallback(){this.props=e(this.attributes),this.render()}render(){const{labels:e=[],direction:t="column"}=this.props;if(this.classList.add(""+("row"===t?"direction-row":"direction-"+t)),0===e.length)return"";this.labels=e,this.innerHTML=`${this.renderLabels()}`}renderLabels(){return this.labels.map((e=>{const{name:t="",bgColor:i="",color:s=""}=e;return`<mark class="t-3xs-500"\n                            ${i&&s&&`style="background: ${i}; color: ${s}"`}>\n                            <span aria-hidden="true">${t}</span>\n                            <span class="sr-only">${t}</span>\n                        </mark>`})).join("")}}customElements.get("nb-card-labels")||customElements.define("nb-card-labels",i);const s=()=>{const e=window[window?.padlNamespace]?.dataLayer;return e?e.app.app.market.toLocaleLowerCase():"ch"},n={fair_trade:"https://www.nespresso.com/shared_res/agility/commons/img/icons/fairTrade.svg",is_organic:function(){let e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-eu.svg";switch(s()){case"us":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-us.svg";break;case"ca":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-ca.svg";break;case"br":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-br.svg";break;case"jp":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-jp.svg";break;case"be":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-be.png"}return e}(),only_vertuo_next:"https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-only-vertuo-next.svg",is_q_certified_arabica:"https://www.nespresso.com/shared_res/agility/commons/img/icons/q_grade_certification_arabica.svg",is_rainforest:"https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-rainforest.svg",is_sustainable:"https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-sustainability.svg",is_design_award_2021:"https://www.nespresso.com/shared_res/agility/commons/img/icons/design_award_2021.svg"};class a extends HTMLElement{constructor(){super(),this.props={}}connectedCallback(){this.props=e(this.attributes),this.render()}render(){let e,t,i,s,a,r,o,l,c,d,h,p,{direction:u="row",logos:_}=this.props;this.classList.add(""+("column"===u?"direction-column":"direction-"+u));let g=[];null==_?(e=this.props?.fair_trade,t=this.props?.alt_fair_trade,i=this.props?.is_organic,s=this.props?.alt_organic,a=this.props?.only_vertuo_next,r=this.props?.alt_vertuo_next,o=this.props?.is_rainforest,l=this.props?.alt_rainforest,c=this.props?.is_sustainable,d=this.props?.alt_sustainable,h=this.props?.is_q_certified_arabica,p=this.props?.alt_q_certification_arabica):void 0===_.length?(e=_?.fair_trade,t=_?.alt_fair_trade,i=_?.is_organic,s=_?.alt_organic,a=_?.only_vertuo_next,r=_?.alt_vertuo_next,o=_?.is_rainforest,l=_?.alt_rainforest,c=_?.is_sustainable,d=_?.alt_sustainable,h=_?.is_q_certified_arabica,p=_?.alt_q_certification_arabica):_.length&&(g=[..._]),[[e,"fair_trade",t,g],[i,"is_organic",s,g],[a,"only_vertuo_next",r,g],[o,"is_rainforest",l,g],[c,"is_sustainable",d,g],[h,"is_q_certified_arabica",p,g]].map((e=>this.appendLogo.apply(this,e))),this.innerHTML=g.map((e=>`<img src="${n[e.name]}" alt="${e.alt}" loading="lazy">`)).join("")}appendLogo(e,t,i,s){e&&!this.hasLogo(s,t)&&s.push({name:t,alt:i})}hasLogo(e,t){return e.some((e=>e.name===t))}}customElements.get("nb-card-logos")||customElements.define("nb-card-logos",a);class r extends HTMLElement{constructor(){super(),this.props={},this.level="",this.levelPlus=""}connectedCallback(){this.props=e(this.attributes),this.render()}render(){const{a11y_label:e,level:t}=this.props;if(""===e||""===t)return"";switch(this.classList.add(`level_${t}`),t){case"g":this.level="G";break;case"f":this.level="F";break;case"e":this.level="E";break;case"d":this.level="D";break;case"c":this.level="C";break;case"b":this.level="B";break;case"a4":this.level="A";break;case"a3":this.level="A",this.levelPlus="+";break;case"a2":this.level="A",this.levelPlus="++";break;default:this.level="A",this.levelPlus="+++"}this.innerHTML=`\n            <mark aria-label='${e} ${this.level}${this.levelPlus}'>\n                ${this.level}\n                ${""!==this.levelPlus?`<sup>${this.levelPlus}</sup>`:""}\n            </mark>\n        `}}customElements.get("nb-energy-label")||customElements.define("nb-energy-label",r);class o extends HTMLElement{constructor(){super(),this.props={}}connectedCallback(){this.props=e(this.attributes),this.render()}render(){const{intensity_label:e="Intensity",a11y_intensity_max:t,max_intensity:i}=this.props,s=parseInt(this.props.intensity);if(!s||isNaN(s))return"";const n=t.replace("{max_intensity}",i);this.innerHTML=`\n            <div aria-label="${e} ${s} ${n}">\n                ${e}${this.renderIntensityMin(s)}\n                ${s}\n                ${this.renderIntensityMax(s)}\n            </div>\n        `}renderIntensityMin(e){return new Array(Math.max(e,0)-0).fill('<span class="bar filled"></span>').join("")}renderIntensityMax(e){let{max_intensity:t}=this.props;return t&&"undefined"!==t||(t=14),new Array(parseInt(t)-Math.min(e,parseInt(t))).fill('<span class="bar"></span>').join("")}}function l(e,t,i,s,n){const a=(t,i)=>{e.setAttribute(t,i);const a=()=>e.classList.add("lazy-loaded");if(s){const t=new Image;return t.src=s,t.onload=a,void(t.onerror=()=>{n&&n(`Image ${s} cannot be loaded.`),e.classList.add("lazy-loaded-error")})}a()};if(/Trident\/|MSIE/.test(window.navigator.userAgent)||(r=window.navigator.userAgent,o=r.indexOf("OS "),(r.indexOf("iPhone")>-1||r.indexOf("iPad")>-1)&&o>-1&&window.Number(r.substr(o+3,3).replace("_","."))<14))a(t,i);else if("IntersectionObserver"in window){e.classList.add("lazy-load");let s=new IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting&&(a(t,i),s.unobserve(e.target))}))}));s.observe(e)}else a(t,i);var r,o}function c(e,t,i,s){let n=0;for(;e;){const a=e.indexOf(i,n);if(-1===a)break;const r=e.indexOf(s,a+1);if(-1===r)break;const o=e.substring(a+i.length,r);null!=t[o]?(e=e.substr(0,a)+t[o]+e.substr(r+s.length),n=a):n=r}return e}customElements.get("nb-intensity")||customElements.define("nb-intensity",o);const d=e=>h(JSON.stringify(e)),h=e=>e?e.toString().replace(/"/g,"&quot;").replace(/'/g,"&apos;"):"",p=(e,t)=>{for(let i in t)e.setAttribute(i,t[i])};class u extends HTMLElement{constructor(){super(),this.template=""}connectedCallback(){this.props=this._createProps(),this.onStart?.(),this.loadTemplate(),this.onReady?.()}_createProps(e=null){const t=e||this.attributes;let i;try{i=[...t].reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{});const e=[...t].find((e=>"data"===e.nodeName));return null==e?i:{...i,...JSON.parse(e.nodeValue)}}catch(e){console.log("ERROR: No data",e)}}render(e=!1){e&&(this.innerHTML="");const t=(e,i)=>{const s=e=>3===e.nodeType?"text":8===e.nodeType?"comment":e.tagName.toLowerCase(),n=e=>e.childNodes&&e.childNodes.length>0?null:e.textContent;var a=Array.prototype.slice.call(i.childNodes),r=Array.prototype.slice.call(e.childNodes),o=a.length-r.length;if(o>0)for(;o>0;o--)a[a.length-o].parentNode.removeChild(a[a.length-o]);r.forEach((function(e,r){if(a[r])if(s(e)===s(a[r])){var o=n(e);if(o&&o!==n(a[r])&&(a[r].textContent=o),a[r].childNodes.length>0&&e.childNodes.length<1)a[r].innerHTML="";else{if(a[r].childNodes.length<1&&e.childNodes.length>0){var l=document.createDocumentFragment();return t(e,l),void a[r].appendChild(l)}e.childNodes.length>0&&t(e,a[r])}}else a[r].parentNode.replaceChild(e.cloneNode(!0),a[r]);else i.appendChild(e.cloneNode(!0))}))},i=(s=this.template,(new DOMParser).parseFromString(s,"text/html").body);var s;t(i,this)}loadTemplate(e="",t=!1){this.template=""===e?this.template:`${e}`,this.render(t)}disconnectedCallback(){this.onDestroy?.()}}customElements.get("nb-nespresso-element")||customElements.define("nb-nespresso-element",u);const _={get is(){const{innerWidth:e,devicePixelRatio:t}=window;return{mobile:e<768,mobile_tablet:e<1024,tablet:e>=768&&e<1024,desktop:e>=1024&&t<=1,retina:e>=1024&&t>1}},lt:e=>window.innerWidth<e};const g=({eventName:e,args:t,element:i})=>{let s;i=i||window,t?s=new CustomEvent(e,{detail:t,bubbles:!0}):"function"==typeof Event?s=new Event(e):(s=document.createEvent("Event"),s.initEvent(e,!0,!0)),i.dispatchEvent(s)};let m,b="";const v=e=>{f(e),e.bundlePopIn=document.getElementById("bundle-popin-id"),e.appendChild(e.bundlePopIn),p(e.bundlePopIn,{variation:"before",bgcolor:"white",size:"L",padding:"false",label_close:m,content:b}),e.bundlePopIn.classList.add("nb-popin--bundle"),g({eventName:"WEB_COMPONENT_POPIN_OPEN",args:{id:"bundle-popin-id"}})},f=e=>{if(null!=document.getElementById("bundle-popin-id"))return;let t=document.createElement("nb-popin");t=e.appendChild(t),t.setAttribute("id","bundle-popin-id"),t.setAttribute("content","")};function y({icon:e,text:t}){return`<nb-icon-text data="${d({icon:e,label:t,classname:"t-xs-500"})}"></nb-icon-text>`}const w=({price:e,giftcard_price:t,type:i,hidePrice:s})=>!e||"giftcard"===i&&!t||s?"":`<p class="cn_card__priceWrapper--current"><span>${e}</span></p>`,k=async e=>{const t=await(async()=>await window.napi.priceFormat())(),i=window[window.config.padl.namespace].dataLayer.app.app.currency;return t.html?t.html(i,e):t.short(i,e)||""},$=e=>{const{sales_multiple:t,label_sleeve:i,label_sleeves:s,show_sleeve:n=!1,sleeve_syntax:a="{numberOfSleeves} {sleeveLabel} ({quantity} {label_capsules})",number_of_sleeves:r,label_capsules:o,type:l,bundled:d,unit_quantity:h,unitQuantity:p}=e,u=r,_=u>1&&s?s:i,g=!1===d?t:h||p||0;let m;return n&&"capsule"===l&&u&&i&&o?(m=a,`<p class="cn_card__priceWrapper--items showSleeve">${c(m,{numberOfSleeves:u,sleeveLabel:_,quantity:g,label_capsules:o,label_sleeve:i},"{","}")}</p>`):""};async function x(e){const{in_stock:t,strikethrough_price:i,hide_add_to_cart:s=!1}=e,n=null!=t&&!t;return!0===s?"":`\n        <div class="cn_card__priceWrapper">\n            <div class="cn_card__priceInnerWrapper">\n                ${i?await(async e=>e?`<p class="cn_card__strikethroughPrice">${await k(e)}</p>`:"")(i):""}\n                ${w(e)}\n                ${n?"":$(e)}\n                ${n?"":(e=>{const{show_capsule_price:t=!1,price_per_capsule:i,capsule_price_label:s,capsule_price_syntax:n="{capsule_price_label}: {price_per_capsule}"}=e;return t?`<p class="cn_card__priceWrapper--items capsulePrice">${c(n,{capsule_price_label:s,price_per_capsule:i},"{","}")}</p>`:""})(e)}\n                ${(({type:e,price:t,price_per_capsule:i,a11y_price:s="euros per sleeve",a11y_capsule_price:n="Capsule price",sleeve_variation_pdp:a="false"})=>`<span class="sr-only">\n      ${"true"===a?"capsule"===e?`${n}: ${i}`:"":`${t} ${s}`}\n    </span>`)(e)}\n                ${n?(e=>{const{label_outofstock:t}=e.shop_similar;return""===t?"":`<p class="cn_card__priceWrapper--items t-xs-500-sl">${t}</p>`})(e):""}\n            </div>\n            ${(e=>{const{category_name:t="",type:i,sku:s,longSku:n="",position:a,giftcard_price:r,variation:o="plp",quantity_selector:l,hidePrice:c,url:h,view_details_label:p="View details"}=e;let u="large";if("plp"===o&&(u=_.is.mobile?"small":"large"),"giftcard"===i&&r)return`<nb-add-gift-card data="${d({price:r,sku:s,add_to_cart:u,quantity_selector:l})}"></nb-add-gift-card>`;return c?`<nb-cta link="${h}" variation="primary">${p}</nb-cta>`:`\n        <nb-add-to-cart\n            sku="${s}"\n            longSku="${n}"\n            buttonSize="${u}"\n            showPrice\n            range='${t}'\n            position='${a}'\n        ></nb-add-to-cart>\n    `})(e)}\n        </div>`}class E{constructor(e){this._carousel=e,this._carousel._container.addEventListener("dragstart",(e=>e.preventDefault())),this._carousel._container.addEventListener("touchstart",(e=>this.startDrag(e)),{passive:!0}),this._carousel._container.addEventListener("mousedown",(e=>this.startDrag(e))),this._carousel._container.addEventListener("touchstart",(e=>this.startDrag(e)),{passive:!0}),window.addEventListener("mousemove",(e=>this.drag(e)),{passive:!1}),window.addEventListener("touchmove",(e=>this.drag(e)),{passive:!1}),window.addEventListener("mouseup",(()=>this.endDrag())),window.addEventListener("touchend",(()=>this.endDrag())),window.addEventListener("touchcancel",(()=>this.endDrag())),this.translateFactor=150}startDrag(e){e.touches&&e.touches.length>1||(e.touches&&(e=e.touches[0]),this._origin={x:e.screenX,y:e.screenY},this._width=this._carousel.containerWidth)}drag(e){if(!this._origin)return;const t=e.touches?e.touches[0]:e,i={x:t.screenX-this._origin.x,y:t.screenY-this._origin.y};this._lastTranslate=i;const s=this._carousel._currentIndex*this._carousel._widthSlide-this.translateFactor*i.x/this._width;this._carousel.translate(s)}preventMobileYTranslate(e,t){e.touches&&(e.touches&&Math.abs(t.x)>Math.abs(t.y)||e.touches&&Math.abs(t.y)>Math.abs(t.x))&&(e.preventDefault(),e.stopPropagation())}endDrag(){if(!this._origin||!this._lastTranslate)return this._origin=null,void(this._lastTranslate=null);const e=this._lastTranslate.x/this._carousel.carouselWidth;if(Math.abs(e)>.1){const e=this._lastTranslate.x<0?"next":"prev";this._carousel[e]()}else this._carousel.goToItem(this._carousel._currentIndex);this._origin=null,this._lastTranslate=null}}class L{constructor(e){this._carousel=e,new MutationObserver((e=>{e.forEach((function(e){if(!e||!e.oldValue||!e.classList)return;const t=e.classList.contains("has-overlay-absolute"),i=document.body.classList.contains("has-overlay");t&&!i&&this._carousel.goToItem(this._carousel._currentIndex)}))})).observe(document.body,{attributes:!0,attributeFilter:["class"],attributeOldValue:!0})}}class C{constructor(e,t={}){this._element=e,this._slides=[].slice.call(e.children);const i=t.index||0;this._options=Object.assign({},{slidesToScroll:1,slidesVisible:1,spaceBetween:0,navigationButton:!0,loop:!0,pagination:!0,hookGetRightBoundary:null,hookSlideChange:null,hookMove:null,hookNext:null,hookPrevious:null,pagination_variation:null,nav_centered:!1},t),this.moveCallbacks=[],this._ratio=this._slides.length/this._options.slidesVisible,this.buildIHM(),new L(this),this.hasPagination()&&(new E(this),this.goToItem(i))}get element(){return this._element}get slidesToScroll(){return this._options.slidesToScroll}get slidesVisible(){return this._options.slidesVisible}get slidesTotal(){return this._slides.length}get navigationButton(){return this._options.navigationButton}get navigationVariation(){return this._options.navigation_variation}get navigationSize(){return this._options.navigation_size}get loop(){return this._options.loop}get pagination(){return this._options.pagination}get containerWidth(){return this._container.offsetWidth}get carouselWidth(){return this._root.offsetWidth}get wrapperWidth(){return this._wrapper.offsetWidth}get paginationVariation(){return this._options.pagination_variation}get nav_centered(){return this._options.nav_centered}getSlideWidth(e){const{slidesVisible:t,spaceBetween:i}=this._options;return(e+parseInt(i))/t}buildIHM(){this._root=this.createElement("div","carousel"),this._container=this.createElement("div","container"),this._wrapper=this.createElement("div","wrapper"),this._children=this._slides.map((e=>{const t=this.createElement("div","item");return t.appendChild(e),this._container.appendChild(t),t})),this._wrapper.appendChild(this._container),this._root.appendChild(this._wrapper),this._element.appendChild(this._root),this.setWrapperStyle(),this.hasPagination()&&(this.navigationButton&&this.createNavigation(),this.pagination&&this.createPagination())}setWrapperStyle(){const e=this.wrapperWidth,t=this.getSlideWidth(e),i=t*this._children.length;this.setContainerWidth(i),this.setWrapperWidth(e);for(const e of this._children)this.setSlideWidth(e,t);this._widthContainer=i,this._widthSlide=t,this._widthWrapper=e}setSlideWidth(e,t){e.style.width=t-this._options.spaceBetween+"px",this._options.spaceBetween&&(e.style.marginRight=`${this._options.spaceBetween}px`)}setContainerWidth(e){this._container.style.width=`${e}px`}setWrapperWidth(e){this._wrapper.style.width=`${e}px`}disableTransition(){this._container.style.transition="none"}enableTransition(){this._container.style.transition=""}translate(e){this._container.style.left=-e+"px"}createElement(e,t){let i=document.createElement(e);return i.setAttribute("class",t),i}createNavigation(){const e=this.createElement("nb-cta","prev");e.setAttribute("variation","navigation"),e.setAttribute("contrast",this.navigationVariation),e.setAttribute("size",this.navigationSize),e.setAttribute("icon_right","chevron-left"),e.setAttribute("label","a11y_slider_previous_button");const t=this.createElement("nb-cta","next");t.setAttribute("variation","navigation"),t.setAttribute("contrast",this.navigationVariation),t.setAttribute("size",this.navigationSize),t.setAttribute("icon_right","chevron-right"),t.setAttribute("label","a11y_slider_next_button"),t.addEventListener("click",(()=>this.next())),e.addEventListener("click",(()=>this.prev())),t.addEventListener("keydown",(e=>"Enter"===e.key||"Space"===e.key?this.next():null)),e.addEventListener("keydown",(e=>"Enter"===e.key||"Space"===e.key?this.prev():null));let i=this._root.parentElement;i.appendChild(e),i.appendChild(t),this.onMove((i=>{const s=i._currentIndex+this.slidesVisible;this.loop||(i._currentIndex<=0?e.classList.add("hidden"):e.classList.remove("hidden"),this._slides.length===s?t.classList.add("hidden"):t.classList.remove("hidden"),this._options.hookMove&&this._options.hookMove(t))}))}getSlideNotVisible(){return this._children.length-(this.slidesVisible-1)}hasPagination(){return this.getSlideNotVisible()>1}createPaginationBullets(){const e=document.createElement("nav"),t=[];for(let i=0;i<this.getSlideNotVisible();i+=this.slidesToScroll){let s=document.createElement("span");s.innerText=(i+1).toString();let n=document.createElement("button");n.addEventListener("click",(()=>this.goToItem(i))),n.appendChild(s),e.appendChild(n),t.push(n)}const i=e=>{let i=t[e/this.slidesToScroll];i&&(t.forEach((e=>e.classList.remove("active"))),i.classList.add("active"))};i(this._currentIndex),this.onMove((()=>i(this._currentIndex))),this._root.parentElement.parentElement.appendChild(e)}createPaginationStepper(){const e=document.createElement("nav");let t=document.createElement("div");t.innerText=this.slidesTotal-this.slidesVisible+1,t.classList.add("totalPages");let i=document.createElement("div");i.innerText="/";let s=document.createElement("div");s.classList.add("currentPage"),e.appendChild(s),e.appendChild(i),e.appendChild(t),this.onMove((()=>s.innerText=this._currentIndex+1)),this.onMove((()=>e.setAttribute("aria-label",s.innerText+" "+i.innerHTML+" "+t.innerHTML))),this._root.parentElement.parentElement.appendChild(e)}createPagination(){this.slidesTotal<=5?this.createPaginationBullets():"stepper"===this.paginationVariation?(this.createPaginationStepper(),console.info("paginationVariation >> enabled")):(this.createPaginationBullets(),console.info("bullets enabled"))}next(){let e=this._currentIndex+this.slidesToScroll;this._options.hookNext&&(e=this._options.hookNext(e)),this.goToItem(e)}prev(){let e=this._currentIndex-this.slidesToScroll;this._options.hookPrevious&&(e=this._options.hookPrevious(e)),this.goToItem(e)}goToItem(e){this.hackUi();const t=this.getOverflowingIndex(e);let i=t*this._widthSlide;this._options.hookSlideChange&&(i=this._options.hookSlideChange(t,i)),this.translate(i),this._currentIndex=t,this.indexHasChange()}hackUi(){const e=document.querySelector("html");!e.classList.contains("has-overlay-absolute")&&e.classList.contains("has-overlay")}getOverflowingIndex(e){const t=this.getLeftBoundary(e),i=this.getRightBoundary(e),s=this._children.length-this._options.slidesVisible;return t?this.loop?s:0:i?this.loop?0:s:e}getLeftBoundary(e){return e<0}getRightBoundary(e){const t=e>=this._children.length,i=this.currentIndex+this.slidesVisible,s=void 0!==this._children[i],n=e>this.currentIndex;let a=t||n&&!s;return this._options.hookGetRightBoundary&&(a=this._options.hookGetRightBoundary(a,e)),a}_getMaxSlideWidth(e){return e.reduce(((e,t)=>Math.max(e,t.offsetWidth)),0)}onSlideChange(e){this.onMove(e)}onMove(e){this.moveCallbacks.push(e)}indexHasChange(){this.moveCallbacks.forEach((e=>e(this))),this.activateItems()}activateItems(){const e=this._currentIndex+this.slidesVisible;this._slides.map(((t,i)=>{t.classList.remove("active"),t.parentElement.classList.remove("activeParent"),i>=this._currentIndex&&i<e&&(t.classList.add("active"),t.parentElement.classList.add("activeParent"))}))}setClass(e){this._element.classList.add(e)}unsetClass(e){this._element.classList.remove(e)}get currentIndex(){return this._currentIndex}}window.gtmDataObject=window.gtmDataObject||[];class P extends HTMLElement{constructor(){super(),this._slider=null,this.randomId="slider_"+function(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=i.length,n=0;n<e;n++)t+=i.charAt(Math.floor(Math.random()*s));return t}(5)}static get observedAttributes(){return["slides_to_scroll","slides_visible","pagination","pagination_variation","nav_centered"]}connectedCallback(){this.slot=this.innerHTML,this.props=e(this.attributes),this.render()}createProps(){return[...this.attributes].reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{})}render(){this.innerHTML=`<div class="slider ${this.randomId}">${this.slot}</div>`,this.loadSlider()}loadSlider(){const{indexSlider:e=0,slides_loop:t="true",slides_visible:i=4,slides_to_scroll:s=1,navigation:n="true",pagination:a="true",space_between:r=0,navigation_variation:o="dark",navigation_size:l="48",pagination_variation:c="stepper",nav_centered:d="false"}=this.props,h=this.querySelector(`.${this.randomId}`),p={index:parseInt(e),slidesToScroll:parseInt(s),slidesVisible:parseInt(i),spaceBetween:r,loop:"true"===t,navigationButton:"true"===n,pagination:"true"===a,navigation_variation:o,navigation_size:l,pagination_variation:c,nav_centered:d};this._slider=new C(h,p),this._slider.setClass("first"),this._slider.onSlideChange(this.handleClick.bind(this))}handleClick(){var e;g({eventName:"WEB_COMPONENT_SLIDE_CHANGE"}),this.toggleClasses(),e={rootElement:["nb-slider"]},window.gtmDataObject.push({event:"itemDisplay",eventRaisedBy:"Web component",eventAction:"Click",itemTypes:["products"],...e})}toggleClasses(){const e=0===this._slider.currentIndex,t=this._slider.slidesTotal===this._slider.currentIndex+this._slider.slidesVisible;this._slider.unsetClass("last"),this._slider.unsetClass("first"),e?this._slider.setClass("first"):t&&this._slider.setClass("last")}}customElements.get("nb-slider")||customElements.define("nb-slider",P);class I extends HTMLElement{constructor(){super(),this.props={}}connectedCallback(){this.props=e(this.attributes),this.render()}render(){const{slides:e,image_alt_text:t}=this.props;let i=document.createElement("nb-slider");p(i,{slides_to_scroll:"1",slides_visible:"1",navigation:"true",navigation_variation:"highlight",navigation_size:"32",pagination:"true"});let s=document.createElement("nb-loader");p(s,{icon:"loading"}),this.appendChild(s);e.forEach((e=>{const s=`${e.url}?impolicy=product&imwidth=600`;let n=document.createElement("img");n.setAttribute("alt",t),n.setAttribute("title",t),n.setAttribute("data-src",s),i.appendChild(n)})),this.appendChild(i),e.forEach((e=>{const t=`${e.url}?impolicy=product&imwidth=600`;l(i.querySelector(`img[data-src="${t}"]`),"src",t,t)}))}}customElements.get("nb-product-card-image-slider")||customElements.define("nb-product-card-image-slider",I);function S({type:e,show_slider:t,slides:i,image:s,image_alt_text:n,plp_type:a},r){if(void 0===s||""===s||"pdp"===a)return"";const o=!r.is.mobile&&t&&i&&i.length>1;return("machine"===e||"machine"===a)&&o?function(e,t){return!e||e.length<=0?"":`<div class="cn_card__image">\n                <nb-product-card-image-slider\n                    data='${d({slides:e})}'\n                    image_alt_text=${t}>\n                </nb-product-card-image-slider>\n            </div>`}(i,n):function(e,t,i){return e?`<div class="cn_card__image">\n            ${i?`<a href="${i}" target="_self" aria-hidden="true" tabindex="-1">`:""}\n                <img class="cn_card__image__single" src=${e} alt="${t}"/>\n            ${i?"</a>":""}\n            </div>`:""}(s,n)}class T extends HTMLElement{async connectedCallback(){this.props=e(this.attributes),this.boundOnPDPLinkClick=this.onPDPLinkClick.bind(this),this.boundOnColorClick=this.onColorClick.bind(this),await this.render(),((e,t)=>{const{image:i=""}=e,s=t.querySelector("img.cn_card__image__single"),n="?impolicy=product&imwidth=150";s&&l(s,"src",`${i+n}`,i+n)})(this.props,this)}async render(){const{additional_message_icon:e,additional_message:t,category_name:i="",giftcard_price:s,hide_header:n,image:a,label_technology:r,label_range:o,labels:l=[],plp_type:c,position:h,rating_enabled:u=!1,show_ratings:g=!1,sku:v,src_page:f,type:k}=this.props;if("giftcard"===k&&!s)return null;!n&&a||this.classList.add("hide-header"),l.length&&this.classList.add("has-labels"),this.innerHTML=`\n            ${S(this.props,_)}\n            ${(({labels:e=[]})=>0===e.length?"":`<nb-card-labels data='${d({labels:e})}' direction="${_.is.mobile?"row":"column"}"></nb-card-labels>`)(this.props)}\n            ${((e,t)=>{const{fair_trade:i,alt_fair_trade:s,is_organic:n,alt_organic:a,only_vertuo_next:r,alt_vertuo_next:o,is_rainforest:l,alt_rainforest:c,is_sustainable:h,alt_sustainable:p,is_q_certified_arabica:u,alt_q_certification_arabica:_,logos:g}=e;return i||n||r||l||h||u||!(null==g||g.length<1)?(t.classList.add("has-logos"),`<nb-card-logos data='${d({fair_trade:i,alt_fair_trade:s,is_organic:n,alt_organic:a,only_vertuo_next:r,alt_vertuo_next:o,is_rainforest:l,alt_rainforest:c,is_sustainable:h,alt_sustainable:p,is_q_certified_arabica:u,alt_q_certification_arabica:_,logos:g})}'></nb-card-logos>`):""})(this.props,this)}\n            ${(({a11y_energy_label:e,energy_level:t})=>t?`<nb-energy-label data='${d({a11y_label:e,level:t})}'></nb-energy-label>`:"")(this.props)}\n            <div class="cn_card__content">\n                ${function(e){return e?`<p class="cn_card__technology t-xs-700">${e}</p>`:""}(r)}\n                ${function(e){return e?`<p class="cn_card__range t-xs-500">${e}</p>`:""}(o)}\n\n                ${(({url:e,a11y_product_card:t="",name:i="",label_decaffeinato:s,src_page:n=""},a)=>{const r=new RegExp(s,"ig"),o=s&&""!==s&&r.test(i);t=t.replace("{productName}",i),o?i=i.replace(r,"").trim():s="";const l="pdp"===n?"h1":"h3";return`${e?`<${l} class='cn_card__title'><a href="${e}" target="_self" title="${t}" aria-label="${t}">`:`<${l} class='cn_card__title'>`}\n${i}\n${s?`<span class='${a.is.mobile?"t-xs-700-caps":"t-sm-700-caps"}'>${s}</span>`:""}\n${e?`</a></${l}>`:`</${l}>`}`})(this.props,_)}\n                ${g&&u?'<div class="cn_card__rating"><nb-loader></nb-loader></div>':""}\n\n                ${function({headline:e="",is_headline_hidden:t=!1}){return""===e||t&&_.is.mobile?"":`<p class="cn_card__text">${e}</p>`}(this.props)}\n\n                ${"machine"===k?(({colors:e,sku:t,max_colors:i=4,a11y_extra_color:s="",url:n,activeSku:a,name:r})=>e?`<nb-colors data="${d({colors:e,max_colors:i,activeSku:a||t,extra_url:n,extra_title:r+", "+s})}" size="${_.is.mobile?"small":"large"}"></nb-colors>`:"")(this.props):""}\n                ${"machine"===k?function({features:e=[]}){return 0===e.length?"":`<div class="cn_card__features">${e.map(y).join("")}</div>`}(this.props):""}\n\n                ${"capsule"===k?(({type:e,bundle_details:t,bundled:i,sku:s,position:n,range:a},r)=>"capsule"===e&&t&&t.popin_link_text&&!0===i?(b=`<nb-bundle-details\n                main_sku='${s}'\n                description='${t.description}'\n                other_skus='${t.other_skus}'\n                other_skus_quantity= '${t.other_skus_quantity}'\n                range='${a}'\n                position='${n}'>\n            </nb-bundle-details>`,r.variation="white",m=t.popin_label_close,`<nb-link class="cn_card__cta__bundle" size="large" color="gold" label="${t.popin_link_text}"></nb-link>`):"")(this.props,this):""}\n                ${"capsule"===k?(({intensity:e,a11y_intensity_max:t,intensity_label:i=""})=>0===e||isNaN(parseInt(e))?"":`<nb-intensity\n        class="t-xs-500-sl"\n        intensity="${e}"\n        a11y_intensity_max="${t}"\n        intensity_label="${i}">\n    </nb-intensity>`)(this.props):""}\n\n                ${await x(this.props)}\n\n                ${"machine"===k?function(e){const{popin_id:t,subscription:i,view_details_label:s="View details"}=e;return void 0===i?"":`\n        <div class="cn_card__subscriptionWrapper">\n            ${w(e)}\n            <p class="t-sm-400">${i.text}</p>\n            <nb-cta class="cn_card__viewDetails" popin_id="${t}" variation="primary">${s}</nb-cta>\n        </div>\n        <nb-popin\n            id="${t}"\n            variation="before"\n            bgcolor="highlight"\n            size="L"\n            padding="false"\n            label_close="Close"\n            content="<nb-machine-details data='${d(e)}' />">\n        </nb-popin>\n    `}(this.props):""}\n\n                ${function(e,t){return t?`<p class="cn_card__additionalMessage t-sm-500-sl">\n        <nb-icon\n            icon="${e}"\n            class="additionalMsgIcon"\n        ></nb-icon> ${t}</p>`:""}(e,t)}\n            </div>\n        `,p(this,{"data-product-item-id":v,"data-product-section":i,"data-product-position":h,"data-src-page":f,"data-plp-type":c}),((e,t)=>{const{src_page:i,plp_type:s}=e;"plp"===i?"coffee"===s&&_.is.mobile?t.setAttribute("theme","landscape"):t.setAttribute("theme","portrait"):t.setAttribute("theme","pdp")})(this.props,this),this.bundlePopinLink=this.querySelector(".cn_card__cta__bundle button"),this.classList.add("cn_card"),this.bindEvent(),g&&u&&(({sku:e,minimum_rating:t=0},i)=>{if(!window.napi.ratings)return"";window.napi.ratings().summary(e).then((e=>e&&e.ratingAverage>0&&e.ratingAverage>t?e:"")).then((e=>e?{stars:e?parseFloat(e.ratingAverage.toFixed(2)):0}:"")).then((e=>{if(e){const t=document.createElement("nb-rating");t.setAttribute("stars",e?e.stars:0),i.querySelector("nb-loader").replaceWith(t)}else i.querySelector("nb-loader").remove()}))})(this.props,this.querySelector(".cn_card__rating"))}async onPDPLinkClick(){window.napi.data().product().setProductClickData(await window.productHelper.getPadlProductDetail(await window.napi.catalog().getProduct(this.props.lonGgSku)))}onColorClick(e){const t=(e=>{if(e.detail)return e.detail})(e);var i;t.sku&&(this.template="<nb-loader></nb-loader>",this.render(),(i=t.sku,window.napi.catalog().getProduct(i)).then((e=>{e&&(this.props={...this.props,sku:e.internationalId||"",longSku:e.id||"",image:e.images?.icon||"",image_alt_text:e.name||"",price:e.price,activeSku:e.internationalId||""})})).catch((()=>{console.error(`getProduct fail on sku ${t.sku}`)})))}bindEvent(){this.linkElements=[],this.unbindEvent(),this.linkElements=this.querySelectorAll("a[href]"),this.addEventListener("EVENT_COLOR_CLICKED",this.boundOnColorClick),this.linkElements.length&&Array.from(this.linkElements).forEach((e=>{e.addEventListener("click",this.boundOnPDPLinkClick)})),this.bundlePopinLink&&(this.boundBundlePopinLinkClick=v.bind(null,this),this.bundlePopinLink.addEventListener("click",this.boundBundlePopinLinkClick))}unbindEvent(){this.removeEventListener("EVENT_COLOR_CLICKED",this.boundOnColorClick),this.linkElements?.length&&(Array.from(this.linkElements).forEach((e=>{e.removeEventListener("click",this.boundOnPDPLinkClick)})),this.linkElements=[]),this.bundlePopinLink&&this.bundlePopinLink.removeEventListener("click",this.boundBundlePopinLinkClick)}disconnectedCallback(){this.unbindEvent()}}customElements.get("nb-plp-product-card")||customElements.define("nb-plp-product-card",T);export{T as default};
