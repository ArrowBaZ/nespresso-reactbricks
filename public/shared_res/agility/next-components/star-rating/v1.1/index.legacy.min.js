const e=e=>null==e;class s extends HTMLElement{constructor(){super(),this.type=null,this.value=null,this.boundKeyPress=this.onKeyPress.bind(this),this.boundValueChanged=this.onValueChanged.bind(this),this.boundShakeAnimationEnd=this.onShakeAnimationEnd.bind(this),this.boundPopinOpened=this.onPopinOpened.bind(this)}connectedCallback(){this.props=(s=>{const t=(e=>e.find((e=>"data"===e.nodeName)))([...s]),i=[...s].filter((e=>"data"!==e.nodeName)).reduce(((e,s)=>({...e,[s.nodeName]:s.nodeValue})),{});if(e(t))return i;try{return{...i,...JSON.parse(t.nodeValue)}}catch(e){console.log("ERROR: No data",e)}})(this.attributes),this.classList.add("nb-form-item"),this.type&&this.classList.add("nb-"+this.type),this.beforeRender(),this.render(),this.setRequired(),this.afterRender(),this.setCSSvariables(),this.bindEvent()}beforeRender(){}render(){const{element_id:e,element_name:s,label:t}=this.props;this.innerHTML=`\n            <input id="${e}" name="${s}" type="${this.type}" class="t-sm-400-sl" />\n            <label for="${e}" class="t-sm-400-sl"><span>${t}</span></label>\n            ${this.renderMessages()}\n        `}afterRender(){}setRequired(){const{required_message:e}=this.props;this.formElement=this.querySelector("input, textarea"),e&&this.formElement.setAttribute("required","required")}renderMessages(){return`\n            ${this.renderRequiredMessage()}\n            ${this.renderHelperMessage()}\n        `}renderRequiredMessage(){const{required_message:e}=this.props;return e?`<mark role="alert" class="cb-empty t-2xs-500">${e}</mark>`:""}renderHelperMessage(){const{helper_message:e}=this.props;return e?(this.classList.add("has-helper"),`<p class='cb-helper t-2xs-500'>${e}</p>`):""}setCSSvariables(){const{helper_message:e,required_message:s,error_message:t,max_message:i}=this.props;e&&this.setVariable("helper"),s&&this.setVariable("empty"),t&&this.setVariable("error"),i&&this.setVariable("max")}setVariable(e){const s=this.querySelector(".cb-"+e);const t=(s.clientHeight+parseInt(window.getComputedStyle(s).marginTop))/16;this.style.setProperty("--"+e+"-padding-bottom",t+"rem")}onKeyPress(){}onValueChanged(e){"checkbox"===this.type?this.value=e.target.checked:this.value=e.target.value,this.checkFilled(),this.checkValidity()}onBlur(){}checkFilled(){""!==this.value||!0===this.value?this.formElement.classList.add("is-filled"):this.formElement.classList.remove("is-filled")}checkValidity(){return this.checkEmpty()}checkEmpty(){const{required_message:e}=this.props;return!e||(""===this.value||!1===this.value||null===this.value?(this.classList.remove("is-error"),this.classList.add("is-empty"),!1):(this.classList.remove("is-empty"),!0))}shake(e){this.classList.contains(e)&&(this.classList.add("shake"),this.addEventListener("animationend",this.boundShakeAnimationEnd))}onShakeAnimationEnd(){this.classList.remove("shake"),this.removeEventListener("animationend",this.boundShakeAnimationEnd)}onPopinOpened(){this.setCSSvariables()}bindEvent(){this.unbindEvent(),window.addEventListener("WEB_COMPONENT_POPIN_OPENED",this.boundPopinOpened),this.bindSpecificEvent()}unbindEvent(){window.removeEventListener("WEB_COMPONENT_POPIN_OPENED",this.boundPopinOpened),this.unbindSpecificEvent()}bindSpecificEvent(){this.formElement&&(this.formElement.addEventListener("keyup",this.boundKeyPress),this.formElement.addEventListener("change",this.boundValueChanged))}unbindSpecificEvent(){this.formElement&&(this.formElement.removeEventListener("keyup",this.boundKeyPress),this.formElement.removeEventListener("change",this.boundValueChanged))}disconnectedCallback(){this.unbindEvent()}}customElements.get("nb-form-item")||customElements.define("nb-form-item",s);class t extends s{beforeRender(){this.classList.add("nb-star-rating"),this.boundFocus=this.onFocus.bind(this),this.boundBlur=this.onBlur.bind(this)}render(){const{element_id:e,element_name:s,label:t,a11y_star_singular:i,a11y_star_plural:n}=this.props;let r=[],a=[],d="",l="";for(let t=1;t<=5;t++)l=1===t?i:n,r.push(`\n                <input id="${e}-${t}" name="${s}" type="radio" value="${t}" aria-label="${t} ${l}" class="t-sm-400-sl">\n            `);for(let s=5;s>=1;s--)d+=s,a.push(`\n                <label for="${e}-${s}" class="t-sm-400-sl" active="${d}" aria-hidden="true"><nb-icon icon="rating"></nb-icon></label>\n            `);this.innerHTML=`\n            <legend class="t-sm-400-sl">${t}</legend>\n            <fieldset>\n                ${r.join("")}\n                <div class="cb-stars">\n                    ${a.reverse().join("")}\n                </div>\n            </fieldset>\n            ${this.renderMessages()}\n        `}setRequired(){const{required_message:e}=this.props;this.radioElements=this.querySelectorAll("input"),e&&this.radioElements.forEach((e=>{e.setAttribute("required","required")}))}onFocus(){this.classList.remove("is-empty")}onBlur(){this.value=!1,this.radioElements.forEach((e=>{this.value=this.value||e.checked})),this.checkEmpty()}bindSpecificEvent(){this.radioElements.forEach((e=>{e.addEventListener("focus",this.boundFocus),e.addEventListener("blur",this.boundBlur)}))}unbindSpecificEvent(){this.radioElements.forEach((e=>{e.removeEventListener("focus",this.boundFocus),e.removeEventListener("blur",this.boundBlur)}))}}customElements.get("nb-star-rating")||customElements.define("nb-star-rating",t);export{t as default};
