const e=768,t="WEB_COMPONENT_POPIN_OPEN",i="WEB_COMPONENT_POPIN_CLOSE",s="WEB_COMPONENT_POPIN_CLOSED",n="WEB_COMPONENT_SLIDER_READY",r="WEB_COMPONENT_SORT_BY_CHANGE";class a extends HTMLElement{constructor(){super(),this.template=""}connectedCallback(){this.props=this._createProps(),this.onStart?.(),this.loadTemplate(),this.onReady?.()}_createProps(e=null){const t=e||this.attributes;let i;try{i=[...t].reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{});const e=[...t].find((e=>"data"===e.nodeName));return null==e?i:{...i,...JSON.parse(e.nodeValue)}}catch(e){console.log("ERROR: No data",e)}}render(e=!1){e&&(this.innerHTML="");const t=(e,i)=>{const s=e=>3===e.nodeType?"text":8===e.nodeType?"comment":e.tagName.toLowerCase(),n=e=>e.childNodes&&e.childNodes.length>0?null:e.textContent;var r=Array.prototype.slice.call(i.childNodes),a=Array.prototype.slice.call(e.childNodes),o=r.length-a.length;if(o>0)for(;o>0;o--)r[r.length-o].parentNode.removeChild(r[r.length-o]);a.forEach((function(e,a){if(r[a])if(s(e)===s(r[a])){var o=n(e);if(o&&o!==n(r[a])&&(r[a].textContent=o),r[a].childNodes.length>0&&e.childNodes.length<1)r[a].innerHTML="";else{if(r[a].childNodes.length<1&&e.childNodes.length>0){var l=document.createDocumentFragment();return t(e,l),void r[a].appendChild(l)}e.childNodes.length>0&&t(e,r[a])}}else r[a].parentNode.replaceChild(e.cloneNode(!0),r[a]);else i.appendChild(e.cloneNode(!0))}))},i=(s=this.template,(new DOMParser).parseFromString(s,"text/html").body);var s;t(i,this)}loadTemplate(e="",t=!1){this.template=""===e?this.template:`${e}`,this.render(t)}disconnectedCallback(){this.onDestroy?.()}}function o(e){const t=document.implementation.createHTMLDocument("");return t.body.innerHTML=e,t.body.childNodes}function l(e,t,i,s,n){const r=(t,i)=>{e.setAttribute(t,i);const r=()=>e.classList.add("lazy-loaded");if(s){const t=new Image;return t.src=s,t.onload=r,void(t.onerror=()=>{n&&n(`Image ${s} cannot be loaded.`),e.classList.add("lazy-loaded-error")})}r()};if(/Trident\/|MSIE/.test(window.navigator.userAgent)||(a=window.navigator.userAgent,o=a.indexOf("OS "),(a.indexOf("iPhone")>-1||a.indexOf("iPad")>-1)&&o>-1&&window.Number(a.substr(o+3,3).replace("_","."))<14))r(t,i);else if("IntersectionObserver"in window){e.classList.add("lazy-load");let s=new IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting&&(r(t,i),s.unobserve(e.target))}))}));s.observe(e)}else r(t,i);var a,o}customElements.get("nb-nespresso-element")||customElements.define("nb-nespresso-element",a);const c=e=>d(JSON.stringify(e)),d=e=>e?e.toString().replace(/"/g,"&quot;").replace(/'/g,"&apos;"):"",u={get is(){const{innerWidth:e,devicePixelRatio:t}=window;return{mobile:e<768,mobile_tablet:e<1024,tablet:e>=768&&e<1024,desktop:e>=1024&&t<=1,retina:e>=1024&&t>1}},lt:e=>window.innerWidth<e},h="plp",p=e=>"pdp"===e,b=e=>{const{url:t,name:i="",name_custom:s=""}=e;if(!i)return"";const n=""!==s?s:i,r=[],a=(({variation:e})=>p(e)?"h1":"h3")(e);return r.push(`<${a} class="cb-heading">`),t&&p(e.variation)?r.push((({url:e,a11y_product_card:t="",name:i="",name_custom:s=""})=>{const n=t.replace("{productName}",i);return`<a href="${e}" target="_self" title="${n}" aria-label="${n}">${""!==s?s:i}</a>`})(e)):r.push(`${n}`),r.push(`</${a}>`),r.join("")},g=({headline:e="",is_headline_hidden:t=!1})=>t&&u.is.mobile||!e?"":`<p class="cb-text">${e}</p>`,m=({label_technology:e})=>e?`<p class="cb-technology t-xs-700">${e}</p>`:"",_=({label_range:e})=>e?`<p class="cb-range t-xs-500">${e}</p>`:"",f=async e=>{const t=await(async()=>await window.napi.priceFormat())(),i=window[window.config.padl.namespace].dataLayer.app.app.currency;return t.html?t.html(i,e):t.short(i,e)||""},v=e=>e.querySelector(".cb-price-old"),y=({strikethrough_price:e},t)=>{return e?((i=e,f(i)).then((e=>{const i=v(t);i&&(i.innerHTML=e)})).catch((e=>{console.error(`Error: Component SKU - Strike Through Price  - ${e}`);const i=v(t);i&&(i.style.display="none")})),'<p class="cb-price-old"></p>'):"";var i};class k extends a{constructor(){super(),this.type="default",this.boundOnPDPLinkClick=this.onPDPLinkClick.bind(this)}loadTemplate(){this.classList.add("nb-sku"),this.classList.add(`nb-sku__${this.type}`),(({variation:e,type:t},i)=>{"pdp"!==e?"capsule"===t&&u.is.mobile?i.setAttribute("landscape","true"):i.setAttribute("portrait","true"):i.setAttribute("pdp","true")})(this.props,this),this.template=`${this.renderVisual()}\n                          ${this.renderHeader()}\n                          <div class="cb-content">\n                              ${this.renderInformation()}\n                              <div class="cb-shop">\n                                  <div class="cb-price">\n                                      ${this.renderPricing()}\n                                  </div>\n                                  ${this.renderAction()}\n                              </div>\n                              ${this.renderFooter()}\n                          </div>`,this.render()}onReady(){const{sku:e,category_name:t,position:i=0}=this.props;this.setAttribute("data-product-item-id",e),this.setAttribute("data-product-section",t),this.setAttribute("data-product-position",i.toString()),this.activateLazyLoad(),this.bindEvent()}activateLazyLoad(){const{image:e}=this.props;if(!e)return"";(({image:e=""},t)=>{const i=".cb-image img",s=t.querySelector(i),n=e=>{console.log(e),console.error(`Error: Component SKU - Lazy Load - ${e}`),s&&(s.style.display="none")};if(!s)return n(`${i} HTMLElement not found.`),"";const r=e+((e="product",t=150)=>{const i=[];return e&&i.push(`impolicy=${e}`),t&&i.push(`imwidth=${t}`),`?${i.join("&")}`})();if(!r)return n(`${r} source file is empty.`),"";l(s,"src",`${r}`,r,n)})(this.props,this)}renderHeaderDefault(){return`${(({labels:e=[]},t=null)=>{if(!t||!e||!e.length)return"";t&&e.length&&t.classList.add("has-labels");const i=u.is.mobile?"row":"column";return`<nb-card-labels data="${c({labels:e})}" direction="${i}"></nb-card-labels>`})(this.props,this)}${((e,t)=>{const{fair_trade:i,alt_fair_trade:s,is_organic:n,alt_organic:r,only_vertuo_next:a,alt_vertuo_next:o,is_rainforest:l,alt_rainforest:d,is_sustainable:u,alt_sustainable:h,is_q_certified_arabica:p,alt_q_certification_arabica:b,logos:g}=e;return i||n||a||l||u||p||!(null==g||g.length<1)?(t.classList.add("has-logos"),`<nb-card-logos data='${c({fair_trade:i,alt_fair_trade:s,is_organic:n,alt_organic:r,only_vertuo_next:a,alt_vertuo_next:o,is_rainforest:l,alt_rainforest:d,is_sustainable:u,alt_sustainable:h,is_q_certified_arabica:p,alt_q_certification_arabica:b,logos:g})}'></nb-card-logos>`):""})(this.props,this)}`}renderHeader(){return this.renderHeaderDefault()}renderVisualDefault(){return(({url:e,image_alt_text:t,image:i})=>{if(!i)return"";let s=`<img src="" alt="${t||"loading"}"/>`;return e&&(s=`<a href="${e}" target="_self" aria-hidden="true" tabindex="-1">${s}</a>`),`<div class="cb-image">\n                ${s}\n            </div>`})(this.props)}renderVisual(){return this.renderVisualDefault()}renderInformationDefault(){return`${m(this.props)}\n        ${_(this.props)}\n        ${b(this.props)}\n        ${g(this.props)}`}renderInformation(){return this.renderInformationDefault()}renderPricingDefault(){return`${y(this.props,this)}\n                ${(({price:e,hidePrice:t,giftcard_price:i})=>!e&&!i||t?"":`<p class="cb-price-current"><span>${e||i}</span></p>`)(this.props)}`}renderPricing(){return this.renderPricingDefault()}renderActionDefault(){return(e=>{const{category_name:t="",sku:i,longSku:s="",position:n,variation:r=h,hidePrice:a,url:o,view_details_label:l="View details",rendererName:c=""}=e;let d="large";return r===h&&(d=u.is.mobile?"small":"large"),"small"===r&&(d="small"),a?`<nb-cta link="${o}" variation="primary">${l}</nb-cta>`:`\n        <nb-add-to-cart\n            sku="${i}"\n            longSku="${s}"\n            buttonSize="${d}"\n            showPrice\n            range='${t}'\n            position='${n}'\n            rendererName='${c}'\n        ></nb-add-to-cart>\n    `})(this.props)}renderAction(){return this.renderActionDefault()}renderFooterDefault(){return(({additional_message_icon:e,additional_message:t,additional_message_link:i})=>{if(!t&&!i)return"";let s="";if(t){let i="";e&&(i=`<nb-icon icon="${e}" class="additionalMsgIcon"></nb-icon>`),s=`<p class="cb-warn t-sm-500-sl">\n            ${i}\n            ${t}</p>`}return i&&i.link&&i.label&&(s+=`<nb-link\n            link='${i.link}'\n            color="${i.color}"\n            size="${i.size}"\n            seo_label="${i.seo_label}">\n            ${i.label}\n        </nb-link>`),s})(this.props)}renderFooter(){return this.renderFooterDefault()}async onPDPLinkClick(){window.napi&&window.napi.data&&window.napi.data().product().setProductClickData(await window.productHelper.getPadlProductDetail(await window.napi.catalog().getProduct(this.props.longSku)))}bindEvent(){this.linkElements=[],this.unbindEvent(),this.linkElements=this.querySelectorAll("a[href]"),this.linkElements.length&&Array.from(this.linkElements).forEach((e=>{e.addEventListener("click",this.boundOnPDPLinkClick)}))}unbindEvent(){this.linkElements.length&&(Array.from(this.linkElements).forEach((e=>{e.removeEventListener("click",this.boundOnPDPLinkClick)})),this.linkElements=[])}disconnectedCallback(){this.unbindEvent()}}customElements.get("nb-sku")||customElements.define("nb-sku",k);const w=({colors:e,sku:t,max_colors:i=4,a11y_extra_color:s="",url:n,activeSku:r,name:a})=>{if(!e)return"";return`<nb-colors data="${c({colors:e,max_colors:i,activeSku:r||t,extra_url:n,extra_title:a+", "+s})}" size="${u.is.mobile?"small":"large"}"></nb-colors>`},E=window.napi&&window.napi.ratings,C=async e=>{const t=`n-ratings-${e}`;let i=(e=>{const t=localStorage.getItem(e);if(!t)return;const i=JSON.parse(t);if(!((new Date).getTime()>i.expiry))return i.value;localStorage.removeItem(e)})(t);return void 0===i&&(i=await E().summary(e),((e,t)=>{const i={value:t,expiry:(new Date).getTime()+864e5};localStorage.setItem(e,JSON.stringify(i))})(t,i)),i},L=(e,t)=>e.reviewCount>0&&e.ratingAverage>0&&e.ratingAverage>=t,$=({sku:e,minimum_rating:t=0},i)=>(C(e).then((e=>{const s=i.querySelector(".cb-ratings-block");if(!e||!L(e,t))return s.innerHTML="","";s.innerHTML=`<nb-rating stars="${e.ratingAverage}"></nb-rating>`})),""),S=({eventName:e,args:t,element:i})=>{let s;i=i||window,t?s=new CustomEvent(e,{detail:t,bubbles:!0}):"function"==typeof Event?s=new Event(e):(s=document.createEvent("Event"),s.initEvent(e,!0,!0)),i.dispatchEvent(s)},O=e=>{if(e.detail)return e.detail};class P{constructor(){this.promise=new Promise(((e,t)=>{this.reject=t,this.resolve=e}))}}const T=(e,t={})=>{const i={scrollPaddingTop:140,scrollDuration:300,...t},s=new P;let n;const r=typeof e;if(["string","object"].indexOf(r)>-1){n=e,"string"===r&&(n=document.querySelector(e));try{e=window.pageYOffset+n.getBoundingClientRect().top-i.scrollPaddingTop}catch(t){throw new Error(`error: No element found with the selector "${e}"`)}}else"number"!=typeof e&&(e=0);let a=window.performance.now(),o=0,l=window.pageYOffset-e,c=window.innerHeight,d=document.body.clientHeight;l>c&&d-c>0&&(i.scrollDuration=Math.abs(i.scrollDuration+i.scrollDuration*(Math.abs(l)/(d-c))));let u=a+i.scrollDuration;return window.requestAnimationFrame((function t(){let n=window.performance.now();if(n<u){o=(n-a)/i.scrollDuration,o=--o*o*o+1;const s=l*o;window.scrollTo(0,e+(l-s)),window.requestAnimationFrame(t)}else window.scrollTo(0,e),setTimeout((()=>s.resolve()),125);return s.promise})),s.promise};customElements.get("nb-sku-machine")||customElements.define("nb-sku-machine",class extends k{constructor(){super(),this.type="machine",this.reviewLink=null,this.boundOnColorClick=this.onColorClick.bind(this),this.boundOnReviewLinkClick=this.onReviewLinkClick.bind(this)}renderHeader(){return`${this.renderHeaderDefault()}\n                ${(e=>{const{a11y_energy_label:t,energy_level:i}=e;return i?`<nb-energy-label data='${c({a11y_label:t,level:i})}'></nb-energy-label>`:""})(this.props)}`}renderInformation(){const{variation:e}=this.props;return"pdp"===e?this.renderInformationPDP():e===h?this.renderInformationPLP():this.renderInformationDefault()}renderInformationDefault(){return`${w(this.props)}\n                ${m(this.props)}\n                ${_(this.props)}\n                ${b(this.props)}\n                ${this.props.show_ratings&&(e=this.props,e.productRatings&&e.productRatings.ratingEnabled)?`<div class="cb-ratings-block"><nb-loader></nb-loader></div> ${$(this.props,this)}`:""}\n                ${g(this.props)}`;var e}renderInformationPLP(){return`${w(this.props)}\n                ${m(this.props)}\n                ${_(this.props)}\n                ${b(this.props)}\n                ${this.props.show_ratings?`<div class="cb-ratings-block"><nb-loader></nb-loader></div> ${$({...this.props,sku:this.props.sku||this.props.legacyId},this)}`:""}\n                ${g(this.props)}`}renderInformationPDP(){return`${m(this.props)}\n                ${_(this.props)}\n                ${b(this.props)}\n                ${g(this.props)}\n                ${(e=>{const{show_ratings:t,minimum_rating:i=0,ratingAverage:s,reviewCount:n,review_cta:r,reviews_cta:a}=e;if(!t||!L(e,i))return"";const o=(n>1?a:r).replace("{nb_review}",n);let l="";return o&&(l=`<nb-link class="is-review" icon_right="chevron-right" size="small" color="gold">\n                    ${o}\n                </nb-link>`),`<nb-rating stars="${s.toFixed(2)}"></nb-rating>\n            ${l}`})(this.props)}\n                ${(({show_voltage:e,voltage_label:t,voltage_list:i,a11y_voltage_label:s,a11y_volts_label:n})=>e&&t&&i&&i.length?`<div class="cb-sku-tab">\n        <span class="sr-only">${s}</span>\n        <p class='t-sm-400' aria-hidden="true">${t}</p>\n        ${i.map((({label:e,url:t})=>t?`<a href="${t}" target="_self"><span class="t-sm-400-caps">${e}<span aria-hidden="true">V</span><span class='sr-only'> ${n}</span></span></a>`:`<div aria-current="page"><span class="t-sm-700-caps">${e}<span aria-hidden="true">V</span><span class='sr-only'> ${n}</span></span></div>`)).join("")}\n    </div>`:"")(this.props)}\n                ${w(this.props)}`}onReviewLinkClick(e){e.preventDefault(),T("nb-rating-reviews")}onColorClick(e){const t=O(e);var i;t.sku&&(this.template="<nb-loader></nb-loader>",this.render(),(i=t.sku,window.napi.catalog().getProduct(i)).then((e=>{e&&(this.props={...this.props,...e,sku:e.internationalId||"",longSku:e.id||"",image:e.images?.icon||"",image_alt_text:e.name||"",price:e.price,activeSku:e.internationalId||""})})).catch((()=>{console.error(`getProduct fail on sku ${t.sku}`)})).finally((()=>{this.loadTemplate(),this.onReady?.()})))}bindEvent(){this.addEventListener("EVENT_COLOR_CLICKED",this.boundOnColorClick),this.reviewLink=this.querySelector(".is-review"),this.reviewLink&&this.addEventListener("click",this.boundOnReviewLinkClick)}unbindEvent(){this.removeEventListener("EVENT_COLOR_CLICKED",this.boundOnColorClick),this.reviewLink&&this.removeEventListener("click",this.boundOnReviewLinkClick)}disconnectedCallback(){this.unbindEvent()}});const A=e=>{const t=(e=>e.find((e=>"data"===e.nodeName)))([...e]),i=[...e].filter((e=>"data"!==e.nodeName)).reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{});if(N(t))return i;try{return{...i,...JSON.parse(t.nodeValue)}}catch(e){console.log("ERROR: No data",e)}},N=e=>null==e;class I{constructor(){this._bus=document.createElement("div")}register(e,t){this._bus.addEventListener(e,t)}remove(e,t){this._bus.removeEventListener(e,t)}fire(e,t={}){this._bus.dispatchEvent(new CustomEvent(e,{detail:t}))}}if(!x)var x=new I;var M=x;window.gtmDataObject=window.gtmDataObject||[];const B=e=>{window.gtmDataObject.push({event:"customEvent",eventRaisedBy:"Web component",eventCategory:"User Engagement",eventAction:"Click",eventLabel:"",nonInteraction:0,...e})},D=e=>{window.gtmDataObject.push({event:"impression",eventRaisedBy:"Web component",eventAction:"Promo Impression - On Scroll",ecommerce:{},...e})},F=e=>{window.gtmDataObject.push({event:"promoClick",eventRaisedBy:"Web component",ecommerce:{},...e})},H=()=>window[window?.padlNamespace]?.dataLayer,q=()=>{const e=H();return e?e.app.app.market.toLocaleLowerCase():"ch"},R=()=>H()?H().page.page.pageInfo.language.toLocaleLowerCase():"en";class z extends HTMLElement{constructor(){super(),this.props={},this.market=q(),this.language=R()}static get observedAttributes(){return["slot","quantity"]}connectedCallback(){this.props=A(this.attributes),this.boundHandleClick=this.handleClick.bind(this),this.slot=this.innerHTML.replace(/\n*$/,"").trim(),this.render()}render(){const{variation:e,contrast:t,transparent:i="false",size:s="48",icon_right:n="",icon_left:r="",label:a,seo_label:o="",aria_label_before:l,aria_label_after:c,link_new_tab:d=!1,label_update:u,add_to_cart:h=""}=this.props;let{link:p}=this.props;const b=this.slot?this.slot:a,g=document.createElement(p?"a":"button");p&&(p=p.replace("{market}",this.market),p=p.replace("{lang}",this.language),g.setAttribute("href",p)),p&&d&&g.setAttribute("target","_blank"),o&&p&&g.setAttribute("title",o),l&&g.setAttribute("aria-label",l+" "+b),c&&g.setAttribute("aria-label",b+" "+c),l&&c&&g.setAttribute("aria-label",l+" "+b+" "+c),"navigation"!==e&&g.classList.add("button--cta"),g.classList.add(`button--${e}`),t&&("true"===i?g.classList.add(`button--${t}--transparent`):g.classList.add(`button--${t}`)),s&&g.classList.add(`size--${s}`),"primary"!==e&&"tertiary"!==e||""===h||(this.setAttribute("quantity","0"),"small"===h?g.classList.add("addToCart--small"):g.classList.add("addToCart--large")),r&&this.setAttribute("icon_left",r),n&&this.setAttribute("icon_right",n),g.innerHTML=`\n                ${r&&`<nb-icon icon='${r}'></nb-icon>`}\n                <span>${b}</span>\n                ${"primary"===e&&""!==h&&""!==u?`<span class="update">${u}</span>`:""}\n                ${n&&`<nb-icon icon='${n}'></nb-icon>`}\n        `,this.innerHTML=g.outerHTML,this.removeListeners(),this.addListeners()}handleClick(){this.track();const{event_id:e="",popin_id:t="",qs_id:i=""}=this.props;e&&M.fire(e,{}),t&&this.popin(t),i&&this.openQuantitySelector(i)}popin(e){S({eventName:t,args:{id:e}})}openQuantitySelector(e){S({eventName:"WEB_COMPONENT_QS_OPEN",args:{id:e}})}track(){this.props.campaign_id&&this.handlePromoClick(),this.props.tracking_label&&this.handleCustomEvent()}handlePromoClick(){const{campaign_id:e="",campaign_name:t="",campaign_position:i="",campaign_creative:s=""}=this.props;""!==e&&F({ecommerce:{promoClick:{promotions:[{id:e,name:t,position:i,creative:s}]}}})}handleCustomEvent(){const{tracking_label:e=""}=this.props;""!==e&&B({eventAction:"Click CTA",eventLabel:e})}attributeChangedCallback(e){"slot"===e&&this.render(),"quantity"===e&&(this.classList.add("updated"),setTimeout((()=>{this.classList.remove("updated")}),1200))}addListeners(){this.addEventListener("click",this.boundHandleClick)}removeListeners(){this.removeEventListener("click",this.boundHandleClick)}disconnectedCallback(){this.removeListeners()}}customElements.get("nb-cta")||customElements.define("nb-cta",z);class j extends HTMLElement{constructor(){super(),this.slot=this.innerHTML,this.boundHandleClick=this.handleClick.bind(this),this.market=q(),this.language=R()}connectedCallback(){this.props=A(this.attributes),this.render(),this.setClassHelper(),this.bindEvents()}render(){const{size:e="large",color:t="gold",link:i="",icon_right:s="",icon_left:n="",image:r="",image_alt:a=""}=this.props;e&&this.setAttribute("size",e),t&&this.setAttribute("color",t),r&&this.setAttribute("image",r),a&&this.setAttribute("image_alt",a),n&&this.setAttribute("icon_left",n),s&&this.setAttribute("icon_right",s),""===i?this.renderButton():this.renderLink(),this.link=this.firstElementChild}renderLink(){const{label:e,seo_label:t="",tracking_label:i="",link_new_tab:s="false",a11y_label_new_tab:n="",icon_right:r="",image:a="",image_alt:o="",icon_left:l="",selected:c="",phantom:d=""}=this.props;let{link:u}=this.props;const h=this.slot?this.slot:e;u&&(u=u.replace("{market}",this.market),u=u.replace("{lang}",this.language)),this.innerHTML=`\n        <a\n            href="${u}"\n            ${"true"===s?'target="_blank"':""}\n            ${"true"===s&&""!==n?`aria-description='${n}'`:""}\n            ${i&&`tracking_label='${i}'`}\n            ${t?`title="${t}"`:""}\n            ${"true"===c?'aria-selected="true"':""}\n            ${"true"===d?`phantom="${h}"`:""}\n        >\n            ${l&&`<nb-icon icon='${l}'></nb-icon>`}\n            ${a&&`<img src='${a}' alt='${o}'/>`}\n            <span>${h}</span>\n            ${r&&`<nb-icon icon='${r}'></nb-icon>`}\n        </a>`}renderButton(){const{label:e,tracking_label:t="",icon_right:i="",icon_left:s="",selected:n="",image:r="",image_alt:a="",phantom:o=""}=this.props,l=this.slot?this.slot:e;this.innerHTML=`\n        <button\n            ${t&&`tracking_label='${t}'`}\n            ${"true"===n?'aria-selected="true"':""}\n            ${"true"===o?`phantom="${l}"`:""}\n        >\n            ${r&&`<img src='${r}' alt='${a}'/>`}\n            ${s&&`<nb-icon icon='${s}'></nb-icon>`}\n            <span>${l}</span>\n            ${i&&`<nb-icon icon='${i}'></nb-icon>`}\n        </button>`}setClassHelper(){const{size:e="large",cta_link_type:t="false"}=this.props;let i="";switch(e){case"xsmall":i="t-2xs-500";break;case"small":i="t-xs-500-sl";break;case"medium":i="t-sm-400-sl";break;default:i="t-xs-700-caps-sl"}"true"===t&&(i="t-sm-700-caps-sl",this.setAttribute("underline","false")),this.querySelector("a, button").classList.add(i)}handleClick(){this.track();const{popin_id:e=""}=this.props;e&&this.popin(e)}popin(e){S({eventName:t,args:{id:e}})}track(){this.props.campaign_id&&this.handlePromoClick(),this.props.custom_tracking&&this.handleCustomEvent()}handlePromoClick(){const{campaign_id:e="",campaign_name:t="",campaign_position:i="",campaign_creative:s=""}=this.props;""!==e&&F({ecommerce:{promoClick:{promotions:[{id:e,name:t,position:i,creative:s}]}}})}handleCustomEvent(){const{tracking_label:e=""}=this.props;""!==e&&B({eventAction:"Click",eventLabel:e})}bindEvents(){this.unbindEvents(),this.link.addEventListener("click",this.boundHandleClick)}unbindEvents(){this.link.removeEventListener("click",this.boundHandleClick)}disconnectedCallback(){this.unbindEvents()}}customElements.get("nb-link")||customElements.define("nb-link",j);class V{constructor(e,t){this.observer=new IntersectionObserver((e=>this.onChange(e)),{threshold:[0],rootMargin:"0% 0%"}),this.el=e,this.data=t,this.el instanceof Element&&this.observer.observe(this.el)}onChange(e){e.forEach((e=>{e.isIntersecting&&(this.track(e),this.observer.unobserve(e.target))}))}track(){window.requestIdleCallback((()=>this.runTrack()))}runTrack(){this.data.id&&null!==this.data.id&&""!==this.data.id&&D({ecommerce:{promoView:{promotions:[this.data]}}})}}function W(e,t){const i=new G(e,t);return{destroy:()=>{i.getIom().hasIntersectionObserver()||i.destroy()}}}class G extends V{constructor(e,t){super(e),this.data=t}runTrack(){this.data.id&&null!==this.data.id&&""!==this.data.id&&D({ecommerce:{promoView:{promotions:[this.data]}}})}}class U extends HTMLElement{constructor(){super(),this.slot=this.innerHTML}connectedCallback(){this.props=[...this.attributes].reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{}),this.render(),this.initTracking(),this.initLazyLoad()}initTracking(){const{campaign_id:e=null,campaign_name:t=null,campaign_position:i=null,campaign_creative:s=null}=this.props;W(this,{id:e,name:t,position:i,creative:s})}initLazyLoad(){const e=this.querySelector(".cb-bg-img");if(!e)return;const t=this.getBgImgUrl();t&&l(e,"style",`background-image: url(${t}); ${e.getAttribute("style")||""}`,t)}getBgImgUrl(){const{background_mobile:e="",background_tablet:t="",background_desktop:i="",background_retina:s=""}=this.props;return u.is.mobile&&e?e:u.is.tablet&&t?t:u.is.retina&&s?s:i}render(){const{styles:e="",contrast:t,background_color:i="",classname:s="",element_class:n="",slot:r}=this.props;let a="light";"undefined"===t?this.setAttribute("contrast",a):a=t,this.innerHTML=`\n            <section\n                class="${s}"\n                contrast="${a}"\n                style="${e}"\n            >\n                ${i||this.hasBgImage()?this.renderBg():""}\n                <div class="cb-inner ${n}">\n                    ${r}\n                </div>\n            </section>`}hasBgImage(){const{background_mobile:e,background_desktop:t,background_retina:i}=this.props;return!!e||!!t||!!i}renderBg(){const{background_color:e=""}=this.props;return`<div class="cb-bg-color ${e?`${e}`:""}">\n        </div>${this.hasBgImage()?'<div class="cb-bg-img"></div>':""}`}}customElements.get("nb-container")||customElements.define("nb-container",U);const K=["upvote","19-bar","24-7-service","360-view","accessories-and-sweets","address-2","address","amex-card","android","apple-pay-card","apple-pay","apple","arrow-bottom","arrow-filled-down","arrow-left","arrow-right","arrow-top","assistance-alt","assistance-videos","assistance","boutique","brand_coffee_capsule-vl-carafe","brand_coffee_capsule-vl-double-espresso-gran-lungo","brand_coffee_capsule-vl-espresso","brand_coffee_capsule-vl-mug","brand_coffee_capsule_ol","brand_coffee_capsule_pro","brand_coffee_capsule_vl","brand_coffee_cereals","brand_coffee_citrus","brand_coffee_cocoa","brand_coffee_coffee-assortment","brand_coffee_coffee-discovery-set","brand_coffee_machines","brand_coffee_malted","brand_coffee_notes-herbal","brand_delivery_boutique-location","brand_delivery_delivery","brand_delivery_free_delivery","brand_delivery_package","brand_delivery_schedule_delivery","brand_general_coffee","brand_machines_auto_clean_system","brand_machines_automatic_off","brand_machines_digital_display","brand_machines_energy_class","brand_machines_fast_heat_up","brand_machines_low_water_alert","brand_machines_milk_frothing","brand_machines_pump_pressure_bar","brand_payment_credit_card","brand_payment_gift_card","brand_payment_invoice","brand_payment_secure","brand_services_assistance","brand_services_boutique","brand_services_easy_order","brand_services_help","brand_services_promotions","brand_services_recycling","brand_services_recycling_ol","brand_services_recycling_vl","brand_services_subscription","brand_services_sustainability","calendar","capsule-cupSize-Cappuccino-And-Latte-Macchiato","capsule-cupSize-Cortado-Cappuccino","capsule-cupSize-icedRecipe-vertuo","capsule-cupSize-icedRecipe","capsule-cupSize-alto","capsule-cupSize-carafe-vertuo","capsule-cupSize-coffee","capsule-cupSize-double-espresso-vertuo","capsule-cupSize-espresso-vertuo","capsule-cupSize-espresso","capsule-cupSize-gran-lungo","capsule-cupSize-lungo","capsule-cupSize-mug","capsule-cupSize-ristretto","capsule-cupSize-americano","capsule-cupSize-large-americano","check","chevron-down","chevron-left","chevron-right","chevron-up","check-mark","clock","close-2","close","coffee","coffee_capsule-ol_24","credit-card-flag","credit-card","delivery-fast","delivery-scheduled","delivery-standard","eco-mode","edit","error","espresso-vertuo-capsule","eye-closed","eye-opened","facebook","filter","find-us-alt","find-us","free-return","gift-card","globe","gran-lungo-vertuo-capsule","help","hero-chat","huawei","information-24","information","instagram","invoice","language","linkedin","link","live-chat","loading-nitro","loading","loan","logout","machine_machines_ol_24","machines-2","machines","mail","mastercard-card","mastercard","menu","minus-16","minus-24","minus-o","modal-alert","modal-check","more-info","nespresso-logo","nespresso-monogram","nespresso-professional-2","nespresso-professional","nespresso","notification","orders","original","package-box","payment-bcorp","payment-bvr","payment-google-pay","payment-ideal","payment-klarna","payment-lsv","payment-postfinance","payment-twint","paypal-card","paypal","phone","pin","pinterest","play-button","play-mini","play","plus-16","plus-24","plus-o","promotions","recycling-point","recycling","remove","search","secure","set-up","shopping-bag","signal-high","signal-low","signal-med","speed","star","rating","subscription-2","subscription","sustainability","tag","twitter","ui_payment_cash","ui_coffee_bergamot","ui_coffee_capsule-ol","ui_coffee_capsule-vl-carafe","ui_coffee_capsule-vl-double-espresso_gran-lungo","ui_coffee_capsule-vl-espresso","ui_coffee_capsule-vl-mug","ui_coffee_capsule-vl","ui_coffee_capsule_professional","ui_coffee_cardamom","ui_coffee_cocoa","ui_coffee_hazelnut","ui_coffee_honey","ui_coffee_notes-cereal","ui_coffee_notes-malted","ui_coffee_winey","ui_delivery_calendar","ui_delivery_clock","ui_general_alerts","ui_general_arrow-right","ui_general_check","ui_general_chevron-bottom","ui_general_chevron-left","ui_general_chevron-right","ui_general_chevron-top","ui_general_credit-card","ui_general_edit","ui_general_error","ui_general_eye-close","ui_general_eye-open","ui_general_faq","ui_general_filter","ui_general_gift-card","ui_general_globe","ui_general_information","ui_general_language","ui_general_link","ui_general_loading","ui_general_log-out","ui_general_map_view","ui_general_menu","ui_general_minus","ui_general_notification","ui_general_order","ui_general_play","ui_general_plus","ui_general_promotions","ui_general_remove","ui_general_search","ui_general_secure","ui_general_shopping-bag","ui_general_tag","ui_general_user-account","ui_general_warranty","ui_general_wifi","ui_general_x","ui_map_directions","ui_payment_invoice","ui_services_assistance","ui_services_delivery","ui_services_easy_order","ui_services_find-us","ui_services_free-return","ui_services_mail","ui_services_phone","ui_services_subscription","ui_sustainability_climate","ui_sustainability_recycling","ui_sustainability_recycling_ol","ui_sustainability_recycling_vl","ui_sustainability_social_sustainability","ui_user_member_status","ui_user_my-address","ui_user_my_information","ultra-compact","user-account","versatil-coffee-system","video-play","vertuo","visa-card","visa","warranty","youtube","services-anticipation-of-maintenance","services-assistance","services-avant-premiere","services-avant-premiere-ol","services-avant-premiere-vl","services-coffee-assortment","services-coffee-coffee-sample","services-coffee-discovery-set","services-coffee-experiences","services-contact-chat","services-contact-community-forum","services-contact-mobile","services-contact-sms","services-contact-video-assistance","services-contact-virtual","services-data-insight","services-delivery-boutique-location","services-delivery-boutique-pick-up","services-delivery-delivery","services-delivery-delivery-bike","services-delivery-delivery-fast","services-delivery-free-delivery","services-delivery-next-day-delivery","services-delivery-package","services-delivery-pick-up-points","services-delivery-schedule-delivery","services-easy-maintenance","services-easy-order","services-easy-stock-management","services-generic","services-gifting-card","services-help","services-orders","services-payments-credit-card","services-payments-gift-card","services-payments-invoice","services-phone","services-reorder","services-satisfied-or-reimbursed","services-services-boutique","services-subscription","services-vip-masterclass","services-voice-enabled","payments-cash","delivery-same-day-delivery","contact-voice-assistant-chatbot","contact-video-chat","contact-mobile-push-notification","contact-chat-bot","coffee-coffee-tasting","contact-video-assistance"].concat(["notes-almonds","notes-balanced","notes-bergamot","notes-berry","notes-biscuity","notes-blueberry","notes-cardamom","notes-cereal","notes-citrus","notes-cocoa","notes-default","notes-flowery","notes-fruity","notes-hazelnut","notes-herbal","notes-honey","notes-leather","notes-malted","notes-roasted","notes-spicy","notes-sugar","notes-winey","notes-wood","notes-brand-coffee-roasted","notes-brand-coffee-caramel","notes-brand-coffee-intense-roasted"]).concat(["machine_technology_machine-ol","machine_technology_machine-vl","machine_details_deluxe-version","machine_details_machine-tutorial-ol","machine_details_machine-tutorial-vl","machine_warranty_warranty-ol","machine_warranty_warranty-vl","machine_features_generic","machine_features_auto-clean-system","machine_features_automatic-off","machine_features_blend-specific-brewing","machine_features_bluetooth","machine_features_capsule-ejection-ol","machine_features_capsule-ejection-vl","machine_features_centrifusion","machine_features_cold-foam-ol","machine_features_cold-foam-vl","machine_features_descale-alert","machine_features_descale","machine_features_digital-display","machine_features_dimensions","machine_features_eco-mode","machine_features_energy-class","machine_features_fast-heat-up","machine_features_hot-foam-ol","machine_features_hot-foam-vl","machine_features_hot-milk","machine_features_hot-foam","machine_features_hot-water","machine_features_low-water-alert","machine_features_manual-lever","machine_features_milk-frothing","machine_features_mobile-push-notification","machine_features_one-touch","machine_features_power-off","machine_features_pump-pressure-bar","machine_features_rinse","machine_features_settings","machine_features_steam","machine_features_temperature-settings-invert","machine_features_temperature-settings","machine_features_temperature","machine_features_ultra-compact","machine_features_water-tank","machine_features_weight"]),Y=window.memoPromiseCache?window.memoPromiseCache:{};class Q{constructor(e){this.getPromise=e,this.request=this.request.bind(this)}request({uniqueKey:e,url:t}){if(!e)return Promise.reject(new Error("Unique key not passed"));if(!Y[e]){const i=this.getPromise(t);Y[e]=i.then((e=>e.text())).catch((t=>{throw delete Y[e],t}))}return Y[e]}}class J extends HTMLElement{constructor(){super(),this.props={},this.path="",this.source=""}connectedCallback(){this.props=A(this.attributes),this.classList.add("lazy-load"),this.classList.add("nb-svg"),this.beforeRender(),this.render()}beforeRender(){}render(){if(""===this.source)return void console.error(`Error: Component SVG - render - 'source' property is not set:${this.source}`);this.innerHTML="<svg></svg>",this.afterHtmlRender();const e=this;!function(e,t){if(/Trident\/|MSIE/.test(window.navigator.userAgent)||(i=window.navigator.userAgent,s=i.indexOf("OS "),(i.indexOf("iPhone")>-1||i.indexOf("iPad")>-1)&&s>-1&&window.Number(i.substr(s+3,3).replace("_","."))<14))t();else if("IntersectionObserver"in window){let i=new IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting&&(t(),i.unobserve(e.target))}))}),{above:[0],rootMargin:"150% 0px"});i.observe(e)}var i,s}(e,(()=>{e.fetchSVG(this.source,`${this.path}${this.source}.svg`)}))}afterHtmlRender(){}request(e){return fetch(e)}async fetchSVG(e,t){const i=this.firstElementChild,s=new Q(this.request),{request:n}=s;let r=await n({uniqueKey:e,url:t});let a=(new DOMParser).parseFromString(r,"image/svg+xml").getElementsByTagName("svg");if(!a.length)return console.error(`Error: Component SVG - fetchSVG - SVG not found ${a}`),this.classList.remove("lazy-load"),void this.classList.add("lazy-loaded-error");this.classList.remove("lazy-load"),this.classList.add("lazy-loaded"),a=a[0];const o=a.attributes,l=o.length;for(let e=0;e<l;++e)if(o[e].specified)if("class"===o[e].name){const t=o[e].value.replace(/\s+/g," ").trim().split(" "),s=t.length;for(let e=0;e<s;++e)i.classList.add(t[e])}else i.setAttribute(o[e].name,o[e].value);for(;a.childNodes.length;)i.appendChild(a.childNodes[0])}}customElements.get("nb-svg")||customElements.define("nb-svg",J);customElements.get("nb-icon")||customElements.define("nb-icon",class extends J{beforeRender(){const{icon:e}=this.props;-1!==K.indexOf(e)?(this.classList.add("nb-icon"),this.path="/shared_res/agility/next-components/assets/icons/",this.source=e):console.error(`Error: Component Icon - beforeRender - 'icon' is not part of the authorized list - Icon name:${e}`)}afterHtmlRender(){this.setAttribute("aria-hidden","true")}});class X extends HTMLElement{constructor(){super(),this.slot=this.innerHTML,this.checkbox=null}static get observedAttributes(){return["disabled","checked"]}connectedCallback(){this.props=A(this.attributes),this.render()}render(){const{content:e,icon:t="",color:i="",background_image:s="",filter_label_AA:n="filter",rounded:r="true",checked:a="false",disabled:o="false"}=this.props,l=this.slot?this.slot:e;const c="true"===a?"checked":"",d="true"===o?"disabled":"";this.innerHTML=`\n            <input type='checkbox' name='options' aria-label="${l+" "+n}" ${c} ${d}>\n            <label style=''>\n                ${t&&`<nb-icon icon='${t}'></nb-icon>\n                `}\n                ${i&&`<div class='chip-color' style='background:${i}'></div>\n                `}\n                ${s&&`<div class='chip-image ${"true"===r?"rounded":""}' style='background-image:url("${s}")'></div>\n                `}\n                <span aria-hidden="true" phantom="${l}">${l}</span>\n            </label>\n        `,this.querySelector("label").addEventListener("click",(e=>{e.preventDefault(),this.querySelector("input").click()})),this.checkbox=this.getElementsByTagName("input")[0]}attributeChangedCallback(e,t,i){this.checkbox&&("disabled"===e?this.checkbox.disabled="true"===i:"checked"===e&&(this.checkbox.checked="true"===i))}disconnectedCallback(){this.querySelector("label").removeEventListener("click",(e=>{e.preventDefault(),this.querySelector("input").click()}))}}function Z(e,t){const i=e.parentNode;if(i===document.getElementsByTagName("body")[0])return;const s=i.children;for(const i of s)i!==e&&(t?i.setAttribute("aria-hidden",t):i.removeAttribute("aria-hidden"));Z(i,t)}function ee(e,t,i){t.contains(e.target)?t.lastFocused=e.target:t.lastFocused===t.firstFocusable?i?t.lastFocusable.focus():t.firstFocusable.focus():i?t.firstFocusable.focus():t.lastFocusable.focus()}function te(e){const t=e.querySelectorAll('button, [href], input, select, textarea, [tabindex="0"]');e.firstFocusable=t[0],e.lastFocusable=t[t.length-1],e.lastFocused=e.firstFocusable}customElements.get("nb-chip")||customElements.define("nb-chip",X);class ie extends HTMLElement{constructor(){super(),this.isOpen=!1,this.selected=null,this.buttonElement=null,this.onClickOutside=this.onClickOutside.bind(this)}connectedCallback(){this.props=A(this.attributes),this.render()}render(){this.buttonElement=null;const{label:e="",aa_description:t}=this.props;let{options:i}=this.props;i=i.map((e=>{const t={...e};return t.checked=t.checked||t.selected,t})),this.unbindEvent(),this.innerHTML=`\n            <button\n                class='nb-dropdown__button'\n                aria-haspopup="listbox"\n                aria-expanded="${this.isOpen}"\n                aria-label="${e} ${i&&this.renderSelected()}"\n                ${""!==t?`aria-description="${t}"`:""}>\n                    <span class="nb-dropdown__button__label t-xs-700-caps-sl">${e}</span>\n                    <span class="nb-dropdown__button__value t-xs-500-sl" value="${i&&this.renderSelected()}">\n                    </span>\n                </button>\n            <div class="nb-dropdown__menu">\n                <div role="listbox">\n                    ${i&&i.length>0&&this.renderOptions()}\n                </div>\n            </div>\n        `,this.buttonElement=this.querySelector(".nb-dropdown__button"),this.buttonElementValue=this.querySelector(".nb-dropdown__button__value"),this.dropdownMenu=this.querySelector(".nb-dropdown__menu > div"),this.selectedOption=this.querySelector("button[aria-selected=true]"),this.selected||(this.selected=i[0]),te(this.dropdownMenu),this.bindEvent()}renderOptions(){const{label:e,aa_listbox_description:t,aa_select_description:i,icon_option:s,options:n}=this.props;return n.map((n=>`<button\n                    class="${u.is.mobile?"t-sm-400-sl":"t-xs-500-sl"}"\n                    role="option"\n                    aria-label='${e+" "+n.label}'\n                    value='${n.label}'\n                    aria-selected='${n.checked}'\n                    ${n.link&&`data-link='${n.link}'`}\n                    ${n.checked?void 0!==t&&`aria-description="${t}"`:void 0!==i&&`aria-description="${i}"`}>\n                  ${s&&`<nb-icon icon='${s}'></nb-icon>`} ${n.label}\n                </button>`)).join("")}renderSelected(){const e=this.props.options.find((e=>!0===e.checked||!0===e.selected));return`${e&&e.label||this.props.options[0].label}`}bindEvent(){this.boundHandleClick=this.handleClick.bind(this),this.boundHandleLabelClick=this.handleLabelClick.bind(this),this.boundHandleMobileClose=this.handleMobileClose.bind(this),this.boundFocus=this.focus.bind(this),this.boundFocusin=this.focusin.bind(this),this.boundKeyNav=this.keyNav.bind(this),this.buttonElement.addEventListener("click",this.boundHandleClick),this.querySelectorAll(".nb-dropdown__menu button").forEach((e=>{e.addEventListener("click",this.boundHandleLabelClick)})),this.dropdownMenu.addEventListener("click",this.boundHandleMobileClose),window.addEventListener("click",this.onClickOutside)}unbindEvent(){this.buttonElement&&(this.buttonElement.removeEventListener("click",this.boundHandleClick),this.querySelectorAll(".nb-dropdown__menu button").forEach((e=>{e.removeEventListener("click",this.boundHandleLabelClick)})),this.dropdownMenu.removeEventListener("click",this.boundHandleMobileClose),window.removeEventListener("click",this.onClickOutside),document.removeEventListener("keydown",this.boundKeyNav))}handleClick(){this.toogleDropdown(!this.isOpen)}handleMobileClose(){this.toogleDropdown(!1)}onClickOutside(e){!this.isOpen||e.target.classList.contains("nb-dropdown__button")||e.target.classList.contains("nb-dropdown__button__label")||e.target.classList.contains("nb-dropdown__button__value")||this.toogleDropdown(!1)}handleLabelClick(e){this.isOpen=!1,this.selectedOption.setAttribute("aria-selected","false"),this.selectedOption=e.target,this.selectedOption.setAttribute("aria-selected","true"),this.props.options=this.props.options.map((e=>({...e,checked:!1}))),this.selected=this.props.options.find((e=>e.label===this.selectedOption.value)),this.selected.checked=!0,this.reRender(),S({eventName:"WEB_COMPONENT_SORT_BY_CHANGE",args:{options:this.props.options,selected:this.selected},element:this})}reRender(){const{label:e,aa_listbox_description:t,aa_select_description:i}=this.props;this.buttonElementValue.setAttribute("value",this.selectedOption.value),this.buttonElement.setAttribute("aria-label",e+" "+this.renderSelected()),this.dropdownMenu.querySelectorAll("button").forEach((e=>{e.setAttribute("aria-description",i)})),this.selectedOption.setAttribute("aria-description",t)}setSelected(e,t=!1){const i=this.props.options.find((t=>t.value===e));i&&(this.selected.checked=!1,this.selected=i,this.selected.checked=!0),t&&S({eventName:"WEB_COMPONENT_SORT_BY_CHANGE",args:{options:this.props.options,selected:this.selected},element:this})}toogleDropdown(e){e?this.open():this.close(),this.isOpen=!this.isOpen,this.switchAriaModal(),this.buttonElement.setAttribute("aria-expanded",this.isOpen)}switchAriaModal(){this.dropdownMenu.setAttribute("aria-modal",this.isOpen),Z(this.dropdownMenu,this.isOpen)}open(){this.dropdownMenu.addEventListener("transitionend",this.boundFocus),document.addEventListener("focusin",this.boundFocusin),document.addEventListener("keydown",this.boundKeyNav),this.buttonElement.classList.add("isOpen"),this.openingSource=document.activeElement}close(){this.dropdownMenu.addEventListener("transitionend",this.boundFocus),document.removeEventListener("focusin",this.boundFocusin),document.removeEventListener("keydown",this.boundKeyNav),this.buttonElement.classList.remove("isOpen"),this.buttonElement.setAttribute("aria-expanded",!1)}focus(){this.dropdownMenu.removeEventListener("transitionend",this.boundFocus),this.isOpen?(this.selectedOption.focus(),this.dropdownMenu.lastFocused=this.selectedOption):this.buttonElement.focus()}focusin(e){ee(e,this.dropdownMenu,!1)}keyNav(e){switch(e.key){case"Escape":this.toogleDropdown(!1);break;case"ArrowUp":e.preventDefault(),this.prevOption();break;case"ArrowDown":e.preventDefault(),this.nextOption();break;case"Home":case"PageUp":e.preventDefault(),this.firstOption();break;case"End":case"PageDown":e.preventDefault(),this.lastOption()}}prevOption(){if(this.dropdownMenu.lastFocused!==this.dropdownMenu.firstFocusable){const e=this.dropdownMenu.lastFocused.previousElementSibling;e.focus(),this.dropdownMenu.lastFocused=e}}nextOption(){if(this.dropdownMenu.lastFocused!==this.dropdownMenu.lastFocusable){const e=this.dropdownMenu.lastFocused.nextElementSibling;e.focus(),this.dropdownMenu.lastFocused=e}}firstOption(){this.dropdownMenu.lastFocused!==this.dropdownMenu.firstFocusable&&(this.dropdownMenu.firstFocusable.focus(),this.dropdownMenu.lastFocused=this.dropdownMenu.firstFocusable)}lastOption(){this.dropdownMenu.lastFocused!==this.dropdownMenu.lastFocusable&&(this.dropdownMenu.lastFocusable.focus(),this.dropdownMenu.lastFocused=this.dropdownMenu.lastFocusable)}disconnectedCallback(){this.unbindEvent()}}customElements.get("nb-dropdown")||customElements.define("nb-dropdown",ie);class se extends V{constructor(e,t,i,s,n){super(e),this.data=t,this.currency=i,this.range=s,this.position=n}async runTrack(){if(!this.data)return;const e=await this.getCategories(this.data);window.impressionsOnScroll=window.impressionsOnScroll||{},window.impressionsOnScroll[this.data.internationalId]=this.buildGTMProductObject(this.data,e)}async getPLPCategory(e){return(await window.getPLPData()).data.configuration.eCommerceData.categories.find((t=>t.id===e))}async getCategoriesWithPlpData(e){const t="/machineTechno/",i=[...e.cupSizes,...e.flavors,...e.ranges,...e.technologies];return(await Promise.all(i.map((async e=>{const i=await this.getPLPCategory(e);return!i&&(e=>-1!==e.indexOf(t))(e)?(e=>e.substr(e.indexOf(t)+t.length))(e):i.name})))).join("|")}async getCategories(e){return e?window.getPLPData?this.getCategoriesWithPlpData(e):Promise.all(e.supercategories.map((e=>window.napi.catalog().getCategory(e)))).then((e=>{const t=[];for(const i of e){const e=i.code;if(!e)return;(~e.indexOf("-cupSize-")||~e.indexOf("-range-")||~e.indexOf("capsule-aromatic-")||~e.indexOf("machine-keyFeature-")||~e.indexOf("machine-color-")||~e.indexOf("accessory-collection-")||~e.indexOf("accessory-hero-month"))&&t.push(i.name.toLowerCase())}return t.join("|")})):""}buildGTMProductObject(e,t){let i;"capsule"===e.type?i="capsules":"accessory"===e.type?i="accessories":"machine"===e.type&&(i="machines");let s=null;e.technologies&&(s=e.technologies.map((e=>function(e=""){return e[0].toUpperCase()+e.slice(1)}(e.split("/")[2]))).join("|||"));let n="";null!=e.productSelections&&(n=e.productSelections.join("|"));const r={brand:"Nespresso",category:i,dimension43:"false",dimension44:"false",dimension53:e.legacyId,dimension54:o(e.name)[0].textContent,dimension55:t,dimension56:s,dimension57:this.isBundled(e)?"bundled":"single",dimension130:n,id:e.internationalId,name:o(e.internationalName)[0].textContent,price:e.price};return this.range&&(r.list=this.range),this.position&&(r.position=parseInt(this.position)),r}isBundled(e){let t=1===e.salesMultiple&&e.unitQuantity>1;return e.bundled?t=e.bundled:e.salesMultiple>1&&1===e.unitQuantity&&(t=!1),t}}class ne extends HTMLElement{connectedCallback(){this.sku=(this.getAttribute("sku")||"").trim(),this.range=this.getAttribute("range"),this.position=this.getAttribute("position"),this.longSku=(this.getAttribute("longSku")||"").trim(),this.buttonSize=this.getAttribute("buttonSize")||"small",this.rendererName=this.getAttribute("rendererName")||"default",this.elementID=`u-product-${""!==this.range?this.range.replace(/(\s|\W)/g,"")+"-":""}${this.position}-${this.sku}-${this.longSku.replace(/(\s|\W)/g,"")}-${this.rendererName}`,this.render(),this.isWindowNapiActive()&&(window.napi.getConfig().then((()=>{this.pushButton()})).catch((e=>console.error(e))),this.tracking().then((()=>{})).catch((e=>console.error(e))))}render(){this.innerHTML=`<div class="cb-AddToCart" id="${this.elementID}">\n                <button class='AddToBagButtonLarge'>\n                    <span class='AddToBagButtonLarge__label'>+</span>\n                </button>\n            </div>`}isWindowNapiActive(){return!!window.napi}pushButton(){if(!document.getElementById(this.elementID))return;const e=this.buttonSize;window.ui=window.ui||[],window.ui.push({id:this.elementID,module:"AddToBagButton",configuration:{props:{productId:this.longSku,buttonSize:e}},ecommerceData:{activated:!0}})}async tracking(){if(!this.isWindowNapiActive())return new Promise.resolve;!function(e,t,i,s,n){const r=new se(e,t,i,s,n)}(this,await this.getProductData(),window[window.config.padl.namespace].dataLayer.app.app.currency,this.range,this.position)}getSkuKey(e){return-1!==e.indexOf("prod/")?"id":"legacyId"}async getProductData(){if(null!=window.getPLPData){const e=this.getSkuKey(this.sku),t=await window.getPLPData(),i=[e,"internationalId","id","legacyId"];let s=0,n=null;for(;!n&&s<i.length-1;){const e=i[s];n=t.data.configuration.eCommerceData.products.find((t=>t[e]===this.sku)),s++}return n}if(this.isWindowNapiActive())return await window.napi.catalog().getProduct(this.longSku);console.error("Error: napi is not found.")}}customElements.get("nb-add-to-cart")||customElements.define("nb-add-to-cart",ne);const re=e=>[...e.querySelectorAll("[data-ref]")].reduce(ae,{}),ae=(e,t)=>{const{ref:i}=t.dataset,s=i.match(/(\w+)\[(.+)\]/);return null!==s?oe(e,t,s):{...e,[t.dataset.ref]:t}},oe=(e,t,[,i,s])=>(void 0===e[i]&&(e[i]=[]),e[i][s]=t,e);class le extends HTMLElement{constructor(){super(),this.baseClass="nb-bubble",this.boundOnSelected=this.onSelected.bind(this)}static get observedAttributes(){return["state"]}attributeChangedCallback(e){"state"===e&&this.updateState()}connectedCallback(){this.props=A(this.attributes),this.classes=this.createClasses(),this.render(),this.refs=re(this),this.bindEvent(),this.initLazyLoad()}initLazyLoad(){let{visual:{src:e="",src_retina:t=""}={}}=this.props;const{visual:i}=this.refs;u.is.retina&&t&&(e=t),i&&e&&l(i,"src",`${e}`,e)}createClasses(){const{state:e="default"}=this.props;return{base:`${this.baseClass} ${this.baseClass}--${e}`,label:this.getLabelClassName(),theme:`${this.baseClass}__theme`,visual:`${this.baseClass}__visual `,avatar:`${this.baseClass}__avatar`,outline:`${this.baseClass}__outline`}}getLabelClassName(){const{state:e="default"}=this.props,t=["selected","focus"].includes(e);return[`${this.baseClass}__label`,t?"t-xs-700-sl":"t-xs-500-sl"].join(" ")}render(){this.innerHTML=`\n            <div data-ref="button" class='${this.classes.base}'>\n                <div class='${this.classes.avatar}'>\n                    <div class='${this.classes.outline}'></div>\n                    ${this.renderBackground()}\n                    ${this.renderVisual()}\n                </div>\n                ${this.renderLabel()}\n            </div>\n        `}renderBackground(){const{theme:e="#e1dad0"}=this.props;return`\n            <div\n                class='${this.classes.theme}'\n                style='background-color: ${e};'\n            ></div>\n        `}renderVisual(){const{visual:{alt:e="",src:t=""}={}}=this.props;return`${t&&`<img class="${this.classes.visual}" src="" alt="${e}" data-ref="visual"/>`}`}renderLabel(){const{label:e}=this.props;return`${e&&`<div class="${this.classes.label}" data-ref="label">${e}</div>`}`}updateState(){if(this.refs){const{button:e,label:t}=this.refs;e.className="",t.className="",this.props=A(this.attributes),this.classes=this.createClasses(),e.className=this.classes.base,t.className=this.classes.label}}bindEvent(){window.addEventListener("EVENT_BUBBLE_SELECTED",this.boundOnSelected)}unbindEvent(){window.removeEventListener("EVENT_BUBBLE_SELECTED",this.boundOnSelected)}onSelected(e){const t=O(e),{bubble:i}=t;this.setAttribute("state",i===this?"selected":"default")}disconnectedCallback(){this.unbindEvent()}}customElements.get("nb-bubble")||customElements.define("nb-bubble",le);class ce extends HTMLElement{constructor(){super(),this.boundGetChips=this.getChips.bind(this)}connectedCallback(){this.props=A(this.attributes),this.render(),this.addEventListener(n,this.boundGetChips),this.querySelectorAll(".nb-dropdown__menu button").forEach((e=>{e.addEventListener("click",this.clickChip)}))}render(){const{navigation:e=[],navigation_bubbles:t=""}=this.props;this.classList.add("nb-plp-sticky-bar"),this.innerHTML=`<div class="nb-plp-sticky-bar--inner">\n                ${this.renderLinksSelect(e)}\n                ${this.renderBubblesSlide(t)}\n            </div>`}renderLinksSelect(e){if(u.is.mobile||!e||e.length<=1)return"";const t=e.map((e=>(e.checked=e.selected,e)));return`<div class="nb-plp-sticky-bar--dropdown">\n            <nb-dropdown\n                data='${c({icon_option:"check",options:t})}'\n            ></nb-dropdown>\n        </div>`}renderBubblesSlide(e){const{a11y_slider_previous_button:t="",a11y_slider_next_button:i=""}=this.props;return`<nb-navigation-bubbles\n                a11y_slider_previous_button="${t}"\n                a11y_slider_next_button="${i}"\n                sticky='true' data='${e}'></nb-navigation-bubbles>`}getChips(){this.querySelectorAll("nb-chip").forEach((e=>{e.addEventListener("click",this.clickChip)}))}clickChip(e){e.preventDefault();const t=e.currentTarget.getAttribute("data-link");t&&(window.location.href=t)}disconnectedCallback(){this.removeEventListener(n,this.boundGetChips),this.querySelectorAll("nb-chip").forEach((e=>{e.removeEventListener("click",this.clickChip)})),this.querySelectorAll(".nb-dropdown__menu button").forEach((e=>{e.removeEventListener("click",this.clickChip)}))}}customElements.get("nb-plp-sticky-bar")||customElements.define("nb-plp-sticky-bar",ce);
/*!
 * swiped-events.js - v@version@
 * Pure JavaScript swipe events
 * https://github.com/john-doherty/swiped-events
 * @inspiration https://stackoverflow.com/questions/16348031/disable-scrolling-when-touch-moving-certain-element
 * @author John Doherty <www.johndoherty.info>
 * @license MIT
 */
const de=(e,t,i)=>{if(e.nwcSwipeEvents)return;e.nwcSwipeEvents=!0,t.addEventListener("touchstart",(function(e){if("true"===e.target.getAttribute("data-swipe-ignore"))return;l=e.target,function(e){if(void 0===i||!i.contains(e))return;c=[],d=[];for(;e!==i;)c.push(e.scrollTop),d.push(e.scrollLeft),e=e.parentNode}(l),o=Date.now(),s=e.touches[0].clientX,n=e.touches[0].clientY,r=0,a=0}),!1),t.addEventListener("touchmove",(function(e){if(!s||!n)return;let t=e.touches[0].clientX,i=e.touches[0].clientY;r=s-t,a=n-i}),!1),t.addEventListener("touchend",(function(t){if(l!==t.target)return;const i=.25*e.innerHeight,c=.5*e.innerWidth;let d=parseInt(p(l,"data-swipe-threshold",i),10),h=parseInt(p(l,"data-swipe-threshold",c),10),b=parseInt(p(l,"data-swipe-timeout","500"),10),g=Date.now()-o,m="",_=t.changedTouches||t.touches||[];Math.abs(r)>Math.abs(a)?Math.abs(r)>h&&g<b&&(r>0?u("left",t)&&(m="swiped-left"):u("right",t)&&(m="swiped-right")):Math.abs(a)>d&&g<b&&(a>0?u("up",t)&&(m="swiped-up"):u("down",t)&&(m="swiped-down"));if(""!==m){let e={dir:m.replace(/swiped-/,""),touchType:(_[0]||{}).touchType||"direct",xStart:parseInt(s,10),xEnd:parseInt((_[0]||{}).clientX||-1,10),yStart:parseInt(n,10),yEnd:parseInt((_[0]||{}).clientY||-1,10)};l.dispatchEvent(new CustomEvent("swiped",{bubbles:!0,cancelable:!0,detail:e})),l.dispatchEvent(new CustomEvent(m,{bubbles:!0,cancelable:!0,detail:e}))}s=null,n=null,o=null}),!1);let s=null,n=null,r=null,a=null,o=null,l=null,c=[],d=[];function u(e,t){if(void 0===i)return!0;let s=t.target,n=!0,r=0;for(;s!==i&&n;){if(h(s))switch(e){case"up":n=c[r]===s.scrollHeight-s.clientHeight;break;case"down":n=0===c[r];break;case"left":n=d[r]===s.scrollWidth-s.clientWidth;break;case"right":n=0===d[r];break;default:n=!0}s=s.parentNode,r++}return n}function h(e){return e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth}function p(e,i,s){for(;e&&e!==t.documentElement;){let t=e.getAttribute(i);if(t)return t;e=e.parentNode}return s}};var ue=e=>{const t=document.createElement("DIV");t.classList.add("nb-overlay"),t.addEventListener("click",(()=>{S({eventName:"WEB_COMPONENT_POPIN_CLOSE",args:{id:e}})})),document.body.appendChild(t),setTimeout((()=>{t.classList.add("fadein")}),1)},he=()=>{if(!document.getElementsByClassName("nb-overlay").length)return;const e=document.getElementsByClassName("nb-overlay")[0];e.classList.remove("fadein"),setTimeout((()=>{e.remove()}),1200)};class pe extends HTMLElement{constructor(){super(),this.props={},this.ariaModal=null,this.isVideo=null,this.boundOpen=this.open.bind(this),this.boundClose=this.close.bind(this),this.boundEscapeClose=this.escapeClose.bind(this),this.boundFocus=this.focus.bind(this),this.boundFocusin=this.focusin.bind(this)}connectedCallback(){this.style.display="none",this.props=A(this.attributes),this.content||this.slot||(this.slot=this.innerHTML),this.id||null==this.props.popin_id||""==this.props.popin_id||(this.id=this.props.popin_id),this.ariaModal=!1,this.isVideo=!1,this.render()}attributeChangedCallback(e,t,i){this.props=A(this.attributes),"content"===e&&(this.props.content=i)}static get observedAttributes(){return["content"]}disconnectedCallback(){this.hasEvent&&this.unbindEvent()}render(){this.hasEvent&&this.unbindEvent();const{heading:e="",bgcolor:t="highlight",size:i="M",label_close:s="Close",image:n="",image_alt:r="",content:a=""}=this.props,o=a||this.slot;if(""===o)return this.bindEvent(),this.classList.remove("isOpen"),this.isOpen=!1,!1;this.checkIsVideo(o),this.isVideo?this.setAttribute("size","L"):this.setAttribute("size",i),this.setAttribute("role","dialog"),this.setAttribute("aria-hidden","true"),this.setAttribute("bgcolor",t),this.innerHTML=`\n            <nb-cta\n                variation="navigation"\n                ${"white"===t?'contrast="highlight"':'contrast="light"'}\n                icon_right="close-2"\n                label="${s}"></nb-cta>\n            <div class="wrapper">\n                <div class="title">\n                    ${e&&`<h2 class="h-lg-700-caps-sl">${e}</h2>`}\n                </div>\n                <div class="content" tabindex="-1">\n                    ${n&&`<div class="popin-header-img"><img loading="lazy" src="${n}" alt="${r}" title="${r}" width="300" height="225" /></div>`}\n                    ${o}\n                </div>\n                ${this.renderFooter()}\n            </div>\n            ${this.isVideo&&u.is.mobile?'<div class="swipeOverlay"></div>':""}\n        `,setTimeout((()=>{this.style.display="inherit"}),100),te(this),this.buttonElement=this.querySelector("button"),this.bindEvent()}renderFooter(){const{footer:e}=this.props;var t;return!(!(t=e)||"false"===t)?"<footer></footer>":""}checkIsVideo(e){const t=document.createElement("div");t.innerHTML=e,1===t.children.length&&"NB-VIDEO"===t.children[0].tagName&&(this.isVideo=!0,this.setAttribute("video","true"))}addLock(){document.getElementsByTagName("html")[0].classList.add("scroll-lock"),ue(this.props.popin_id)}removeLock(){this.parentNode.closest("nb-popin")||document.getElementsByTagName("html")[0].classList.remove("scroll-lock"),he()}switchAriaModal(){this.ariaModal=!this.ariaModal,this.setAttribute("aria-modal",this.ariaModal),Z(this,this.ariaModal)}async open(e){this.addEventListener("transitionend",this.boundFocus),document.addEventListener("focusin",this.boundFocusin),this.openingSource=document.activeElement;const t=O(e);t.id===this.id?(this.addLock(),this.switchAriaModal(),this.setAttribute("aria-hidden","false"),this.isOpen=!this.isOpen,await new Promise((e=>{setTimeout((()=>{this.classList.add("isOpen"),e()}),300)})),S({eventName:"WEB_COMPONENT_POPIN_OPENED",args:{id:this.props.popin_id}})):console.log("return",t.id,this.id)}close(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),this.addEventListener("transitionend",this.boundFocus),document.removeEventListener("focusin",this.boundFocusin),this.removeLock(),this.switchAriaModal(),this.setAttribute("aria-hidden","true"),this.isOpen=!this.isOpen,this.classList.remove("isOpen"),S({eventName:"WEB_COMPONENT_POPIN_CLOSED",args:{id:this.props.popin_id}})}focus(){this.removeEventListener("transitionend",this.boundFocus),this.isOpen?this.buttonElement.focus():this.openingSource.focus()}focusin(e){ee(e,this,!0)}escapeClose(e){"Escape"===e.key&&this.isOpen&&this.close(e)}swipeDown(e){this.isOpen&&this.close(e)}swipeOverlayTogglePlayPause(){S({eventName:"WEB_COMPONENT_VIDEO_TOGGLE",args:{id:this.props.popin_id}})}bindEvent(){this.hasEvent=!0,null!=this.buttonElement&&this.buttonElement.addEventListener("click",this.boundClose),window.addEventListener(t,this.boundOpen),window.addEventListener("WEB_COMPONENT_POPIN_CLOSE",this.boundClose),document.addEventListener("keydown",this.boundEscapeClose),u.is.mobile&&(de(window,document,this),this.boundSwipeDown=this.swipeDown.bind(this),document.addEventListener("swiped-down",this.boundSwipeDown),this.isVideo&&(this.swipeOverlay=this.querySelector(".swipeOverlay"),this.boundSwipeOverlayTogglePlayPause=this.swipeOverlayTogglePlayPause.bind(this),this.swipeOverlay.addEventListener("click",this.boundSwipeOverlayTogglePlayPause)))}unbindEvent(){this.hasEvent=!1,null!=this.buttonElement&&this.buttonElement.removeEventListener("click",this.boundClose),window.removeEventListener(t,this.boundOpen),window.removeEventListener("WEB_COMPONENT_POPIN_CLOSE",this.boundClose),document.removeEventListener("keydown",this.boundEscapeClose),this.boundSwipeDown&&(document.removeEventListener("swiped-down",this.boundSwipeDown),this.boundSwipeDown=null),this.boundSwipeOverlayTogglePlayPause&&(this.swipeOverlay.removeEventListener("click",this.boundSwipeOverlayTogglePlayPause),this.boundSwipeOverlayTogglePlayPause=null)}}customElements.get("nb-popin")||customElements.define("nb-popin",pe);const be={fair_trade:"https://www.nespresso.com/shared_res/agility/commons/img/icons/fairTrade.svg",is_organic:function(){let e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-eu.svg";switch(q()){case"us":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-us.svg";break;case"ca":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-ca.svg";break;case"br":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-br.svg";break;case"jp":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-jp.svg";break;case"be":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-be.png"}return e}(),only_vertuo_next:"https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-only-vertuo-next.svg",is_q_certified_arabica:"https://www.nespresso.com/shared_res/agility/commons/img/icons/q_grade_certification_arabica.svg",is_rainforest:"https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-rainforest.svg",is_sustainable:"https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-sustainability.svg",is_design_award_2021:"https://www.nespresso.com/shared_res/agility/commons/img/icons/design_award_2021.svg"};function ge(e){return e.filter((e=>function(e){return(t="cat/capsule-range-label",new RegExp(t.replace(/\//g,"\\/"))).test(e.id);var t}(e)))}class me extends HTMLElement{constructor(){super(),this.props={}}connectedCallback(){this.props=A(this.attributes),this.render()}render(){let e,t,i,s,n,r,a,o,l,c,d,u,{direction:h="row",logos:p}=this.props;this.classList.add(""+("column"===h?"direction-column":"direction-"+h));let b=[];null==p?(e=this.props?.fair_trade,t=this.props?.alt_fair_trade,i=this.props?.is_organic,s=this.props?.alt_organic,n=this.props?.only_vertuo_next,r=this.props?.alt_vertuo_next,a=this.props?.is_rainforest,o=this.props?.alt_rainforest,l=this.props?.is_sustainable,c=this.props?.alt_sustainable,d=this.props?.is_q_certified_arabica,u=this.props?.alt_q_certification_arabica):void 0===p.length?(e=p?.fair_trade,t=p?.alt_fair_trade,i=p?.is_organic,s=p?.alt_organic,n=p?.only_vertuo_next,r=p?.alt_vertuo_next,a=p?.is_rainforest,o=p?.alt_rainforest,l=p?.is_sustainable,c=p?.alt_sustainable,d=p?.is_q_certified_arabica,u=p?.alt_q_certification_arabica):p.length&&(b=[...p]),[[e,"fair_trade",t,b],[i,"is_organic",s,b],[n,"only_vertuo_next",r,b],[a,"is_rainforest",o,b],[l,"is_sustainable",c,b],[d,"is_q_certified_arabica",u,b]].map((e=>this.appendLogo.apply(this,e))),this.innerHTML=b.map((e=>`<img src="${be[e.name]}" alt="${e.alt}" loading="lazy">`)).join("")}appendLogo(e,t,i,s){e&&!this.hasLogo(s,t)&&s.push({name:t,alt:i})}hasLogo(e,t){return e.some((e=>e.name===t))}}customElements.get("nb-card-logos")||customElements.define("nb-card-logos",me);class _e extends HTMLElement{constructor(){super(),this.props={},this.labels=[]}connectedCallback(){this.props=A(this.attributes),this.render()}render(){const{labels:e=[],direction:t="column"}=this.props;if(this.classList.add(""+("row"===t?"direction-row":"direction-"+t)),0===e.length)return"";this.labels=e,this.innerHTML=`${this.renderLabels()}`}renderLabels(){return this.labels.map((e=>{const{name:t="",bgColor:i="",color:s=""}=e;return`<mark class="t-3xs-500"\n                            ${i&&s&&`style="background: ${i}; color: ${s}"`}>\n                            <span aria-hidden="true">${t}</span>\n                            <span class="sr-only">${t}</span>\n                        </mark>`})).join("")}}customElements.get("nb-card-labels")||customElements.define("nb-card-labels",_e);const fe="pnAdvancerRight",ve="pnAdvancerLeft",ye="#000000";class ke{constructor(e,t={}){return this.boundNextClick=this.onNextClick.bind(this),this.boundPrevClick=this.onPrevClick.bind(this),this.boundLinkClick=this.onLinkClick.bind(this),this.boundTouchEnd=this.onTouchEnd.bind(this),this.disableAutoScroll="true"===t.disableAutoScroll||!1,this._entriesBounds=null,new Promise((i=>{this._element=e,this._slides=[].slice.call(e.children),this._options=Object.assign({},{id:"uuid",last_known_scroll_position:0,ticking:!1,navBarTravelDirection:"",navBarTravelling:!1,navBarTravelDistance:150,scrollAmount:220},t),this.buildIHM(),i(this),setTimeout((()=>{this.setOverflowAttribute(),this.initializeIndicatorPosition()}),0)}))}get element(){return this._element}buildIHM(){this._root=this.createElement("div","pn-ProductNav"),this._container=this.createElement("div","pn-ProductNavContents"),this._pnIndicator=null,this._containerSlidesContent=null,this.hasContainer()&&(this._containerSlidesContent=this.createElement("div","pn-ProductContainer")),this.wrapItems(),this._root.appendChild(this._container),this._containerSlidesContent&&this._element.appendChild(this._containerSlidesContent),this._element.insertBefore(this._root,this._element.childNodes[2]),this.createIndicator()}hasContainer(){return!!document.querySelector(".slider-container")}wrapItems(){const e=[];this._slides.map((t=>{const i=function(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=i.length,n=0;n<e;n++)t+=i.charAt(Math.floor(Math.random()*s));return t}(5);if(this.hasContainer()&&t.classList.contains("slider-container")&&(t.children&&t.children.length&&[...t.children].forEach(((t,i)=>{0!==i&&(t.style.display="none"),t.id=e[i],this._containerSlidesContent.appendChild(t)})),t.remove()),!t.classList.contains("pn-Advancer")){const s=this.createElement("div","pn-ProductNavLinkWrapper");s.appendChild(t),s.setAttribute("data-inner-content-id",i),e.push(i),this._container.appendChild(s)}}))}createElement(e,t){let i=document.createElement(e);return i.setAttribute("class",t),i}createIndicator(){this.elements=[],this._pnIndicator=this.createElement("div","pn-ProductNavIndicator"),this._container.appendChild(this._pnIndicator),this.elements=Array.from(this._container.querySelectorAll("nb-link a")),this.elements.forEach((e=>{e.addEventListener("click",this.boundLinkClick)}));const e=document.getElementById(`${ve}-${this._options.id}`);e&&e.addEventListener("click",this.boundPrevClick);const t=document.getElementById(`${fe}-${this._options.id}`);t&&t.addEventListener("click",this.boundNextClick),this._root&&this._container.addEventListener("touchend",this.boundTouchEnd)}onLinkClick(e){this.goToElement(e.currentTarget)}goToSlide(e){this.goToElement(this._slides[e])}showContent(e){const t=document.querySelector(".pn-ProductContainer");t.children&&[...t.children].forEach((e=>e.style.display="none")),document.getElementById(e).style.display="block"}goToElement(e){if(this.hasContainer()){const t=e.closest("[data-inner-content-id]").getAttribute("data-inner-content-id");this.showContent(t)}if(this.deselectAllLinkBut(e),e.setAttribute("aria-selected","true"),!e||!this._entriesBounds)return;let t=0;for(const i of this._entriesBounds){if(i.target.getAttribute("data-href")===e.getAttribute("data-href"))break;t=t+i.boundingClientRect.width+10}this.disableAutoScroll||this._root.scroll({left:t,behavior:"smooth"})}deselectAllLinkBut(e){this.elements.map((t=>{t!==e&&t.setAttribute("aria-selected","false")}))}sideScroll(e,t,i,s,n){this.setOverflowAttribute();let r=0,a=setInterval((function(){"left"===t?e.scrollLeft-=n:e.scrollLeft+=n,r+=n,r>=s&&window.clearInterval(a)}),i);return{slideTimer:a}}onPrevClick(){this.sideScroll(this._root,"left",25,this._options.scrollAmount,10),setTimeout((()=>{this.setOverflowAttribute()}),300)}onNextClick(){this.sideScroll(this._root,"right",25,this._options.scrollAmount,10),setTimeout((()=>{this.setOverflowAttribute()}),300)}onTouchEnd(){this.setOverflowAttribute()}initializeIndicatorPosition(){const e=this._root.querySelector('[aria-selected="true"]');e&&this.moveIndicator(e,ye)}determineOverflow(e,t){let i=t.getBoundingClientRect(),s=Math.floor(i.right),n=Math.floor(i.left),r=e.getBoundingClientRect(),a=Math.floor(r.right),o=Math.floor(r.left);return n>o&&s<a?"both":o<n?"left":a>s?"right":"none"}moveIndicator(e,t){if(!this._pnIndicator)return;let i=e.getBoundingClientRect(),s=this._container.getBoundingClientRect().left,n=i.left-s;this._pnIndicator.style.transform="translateX("+(n+this._container.scrollLeft+10)+"px) scaleX("+.01*(i.width-20)+")",this._root.scrollLeft=Math.floor(n+this._container.getBoundingClientRect().left/2),t&&(this._pnIndicator.style.backgroundColor=t)}onResize(){this.setOverflowAttribute(),this.initializeIndicatorPosition()}clearListeners(){this.elements.forEach((e=>{e.removeEventListener("click",this.boundLinkClick)}));const e=document.getElementById(`${ve}-${this._options.id}`);e&&e.removeEventListener("click",this.boundPrevClick);const t=document.getElementById(`${fe}-${this._options.id}`);t&&t.removeEventListener("click",this.boundNextClick)}kill(){this.clearListeners()}setOverflowAttribute(){this._element.setAttribute("data-overflowing",this.determineOverflow(this._container,this._root)),this.observe()}observe(){if(!("IntersectionObserver"in window))return!1;this._entriesBounds=[];const e=new IntersectionObserver((t=>{for(const e of t)this._entriesBounds.push({target:e.target,intersection:e.boundingClientRect.right<=window.innerWidth-10&&e.boundingClientRect.left>=10,boundingClientRect:e.boundingClientRect});e.disconnect()}),{root:this._container});this._slides.map((t=>e.observe(t)))}isInViewport(e){if(!this._entriesBounds)return!1;return this._entriesBounds.find((t=>e===t.target)).intersection}}class we extends HTMLElement{constructor(){super(),this.slot=this.innerHTML,this.navBarTravelling=!0,this.disableAutoScroll=!1,this.navBarTravelDirection="",this.navBarTravelDistance=200,this.randomId="swiperMenu_"+function(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=i.length,n=0;n<e;n++)t+=i.charAt(Math.floor(Math.random()*s));return t}(5),this.sliderMenu=null,this.boundOnResize=this.onResize.bind(this),this.onLoad=this.onLoad.bind(this),this.debouncedOnResize=function(e,t){let i;return t=t||100,function(s){i&&clearTimeout(i),i=setTimeout(e,t,s)}}(this.boundOnResize,250)}static get observedAttributes(){return["navBarTravelling","navBarTravelDirection","navBarTravelDistance"]}render(){const e="true"===this.getAttribute("navigation")||"",t=this.getAttribute("a11y_slider_previous_button")||"",i=this.getAttribute("a11y_slider_next_button")||"";this.innerHTML=`\n            <div id="pnProductNav-${this.randomId}" class="pn-ProductNavWrapper ${this.randomId}">\n                ${e&&`<nb-cta id="pnAdvancerLeft-${this.randomId}"\n                        class="pn-Advancer pn-AdvancerLeft"\n                        variation="navigation"\n                        contrast="highlight"\n                        size="32"\n                        icon_right="chevron-left"\n                        label="${t}"></nb-cta>`}\n                ${this.slot}\n                ${e&&`<nb-cta id="pnAdvancerRight-${this.randomId}"\n                        class="pn-Advancer pn-AdvancerRight"\n                        variation="navigation"\n                        contrast="highlight"\n                        size="32"\n                        icon_right="chevron-right"\n                        label="${i}"></nb-cta>`}\n                <span id="pnIndicator-${this.randomId}"\n                    class="pn-ProductNavIndicator">\n                </span>\n            </div>\n\n            `,this.loadSwiper()}connectedCallback(){this.navBarTravelling=this.getAttribute("navBarTravelling")||this.navBarTravelling,this.navBarTravelDirection=this.getAttribute("navBarTravelDirection")||this.navBarTravelDirection,this.navBarTravelDistance=this.getAttribute("navBarTravelDistance")||this.navBarTravelDistance,this.disableAutoScroll=this.getAttribute("disable_auto_scroll")||"",this.render(),window.addEventListener("resize",this.debouncedOnResize)}loadSwiper(){let e=this.navBarTravelDirection,t=this.navBarTravelDistance;this.sliderMenu=new ke(this.querySelector("."+this.randomId),{id:this.randomId,index:this.index,navBarTravelDirection:e,navBarTravelDistance:t,disableAutoScroll:this.disableAutoScroll}),this.sliderMenu.then((()=>{this.classList.add("is-show"),S({eventName:n,args:{className:this.randomId},element:this})}))}handleClick(){var e;S({eventName:"WEB_COMPONENT_SLIDE_CHANGE"}),e={rootElement:["nb-slider-menu"]},window.gtmDataObject.push({event:"itemDisplay",eventRaisedBy:"Web component",eventAction:"Click",itemTypes:["products"],...e})}onLoad(){this.sliderMenu.then((e=>e.onLoad()))}onResize(){this.sliderMenu.then((e=>e.onResize()))}onNavigationClick(e){let t="";e.target&&e.target.closest(".link")&&e.target.closest(".link").getAttribute("tracking_label")&&(t=e.target.closest(".link").getAttribute("tracking_label")),B({eventAction:"PLP Content Tab",eventLabel:t})}disconnectedCallback(){window.removeEventListener("resize",this.debouncedOnResize),this.sliderMenu.then((e=>e.kill()))}}customElements.get("nb-slider-menu")||customElements.define("nb-slider-menu",we);var Ee=(e=[])=>{e.forEach((e=>{if(e&&e.element)return e.element.addEventListener(e.type,e.listener,e.options)}))},Ce=(e=[])=>{e.forEach((e=>{e&&e.element&&e.element.removeEventListener(e.type,e.listener)}))};const Le=(()=>{const e=({identifier:e="",callback:t,options:i})=>{if(""===e)return{};const s=document.querySelectorAll(e),n=new IntersectionObserver(t,i);for(const e of s)n.observe(e);return{observer:n,targets:s}};return{initialize:t=>{t.map(e)},destroy:()=>{}}})(),$e=[.2,.8],Se=(()=>{let e=null,t=!1;const i=e=>{s(e[0])},s=t=>{if(t.isIntersecting&&!e.isScrolling){let{sectionId:e=""}=t.target.dataset;e=""===e?t.target.getAttribute("data-id"):"",S({eventName:"EVENT_NAVIGATION_SECTION_CHANGE",args:{sectionId:e}})}};return{initialize:s=>{e=s;const n=[{identifier:"[data-id]",callback:i,options:{threshold:$e,rootMargin:"-160px 0px 0px 0px"}}],r=()=>{t||(t=!0,Le.initialize(n))};setTimeout((()=>{r()}),2e3),window.addEventListener("WEB_COMPONENT_PROJECTS_LOADED",(()=>{r()}))},destroy:()=>{}}})(),Oe=e=>{const t=e=>{const t=e.querySelectorAll("a");for(const[e,s]of t.entries())s.addEventListener("click",i(e))},i=t=>i=>{i.preventDefault();const s=i.target.closest(".is-link");s&&(S({eventName:"EVENT_NAVIGATION_SECTION_CHANGE",args:{sectionId:s.getAttribute("data-href"),index:t}}),e.scroll&&e.scroll(s,t),window.location.hash=s.getAttribute("data-href"))},s=t=>{const{sectionId:i,index:s}=O(t);e.updateBubbles&&e.updateBubbles(i),e.updateChips&&e.updateChips(i),e.updateSlider&&e.updateSlider(i,s)};return{createListeners:()=>{const{containerBubble:i,containerChip:r,sliderBubble:a,sliderChip:o}=e.refs,l=[];return i&&l.push({element:i,type:n,listener:t(a),options:{once:!0}}),r&&l.push({element:r,type:n,listener:t(o),options:{once:!0}}),l.push({element:window,type:"EVENT_NAVIGATION_SECTION_CHANGE",listener:s}),l.push({element:window,type:"EVENT_HEADER_POSITION_CHANGED",listener:e.updateLayout.bind(e)}),Ee(l),l}}};class Pe extends HTMLElement{static get observedAttributes(){return["sticky"]}constructor(){super(),this.isMobile=window.innerWidth<768,this.isScrolling=!1}connectedCallback(){this.props=A(this.attributes),this.classList.add("nb-navigation-bubbles"),this.init()}init(){this.render(),this.refs=re(this),this.geometry=this.getGeometry(),this.slidesVisibles=this.getSlidesVisible(),Se.initialize(this),this.eventsListeners=Oe(this).createListeners()}update(){this.eventListeners&&Ce(this.eventListeners),this.updateClasses(),this.render(),this.refs=re(this),this.eventsListeners=Oe(this).createListeners()}attributeChangedCallback(e,t,i){"sticky"===e&&this.props&&i!==t&&(this.props.sticky=i,this.update())}render(){let e="";e=this.isSticky()?`${this.renderNavigation(32,"Chip","white_1000")}`:`${this.renderNavigation(16,"Bubble","")}`,this.innerHTML=e,this.updateClasses()}renderNavigation(e,t,i){const{a11y_slider_previous_button:s,a11y_slider_next_button:n}=this.props,r=this.renderList(`render${t}`);return`\n            <nb-container\n                background_color="${i}"\n                class="nb-navigation-bubbles__container--${t.toLowerCase()}"\n                contrast="light"\n                data-ref="container${t}"\n            >\n                <nb-slider-menu\n                    a11y_slider_previous_button="${s}"\n                    a11y_slider_next_button="${n}"\n                    navigation="true"\n                    pagination="false"\n                    slides_loop="false"\n                    slides_visible="${this.slidesVisibles}"\n                    space_between="${e}"\n                    data-ref="slider${t}"\n                >\n                    ${r}\n                </nb-slider-menu>\n            </nb-container>\n        `}renderList(e){const{bubbles:t=[]}=this.props;return t.map((t=>this[e](t))).join("")}renderBubble(e){let{link:t}=e;if(!t)return null;const{linkNoHash:i,linkHash:s}=this._getHashLink(t);return`\n            <a href="${s}" class="is-link" data-href='${i}'>\n                <nb-bubble data='${JSON.stringify(e).replace(/"/g,"&quot;")}' data-ref="bubbles[${i}]"></nb-bubble>\n            </a>\n        `}_getHashLink(e){let t=e,i=e;return-1!==e.indexOf("#")?i=e.replace("#",""):t="#"+e,{linkNoHash:i,linkHash:t}}renderChip(e){const{link:t}=e;if(!t)return null;const{linkNoHash:i,linkHash:s}=this._getHashLink(t);return`\n            <a href="${s}" data-href='${i}' class="is-link">\n                <nb-chip\n                    background_image="${e.visual.src}"\n                    data-ref="chips[${i}]"\n                    rounded="false"\n                >\n                    ${e.label}\n                </nb-chip>\n            </a>\n        `}isSticky(){if(!this.props)return!1;const{sticky:e="false"}=this.props;return"true"===e}getMethod(e){return["add","remove"][e?0:1]}addClass(e,...t){this.classList[this.getMethod(e)](...t)}updateClasses(){const e=this.isSticky(),{padding_top:t,padding_bottom:i}=this.props;null!=i&&null!=t&&this.addClass(!e,t,i)}updateLayout(){this.geometry=this.getGeometry(),this.updatePosition()}updateBubbles(e){const{bubbles:t={}}=this.refs;for(const i in t){const s=t[i],n=i===e?"selected":"default";s.setAttribute&&s.setAttribute("state",n)}}updateChips(e){const{chips:t={}}=this.refs;for(const i in t){const s=t[i],n=i===e?"true":"false";s.setAttribute&&s.setAttribute("checked",n)}}async updateSlider(e,t){let i=t;if(this.refs.sliderChip){const s=await this.refs.sliderChip.sliderMenu;if(void 0===t){document.querySelectorAll("#pnProductNav-"+s._options.id+" .pn-ProductNavLinkWrapper").forEach(((t,s)=>{t.childNodes[0].getAttribute("data-href")===e&&(i=s)}))}i&&s&&s.goToSlide&&s.goToSlide(i)}}emit(e){S({element:this,...e})}async scroll(e,t){this.isScrolling=!0;const i=e.getAttribute("data-href"),{header:s,chips:n,navigation:r}=this.geometry,a=0===t?r.height:n.height,o={scrollPaddingTop:s.top+s.height+a};await T(`[data-id="${i}"]`,o),this.isScrolling=!1}track(e){const{customEventAction:t}=this.props;let i={eventRaisedBy:"Before",eventLabel:e};t&&(i.eventAction=t),B(i)}getGeometry(){const e=document.querySelector(".Header__top"),t=this?.getBoundingClientRect(),i=e?.getBoundingClientRect()||{height:0,y:0};return{header:{height:i.height,top:i.y},navigation:{height:t.height,top:window.scrollY+t.y},chips:{height:t.height,top:window.scrollY+t.y}}}getSlidesVisible(){const{sticky:e="false"}=this.props;return u.is.mobile?3:u.is.tablet?6:"true"===e?5:9}disconnectedCallback(){Ce(this.eventListeners)}}async function Te(){return await window.plpData}customElements.get("nb-navigation-bubbles")||customElements.define("nb-navigation-bubbles",Pe);var Ae={init:async function(e){return window.plpDataType=e,window.getPLPData=window.getPLPData||Te,this.set("sessionId",(Math.random()+1).toString(36).substring(7)),this.set("filtersSelected",[]),this.set("sortCurrent",{}),this.set("sortOptions",[]),window.getPLPData()},set:function(e,t){this[e]=t},get:function(e){return this[e]||null},initPriceFormatter:function(){return async function(){return napi.priceFormat()}()},initCurrency:function(){return async function(){return napi.market().read()}()},productsList:function(){return this.products},productsListFiltered:function(){return this.products.reduce(((e,t)=>e.concat(t.products)),[]).filter(((e,t,i)=>this.get("filtersSelected").every((t=>!!e[t.key]&&("string"==typeof e[t.key]?e[t.key]===t.value:"number"==typeof e[t.key]?JSON.parse("["+t.value+"]").includes(e[t.key]):e[t.key].includes(t.value))))&&i.findIndex((t=>t.id===e.id))===t)).sort(((e,t)=>e[this.get("sortCurrent").key]<t[this.get("sortCurrent").key]?"asc"===this.get("sortCurrent").order?-1:1:e[this.get("sortCurrent").key]>t[this.get("sortCurrent").key]?"asc"===this.get("sortCurrent").order?1:-1:0))},productsFilteredCount:function(){return this.productsListFiltered().length},filtersUpdate:function(e,t=!0){const i=e.key,s=e.value,n=e.selected,r=this.get("filters").find((e=>e.key===i));r&&(r.values.forEach((e=>{("object"==typeof e.value?e.value.join(",")===s:e.value===s)&&(e.selected=n,n?this.get("filtersSelected").push({key:i,value:s,color:e.color||null}):this.set("filtersSelected",this.get("filtersSelected").filter((e=>!(e.key===i&&e.value===s)))))})),t&&this.fire())},filtersSelectedWithLabel:function(){return this.get("filtersSelected").map((e=>({label:this.get("filters").find((t=>t.key===e.key)).values.find((t=>t.value===e.value)).label,key:e.key,value:e.value})))},filtersSelectedCount:function(){return this.get("filtersSelected").length},filtersSelectedSerialized:function(){const e=[this.get("sortCurrent"),...this.get("filtersSelected")];return c(e)},filtersReset:function(){this.set("filtersSelected",[]),this.get("filters").forEach((e=>{e.values.forEach((e=>{e.selected=!1,e.disabled=!1}))})),this.set("sortCurrent",this.get("sortOptions")[0]),this.fire()},observers:[],subscribe:function(e){this.observers.push(e)},unsubscribe:function(e){this.observers=this.observers.filter((t=>{if(t!=e)return t}))},fire:function(){this.observers.forEach((e=>{e.call()}))}};const Ne="filtersPLP",Ie="plp-sort-menu",xe="plp-sort-menu-mobile",Me="plp-filter-popin";var Be=function(){document.getElementById("productsListPLP").parentElement.setAttribute("data-loaded",Ae.sessionId)},De=function(){const e=document.getElementById("filtersPLP"),t=document.getElementById("navigationPLP"),i=document.getElementById("productsListPLP"),s=document.getElementById("productsResultsPLP");e.setAttribute("data-request",Ae.sessionId),e.setAttribute("data-filter-counter",Ae.filtersSelectedCount()),t.setAttribute("data-request",Ae.sessionId),i.setAttribute("data-request",Ae.sessionId),e.style.display="block",t.style.display="block",i.style.display="block",s.style.display="none",document.getElementById("productsResultsPLP").style.display="none"},Fe=function(){const e=document.getElementById("filtersPLP"),t=document.getElementById("navigationPLP"),i=document.getElementById("productsListPLP"),s=document.getElementById("productsResultsPLP");e.style.display="block",e.setAttribute("data-request",Ae.sessionId),e.setAttribute("data-filter-counter",Ae.filtersSelectedCount()),t.style.display="none",i.style.display="none",s.setAttribute("data-request",Ae.filtersSelectedSerialized()),s.style.display="block"},He=function(){let e=document.getElementsByClassName("plp-app")[0].querySelector(`#${Me}`);e?(e.querySelector("plp-filter-popin").setAttribute("data-refresh","true"),S({eventName:t,args:{id:Me}})):import("./plp.filter-popin-b9e94451.js").then((()=>{e=((e,t)=>{for(let i in t)e.setAttribute(i,t[i]);return e})(document.createElement("nb-popin",{is:customElements.get("Popin")}),{"data-request":Ae.sessionId,id:Me,popin_id:Me,variation:"before",bgcolor:"white",heading:Ae.translations["productlistrespblock.filter.label"],label_close:"test",content:'<plp-filter-popin class="plp-filter-popin-content"></plp-filter-popin>'}),document.getElementsByClassName("plp-app")[0].appendChild(e),S({eventName:t,args:{id:Me}})}))},qe=function(e){const t=e.detail.err||"Error";console.error(t)};const Re=(e,t)=>{const i=window.location.href.split("#");history.pushState(null,null,((e,t,i)=>{const s=new RegExp("([?&])"+t+"=.*?(&|$)","i"),n=-1!==e.indexOf("?")?"&":"?";return e.match(s)?e.replace(s,"$1"+t+"="+i+"$2"):e+n+t+"="+i})(i[0],e,encodeURIComponent(JSON.stringify(t))))},ze=e=>{const t=window.location.search,i=new URLSearchParams(t).get(e);if(!i)return null;try{return JSON.parse(decodeURIComponent(i))}catch(e){console.error("plp.actions-getUrlVariable: url parsing failed")}},je=e=>{const{isSorted:t,isFiltered:i}=e;B(t||i?{eventAction:"PLP Filter click",eventLabel:[Ve(e),We(e)].join("|")}:{eventAction:"PLP Filter click",eventLabel:"none selected"})},Ve=e=>{const{isSorted:t,sortKey:i,sortOrder:s}=e;return t?`sort:${s}|${i}`:"sort:none selected"},We=e=>{const{isFiltered:t,filtersSelected:i}=e;let s="characteristics:";if(!t)return`${s}none selected`;return`${s}${[...new Set(i.map((e=>e.key)))].join(",")}`};let Ge={};const Ue=e=>e.get("sortCurrent").key!==e.get("sortOptions")[0].key||e.get("sortCurrent").order!==e.get("sortOptions")[0].order,Ke=e=>0!==e.filtersSelectedCount();var Ye={onload:{process:function(e,t){const{plpType:i}=e.detail.value,s=Ae.init(i);Ae.set("plpType",i||null),Ae.set("innerWidth",window.innerWidth),Ae.set("innerHeight",window.innerHeight);const n=Ae.initCurrency(),r=Ae.initPriceFormatter();Promise.all([s,n,r]).then((e=>{Ge=e[0],Ae.set("currency",e[1].currency),Ae.set("priceFormatter",e[2]),t(new CustomEvent("onloadSuccess"))})).catch((e=>{console.error(e),t(new CustomEvent("onloadError",{detail:{err:e}}))}))}},onloadSuccess:{nextState:function(e){return Be(e)}},onloadError:{nextState:function(e){return qe(e)}},onMergeData:{process:function(e,t){const{filtersService:i,productService:s,dataSortService:n,pageBuilderProps:r}=e.detail.value,{categories:a,enabledTechnologies:o,translations:l,categoriesExtraData:c,nav_links:d,bubbles:u}=s(Ge,r),h=n(r);Ae.set("sortOptions",h),Ae.set("sortCurrent",h[0]),Ae.set("enabledTechnologies",o),Ae.set("products",a),Ae.set("translations",l),Ae.set("nav_links",d),Ae.set("bubbles",u);const p=i(Ae.get("products"),r,c,l,{priceFormatter:Ae.get("priceFormatter"),currency:Ae.get("currency")});Ae.set("filters",p);const b=ze("filters");if(b&&b.length>0){const e=((e,t)=>{const i=[];return t.forEach((t=>{e.forEach((e=>{e.key===t.key&&e.values.forEach((s=>{t.value===s.value&&i.push({key:e.key,value:s.value,selected:!0})}))}))})),i})(Ae.get("filters"),b);if(e.length>0){let t=!1;e.forEach(((i,s)=>{t=s===e.length-1,Ae.filtersUpdate(i,t)}))}}const g=ze("sort");if(g){const e=(m=Ae.get("sortOptions"),_=g,[...m].filter((e=>e.key===_.key&&e.order===_.order)));e.length>0&&Ae.set("sortCurrent",e[0])}var m,_;(e=>{const{campaign_id:t,campaign_name:i,campaign_creative:s=null,campaign_position:n}=e,r=window.document.getElementById("filtersPLP");if(s)W(r,{id:t,name:i,position:n,creative:s});else{const{campaign:t=null}=e;t&&W(r,t)}})(r),t(new CustomEvent("switchProductsPage"))}},switchProductsPage:{nextState:function(e){return Ue(Ae)||Ke(Ae)?Fe(e):De(e)}},onMergeDataError:{nextState:function(e){return qe(e)}},onFilter:{process:(e,t)=>{Re("filters",Ae.get("filtersSelected")),Re("sort",{key:Ae.get("sortCurrent").key,order:Ae.get("sortCurrent").order}),t(new CustomEvent("switchProductsPage")),je({isSorted:Ue(Ae),isFiltered:Ke(Ae),sortKey:Ae.get("sortCurrent").key,sortOrder:Ae.get("sortCurrent").order,filtersSelected:Ae.get("filtersSelected")})}},onSort:{process:(e,t)=>{Re("filters",Ae.get("filtersSelected")),Re("sort",{key:Ae.get("sortCurrent").key,order:Ae.get("sortCurrent").order}),t(new CustomEvent("switchProductsPage")),je({isSorted:Ue(Ae),isFiltered:Ke(Ae),sortKey:Ae.get("sortCurrent").key,sortOrder:Ae.get("sortCurrent").order,filtersSelected:Ae.get("filtersSelected")})}},onloadFilter:{process:function(e,t){t(new CustomEvent("onloadFilterSuccess",{detail:{e:e}}))}},onloadFilterSuccess:{nextState:function(e){return He(e)}},onloadFilterError:{nextState:function(e){return qe(e)}}},Qe=(e,t,i=null)=>{let s=new CustomEvent(e,{detail:{value:t,fn:i}});Je(s)};const Je=e=>{Ye[e.type].process(e,Xe)},Xe=e=>{Ye[e.type].nextState(e)};customElements.get("plp-filter-cta")||customElements.define("plp-filter-cta",class extends a{constructor(...e){super(...e),this.bubbleElement=null}static get observedAttributes(){return["data-filter-counter"]}attributeChangedCallback(e,t,i){null!=i&&i.length>0&&i!==t&&"data-filter-counter"===e&&this.updateBubbleCounter(i)}onStart(){this.template=`<nb-cta id='plp-filter' variation='plpFilter' icon_right='filter'>${this.props.cta_filter_label}</nb-cta>`}onReady(){document.getElementById("plp-filter").addEventListener("click",(()=>{Qe("onloadFilter",{})})),this.buttonElement=this.querySelector("nb-cta button"),this.bubbleElement=document.createElement("div"),this.bubbleElement.classList.add("t-2xs-700"),this.bubbleElement.classList.add("bubbleCounter"),this.bubbleElement.innerHTML="0",this.firstChild.firstChild.appendChild(this.bubbleElement)}updateBubbleCounter(e){if(!this.bubbleElement)return null;this.bubbleElement.innerHTML=e,"0"===e?this.buttonElement.classList.remove("bubbleActive"):this.buttonElement.classList.add("bubbleActive")}});function Ze(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}customElements.get("plp-filter-links")||customElements.define("plp-filter-links",class extends a{onStart(){const e=Ae.innerWidth<768;this.template=`<nb-slider-menu\n                            a11y_slider_previous_button="${this.props.a11y_slider_previous_button}"\n                            a11y_slider_next_button="${this.props.a11y_slider_next_button}"\n                            navigation="${!e}"\n                            data-ref="navLink">\n                            ${this.renderLinksList()}\n                        </nb-slider-menu>`}renderLinksList(){const{navigation:e=[]}=this.props;return e.map((({link:e="",icon_left:t="",seo_label:i="",tracking_label:s="",label:n="",selected:r=!1})=>`<nb-link\n                                link='${e}'\n                                phantom='true'\n                                color='black'\n                                selected=${r}\n                                ${i&&`seo_label='${i}'`}\n                                ${s&&`tracking_label='${s}'`}\n                                ${t&&`icon_left='${t}'`}\n                    >${n}</nb-link>`)).join("")}});var et=0;function tt(e){return"__private_"+et+++"_"+e}var it=tt("SORT_MENU_ID");customElements.get("plp-filter-sort")||customElements.define("plp-filter-sort",class extends a{constructor(){super(),Object.defineProperty(this,it,{writable:!0,value:"plp-sort-menu"}),this.formatSortSeprator="::",Ae.subscribe(this.componentUpdated.bind(this)),this.sortButton={}}onStart(){this.props=this._createProps(document.getElementById("filtersPLP").parentElement.attributes);const{label_sort_by:e="Sort By",aa_description_sort_by:t="You can select different sorting values from this listbox. To interact with this listbox press SPACE or ENTER key.",aa_listbox_description_sort_by:i="You can navigate through the options using UP or DOWN arrows keys. To exit this listbox press ESCAPE key.",aa_select_description_sort_by:s="To select this option press SPACE or ENTER key.",label_close_sort_by:n="Close"}=this.props,r=Ae.get("sortOptions").map((e=>({label:e.label,value:this._formatSortValue(e.key,e.order),checked:e.checked})));Ae.get("sortCurrent").key!==Ae.get("sortOptions")[0].key&&r.forEach((e=>{e.checked=e.value===this._formatSortValue(Ae.get("sortCurrent").key,Ae.get("sortCurrent").order)}));const a={label:e,aa_description:t,aa_listbox_description:i,aa_select_description:s,icon_option:"check",label_close:n,options:r};this.template=`<nb-dropdown id="${Ze(this,it)[it]}" data='${c(a)}'/>`}onReady(){document.getElementById(Ze(this,it)[it]).addEventListener("WEB_COMPONENT_SORT_BY_CHANGE",(e=>{const[t,i]=e.detail.selected.value.split(this.formatSortSeprator);Ae.set("sortCurrent",{key:t,order:i}),Qe("onSort")})),this.sortButton=document.getElementById(Ze(this,it)[it])}componentUpdated(){const{key:e,order:t}=Ae.get("sortCurrent");this.sortButton.setSelected(this._formatSortValue(e,t)),this.sortButton.render()}onDestroy(){Ae.unsubscribe(this.componentUpdated)}_formatSortValue(e,t){return`${e}${this.formatSortSeprator}${t}`}});customElements.get("plp-filter")||customElements.define("plp-filter",class extends a{static get observedAttributes(){return["data-request","data-filter-counter"]}attributeChangedCallback(e,t,i){null!=i&&i!==t&&i.length>0&&("data-request"===e?this.updateComponent():"data-filter-counter"===e&&document.getElementById("plp-filter-cta").setAttribute("data-filter-counter",i))}onStart(){this.props=this._createProps(this.parentElement.attributes),this.classList.add("plp-filter")}updateComponent(){const e=Ae.get("nav_links"),t=`<div class='plp-filter-restrict'>\n                        <plp-filter-cta\n                            id="plp-filter-cta"\n                            cta_filter_label="${this.props.copywriting?.cta_filter_label||this.props.cta_filter_label}"\n                            data-filter-counter="0"\n                        ></plp-filter-cta>\n                        <plp-filter-links\n                            data = '${c({navigation:e,a11y_slider_previous_button:this.props.a11y_slider_previous_button,a11y_slider_next_button:this.props.a11y_slider_next_button})}'\n                        ></plp-filter-links>\n                        <plp-filter-sort></plp-filter-sort>\n                    </div>`;this.loadTemplate(t)}});const st=(()=>{let e=null,t=0;const i=()=>{const i=e.getAttribute("sticky")||"false";let s=0,n=!1,r={};for(var a=0;a<e.parentElement.childNodes.length&&(e.parentElement.childNodes[a].tagName&&e.parentElement.childNodes[a].tagName===e.tagName&&(r=e.parentElement.childNodes[a+2],r&&(s=r.offsetTop-80,n=!0)),!n);a++);n&&0===s&&(s=e.parentElement.offsetTop+e.parentElement.offsetHeight);const o=window.scrollY-s>0;"true"===i!==o&&(e.setAttribute("sticky",o),t>0&&(document.body.style.paddingTop=o?t+"px":"0px"))},s=()=>{window.addEventListener("scroll",i)},n=()=>{window.removeEventListener("scroll",i)};return{initialize:(n,r=t)=>{e=n,t=r,e.setAttribute("sticky","false"),e.classList.add("nb-sticky-container"),i(),s()},destroy:()=>{n()},updatePosition:(t=0)=>{const i=document.querySelector(".Header__top")?.getBoundingClientRect()||{height:0,y:0},s=i.height,n=`${i.y+s+t}px`;return e.style.top=n,0}}})();var nt=e=>{const{a11y_slider_previous_button:t,a11y_slider_next_button:i}=e,s=Ae.get("nav_links"),n=(({bubbles:e,a11y_slider_previous_button:t,a11y_slider_next_button:i})=>{let s="";return e&&(s=c({a11y_slider_previous_button:t,a11y_slider_next_button:i,bubbles:e,customEventAction:"PLP Content Tab"})),s})({bubbles:Ae.get("bubbles"),...e});let r=`<nb-navigation-bubbles data='${n}'></nb-navigation-bubbles>`;const a=(e=>{let t="";return e&&(t=c({navigation:e})),t})(s);return r+=`<nb-plp-sticky-bar\n                data="${a}"\n                a11y_slider_previous_button="${t}"\n                a11y_slider_next_button="${i}"\n                navigation_bubbles="${n}"\n            ></nb-plp-sticky-bar>`,r},rt=tt("isSticky");customElements.get("plp-navigation")||customElements.define("plp-navigation",class extends a{constructor(...e){super(...e),Object.defineProperty(this,rt,{writable:!0,value:!0})}onStart(){this.props=this._createProps(this.parentElement.attributes),Ze(this,rt)[rt]&&st.initialize(this,0)}static get observedAttributes(){return["sticky","data-request"]}attributeChangedCallback(e,t,i){null!=i&&i!==t&&i.length>0&&("sticky"===e&&Ze(this,rt)[rt]&&st.updatePosition(),"data-request"===e&&this.updateComponent())}updateComponent(){const e=nt(this.props.copywriting?this.props.copywriting:this.props);this.loadTemplate(e)}onDestroy(){Ze(this,rt)[rt]&&st.destroy()}});var at=(e,t="")=>{const i={...e,rendererName:t};i.price=Ae.priceFormatter.short(Ae.currency,e.price),i.price_per_capsule&&(i.price_per_capsule=Ae.priceFormatter.short(Ae.currency,e.price_per_capsule)),i.intensity_label=Ae.translations["productlistrespblock.capsule.a11y.intensity"],i.variation=h;const s=(({type:e})=>{let t="nb-sku";return"capsule"===e?t="nb-sku-coffee":"machine"===e?t="nb-sku-machine":"accessory"===e?t="nb-sku-accessory":"giftcard"===e&&(t="nb-sku-gift-card"),t})(i);return`<${s}\n                id="${i.sku}"\n                data="${c(i)}"\n                ${i.highlighted?`highlighted="${i.highlighted}"`:""}\n           ></${s}>`};customElements.get("plp-results-chip")||customElements.define("plp-results-chip",class extends a{onStart(){const{icon_right:e,variation:t,label:i,a11y_label:s,color:n}=this.props,r=n?`<div class="chip-color" style="background:${n}"></div>`:"";this.template=`<nb-cta\n                    icon_right="${e}"\n                    variation="${t}"\n                    aria_label_before="${s}"\n             >\n                    ${r}\n                    ${i}\n             </nb-cta>`}onReady(){const{value:e,type:t,label:i}=this.props;this.addEventListener("click",(()=>{const s={key:t,value:e,selected:!1,label:i};Ae.filtersUpdate(s),this.remove(),Qe("onFilter")}))}});customElements.get("plp-results")||customElements.define("plp-results",class extends a{onStart(){this.props=this._createProps(this.parentElement.attributes),this.productListBkp=[],this.classList.add("plp-results")}static get observedAttributes(){return["data-request"]}attributeChangedCallback(e,t,i){null!=i&&i!==t&&i.length>0&&"data-request"===e&&this.updateComponent()}updateComponent(){if(this.arraysAreEqual(this.productListBkp,Ae.productsListFiltered()))return null;this.productListBkp=Ae.productsListFiltered();let e=(e=>{const{header_result_label:t="Currently shopping by",a11y_header_result_label_button:i="Reset filter",header_result_label_reset:s="Reset all",a11y_header_result_label_reset:n="Filters",header_result_label_results:r="Results",header_result_label_results_zero:a="",header_result_label_results_one:o="",a11y_header_result_label_results:l="With your filters activated, you have currently"}=e,c=Ae.productsFilteredCount();let d='<nb-container element_class="plp-results-header" contrast="light">';return Ae.filtersSelectedCount()>0&&(d+=`<p class="t-sm-400-sl cb-title">${t}</p>`,Ae.filtersSelectedWithLabel().forEach((e=>{d+=`<plp-results-chip\n                    icon_right="close-2"\n                    variation="secondary"\n                    value="${e.value}"\n                    type="${e.key}"\n                    label="${e.label}"\n                    color="${e.color||""}"\n                    a11y_label="${i}"\n             >${e.label}</plp-results-chip>`}))),d+=`<nb-link\n                  id="nb-plp-filter-results-reset-all"\n                  size="small"\n                  color="black"\n                  aria-label="${n}"\n             >\n                  ${s}\n             </nb-link>`,d+=`<p class="t-xs-700-caps-sl cb-results"><span class="sr-only">${l}</span> <span>${c}</span> ${0===Ae.filtersSelectedCount()?a:1===Ae.filtersSelectedCount()?o:r}:</p>`,d+="</nb-container>",d})(this.props);e+='<nb-container element_class="plp-grid" className="plp-grid--results-list">',Ae.productsListFiltered().forEach((t=>{e+=at(t,"results")})),e+="</nb-container>",this.loadTemplate(e,!0),document.querySelector("#nb-plp-filter-results-reset-all")?.addEventListener("click",this.resetClick)}arraysAreEqual(e,t){return e===t||e.length===t.length&&e.every(((e,i)=>e===t[i]))}onDestroy(){document.querySelector("#nb-plp-filter-results-reset-all")?.removeEventListener("click",this.resetClick)}resetClick(){Ae.filtersReset(),Qe("onFilter")}});customElements.get("plp-products")||customElements.define("plp-products",class extends a{static get observedAttributes(){return["data-request"]}attributeChangedCallback(e,t,i){null!=i&&i!==t&&i.length>0&&"data-request"===e&&this.updateComponent()}updateComponent(){const e=Ae.get("products").reduce(((e,t)=>(e+=(e=>{const{id:t=null,background_retina:i,background_desktop:s,background_mobile:n,background_tablet:r,contrast:a="dark",name:o=null,description:l,products:c=[]}=e;return`<div class='plp-category' data-id="${t}">\n                <nb-container\n                    classname="plp-category--header"\n                    contrast='${a}'\n                    background_retina='${i}'\n                    background_desktop='${s}'\n                    background_mobile='${n}'\n                    background_tablet='${r}'\n                >\n                    <header>\n                        ${o?`<h2 class="h-2xl-700-sl plp-category--title">${o}</h2>`:""}\n                        <div class="plp-category--description">\n                            ${l?`<p class="description t-md-400">${l}</p>`:""}\n                        </div>\n                    </header>\n                </nb-container>\n                <nb-container classname="plp-category--products" contrast='light'>\n                    <div class="plp-category--segment">\n                        <div class='plp-category--side'></div>\n                        <div class='plp-category--center'>\n                          <div class="plp-grid">\n                              ${c.map((t=>at(t,e))).join("")}\n                            </div>\n                        </div>\n                    </div>\n                </nb-container>\n            </div>`})(t),e)),"");this.loadTemplate(e)}});class ot extends a{constructor(){super(),this.dataTransformService=()=>[],this.dataFiltersService=()=>[],this.dataSortService=()=>[]}static get observedAttributes(){return["data-loaded"]}attributeChangedCallback(e,t,i){null!=i&&i!==t&&i.length>0&&"data-loaded"===e&&Qe("onMergeData",{filtersService:this.dataFiltersService,productService:this.dataTransformService,dataSortService:this.dataSortService,pageBuilderProps:this.props})}onStart(){Qe("onload",{plpType:this.plpType}),this.classList.add("plp-app"),this.classList.add(`plp-app-${this.plpType}`),this.props.options&&this.props.options.items_per_row&&this.props.options.items_per_row>"3"&&this.classList.add(`plp-row-${this.props.options.items_per_row}`),this.template='\n            <plp-filter id="filtersPLP" style="display: none;"></plp-filter>\n            <plp-navigation id="navigationPLP" style="display: none;"></plp-navigation>\n            <plp-products id="productsListPLP" style="display: none;"></plp-products>\n            <plp-results id="productsResultsPLP" style="display: none;"></plp-results>\n        '}}var lt=tt("id"),ct=tt("name"),dt=tt("description"),ut=tt("products"),ht=tt("capacityLabel"),pt=tt("detailsIcon"),bt=tt("icon"),gt=tt("rangeLink"),mt=tt("subCategories"),_t=tt("superCategories"),ft=tt("url"),vt=tt("createdAt"),yt=tt("updatedAt"),kt=tt("background_retina"),wt=tt("background_desktop"),Et=tt("background_mobile"),Ct=tt("background_tablet"),Lt=tt("contrast"),$t=tt("isSegment");class St extends class{constructor(e,t){Object.defineProperty(this,lt,{writable:!0,value:""}),Object.defineProperty(this,ct,{writable:!0,value:""}),Object.defineProperty(this,dt,{writable:!0,value:""}),Object.defineProperty(this,ut,{writable:!0,value:[]}),Object.defineProperty(this,ht,{writable:!0,value:null}),Object.defineProperty(this,pt,{writable:!0,value:null}),Object.defineProperty(this,bt,{writable:!0,value:null}),Object.defineProperty(this,gt,{writable:!0,value:null}),Object.defineProperty(this,mt,{writable:!0,value:[]}),Object.defineProperty(this,_t,{writable:!0,value:[]}),Object.defineProperty(this,ft,{writable:!0,value:""}),Object.defineProperty(this,vt,{writable:!0,value:new Date}),Object.defineProperty(this,yt,{writable:!0,value:new Date}),Object.defineProperty(this,kt,{writable:!0,value:"/shared_res/agility/next-components/assets/backgrounds/barista_creation_range_XL.jpg"}),Object.defineProperty(this,wt,{writable:!0,value:"/shared_res/agility/next-components/assets/backgrounds/barista_creation_range_L.jpg"}),Object.defineProperty(this,Et,{writable:!0,value:"/shared_res/agility/next-components/assets/backgrounds/barista_creation_range_S.jpg"}),Object.defineProperty(this,Ct,{writable:!0,value:""}),Object.defineProperty(this,Lt,{writable:!0,value:"dark"}),Object.defineProperty(this,$t,{writable:!0,value:!1}),Ze(this,lt)[lt]=e.id||Ze(this,lt)[lt],Ze(this,ct)[ct]=e.name||Ze(this,ct)[ct],Ze(this,ht)[ht]=e.capacityLabel||Ze(this,ht)[ht],Ze(this,dt)[dt]=e.description||Ze(this,dt)[dt],Ze(this,pt)[pt]=e.detailsIcon||Ze(this,pt)[pt],Ze(this,bt)[bt]=e.icon||Ze(this,bt)[bt],Ze(this,gt)[gt]=e.rangeLink||Ze(this,gt)[gt],Ze(this,mt)[mt]=e.subCategories||Ze(this,mt)[mt],Ze(this,_t)[_t]=e.superCategories||Ze(this,_t)[_t],Ze(this,ft)[ft]=e.url||Ze(this,ft)[ft],Ze(this,wt)[wt]=t?.background_desktop||Ze(this,wt)[wt],Ze(this,Et)[Et]=t?.background_mobile||Ze(this,Et)[Et],Ze(this,kt)[kt]=t?.background_retina||Ze(this,kt)[kt],Ze(this,Ct)[Ct]=t?.background_tablet||Ze(this,Ct)[Ct],Ze(this,Lt)[Lt]=t?.contrast||Ze(this,Lt)[Lt]}get id(){return Ze(this,lt)[lt]}get products(){return Ze(this,ut)[ut]}set products(e){Ze(this,ut)[ut]=e}get name(){return Ze(this,ct)[ct]}get description(){return Ze(this,dt)[dt]}get contrast(){return Ze(this,Lt)[Lt]}get background_desktop(){return Ze(this,wt)[wt]}get background_mobile(){return Ze(this,Et)[Et]}get background_retina(){return Ze(this,kt)[kt]}get background_tablet(){return Ze(this,Ct)[Ct]}isProductCategory(){return!Ze(this,$t)[$t]&&Ze(this,ut)[ut]&&Ze(this,ut)[ut].length>0}}{constructor(e,t){super(e,t)}}class Ot extends class{constructor(e){if(this.id="",this.name="",this.available=!0,this.cupSizes=[],this.description=null,this.flavors=[],this.headline="",this.hidePrice=!1,this.image_alt_text="",this.image="",this.inStock=!0,this.internationalId="",this.internationalName="",this.legacyId="",this.maxOrderQuantity=null,this.packagingType=null,this.price=null,this.pushRatingEnabled=!1,this.ranges=[],this.salesMultiple=null,this.technologies=[],this.type="",this.unitQuantity=50,this.url="",this.labels=[],this.category_name="",this.id=e.id||this.id,this.name=e.name||this.name,this.available=e.available||this.available,this.cupSizes=e.cupSizes||this.cupSizes,this.description=e.description||this.description,this.flavors=e.flavors||this.flavors,this.headline=e.headline||this.headline,this.hidePrice=e.hidePrice||this.hidePrice,this.image_alt_text=e?.image?.altText||this.image_alt_text,this.image=e?.image?.url||this.image,this.inStock=e.inStock||this.inStock,this.internationalId=e.internationalId||this.internationalId,this.internationalName=e.internationalName||this.internationalName,this.legacyId=e.legacyId||this.legacyId,this.maxOrderQuantity=e.maxOrderQuantity||this.maxOrderQuantity,this.packagingType=e.packagingType||this.packagingType,this.price=e.price||this.price,this.pushRatingEnabled=e.pushRatingEnabled||this.pushRatingEnabled,this.ranges=e.ranges||this.ranges,this.salesMultiple=e.salesMultiple||this.salesMultiple,this.technologies=e.technologies||this.technologies,this.type=e.type||this.type,this.unitQuantity=e.unitQuantity||this.unitQuantity,this.url=e.url||this.url,null!=e.labels)try{this.labels=e.labels.map((e=>JSON.parse(e)))}catch(e){console.error("Wrong JSON format in HMC label categories capsule-range-label",e)}const t=e.categoryId?e.categoryId.split("/"):[""];this.category_name=t[t.length-1]}}{constructor(e){super(e),this.colorFilter=[],this.price=null,this.strikethrough_price="",this.additional_message="",this.additional_message_icon="",this.additional_message_link={},this.energy_level="",this.a11y_energy_label="",this.show_ratings=!1,this.minimum_rating=3,this.price=e.price,this.colorFilter=[],e.colors&&(this.activeSku=e.legacyId,this.colors=e.colors,this.colorFilter=e.colors.map((e=>e.colorCategoryId))),this.strikethrough_price=e.strikethrough_price||this.strikethrough_price,this.additional_message=e.additional_message||this.additional_message,this.additional_message_icon=e.additional_message_icon||this.additional_message_icon,this.additional_message_link=e.additional_message_link||this.additional_message_link,this.energy_level=e.energy_level,this.a11y_energy_label=e.a11y_energy_label,void 0!==e.show_ratings&&(this.show_ratings=e.show_ratings),void 0!==e.minimum_rating&&(this.minimum_rating=e.minimum_rating)}}var Pt=(e,t,i,s,n=null,r=[])=>{if(!e.data)return[];let a=r;const{categories:o,productGroups:l,enabledTechnologies:c}=e.data.configuration.eCommerceData;r&&r.length||(a=e.data.configuration.eCommerceData.products);const{translations:d}=e.data.configuration;(({categories:e,productGroups:t,products:i})=>{const s=ge(e),n=t.filter((e=>s.some((t=>t.id===e.categoryId))));n.forEach((e=>{const t=s.find((t=>t.id===e.categoryId));e.productIds.forEach((e=>{const s=i.find((t=>t.id===e));s.labels=s.labels||[],s.labels.push(t.description)}))})),n.forEach((e=>{const i=t.findIndex((t=>t.categoryId===e.categoryId));t.splice(i,1)}))})({categories:o,productGroups:l,products:a});const u=[];t.categories=t.copywriting?t.copywriting.categories:t.categories,o.forEach((e=>{const n=t.categories.find((t=>t.category_id===e.id)),r=new i(e,n);l.forEach((i=>{i.categoryId===e.id&&i.productIds.forEach((i=>{const n=a.find((e=>e.id===i));if(!n)return;n.categoryId=e.id;const o=new s(n,t);r.products.push(o)}))})),r.isProductCategory()&&u.push(r)}));const h=t.copywriting?t.copywriting.nav_links:t.nav_links,p=t.copywriting?t.copywriting.navigation_bubbles.bubbles:t.navigation_bubbles.bubbles,b=((e,t)=>{const i="gran-lungo-vertuo-capsule",s="brand_coffee_capsule_pro",n=e=>e.map((({id:e,url:t,name:i,isSelected:s})=>({link:t,label:i,seo_label:i,icon_left:r(e.split("/").pop()),selected:s}))),r=e=>{switch(e){case"vertuo":return i;case"pro":return s;default:return"original"}};if(!e.length&&t.length)return n(t);if(!t.length)return e;const a=[...e].filter((e=>{if("coffee"!==e.icon_left&&e.icon_left!==i&&e.icon_left!==s)return e}));return[...n(t),...a]})(h,c);let g;return g=n?n(t):((e,t,i)=>{const s=t.map((e=>e.categoryId)),n=[],r=e.map((e=>{const t={...e,link:e.link.replace("#","")};if(s.includes(t.link))return t})).filter((e=>void 0!==e));return s.forEach((e=>{const t=r.find((({link:t})=>t===e));if(t)n.push(t);else{const t=i.find((t=>t.id===e));if(t){const{name:e,id:i,icon:s}=t,r={link:i,tracking_label:e,label:e,visual:{src:s?.url||"",alt:s?.altText||e}};n.push(r)}}})),n})(p,l,o),{categories:u,translations:d,enabledTechnologies:c,categoriesExtraData:o,nav_links:b,bubbles:g}};const Tt=e=>e.copywriting.categories.map((t=>{const i=e.copywriting.navigation_bubbles.bubbles.find((e=>e.link===t.category_id));return{link:t.category_id,tracking_label:i?.tracking_label||t.name,label:t.name,visual:i?.visual||{}}}));function At(e,t,i,s){let n,r;const a=i.copywriting.categories.find((e=>e.category_id.indexOf(s)>-1));return a&&(n=a.category_id,r={categoryId:n,productIds:[]},e.push({id:a.category_id,name:a.name,description:a.description,icon:null,detailsIcon:null,url:null,capacityLabel:null,rangeLink:null,subCategories:[],superCategories:[]}),t.push(r)),{id:n,productGroup:r}}const Nt=(e,t)=>e.options?e.options[t]:e[t];var It=(e,t)=>{!function(e,t){const{categories:i,productGroups:s}=e.data.configuration.eCommerceData;if(!i||!s)return;const{id:n,productGroup:r}=At(i,s,t,"machine-range-black-coffee"),{id:a,productGroup:o}=At(i,s,t,"machine-range-milk");i.forEach((e=>{if(n&&e.subCategories.indexOf(n)>-1){const t=s.find((t=>t.categoryId===e.id));t&&(r.productIds=r.productIds.concat(t.productIds),t.productIds=[])}if(a&&e.subCategories.indexOf(a)>-1){const t=s.find((t=>t.categoryId===e.id));t&&(o.productIds=o.productIds.concat(t.productIds),t.productIds=[])}}))}(e,t);const{colorFilters:i,products:s,categories:n}=e.data.configuration.eCommerceData;i.forEach((e=>{n.find((t=>t.id===e.id)).cssColorCode=e.cssColorCode})),s.forEach((e=>{const i=t.products&&t.products.find((t=>t.sku&&t.sku===e.legacyId));e.show_ratings=Nt(t,"show_ratings"),e.minimum_rating=Nt(t,"minimum_rating"),i&&(e.strikethrough_price=i.strikethrough_price,e.highlighted=i.highlighted,e.additional_message=i.additional_message,e.additional_message_icon=i.additional_message_icon,e.additional_message_link=i.additional_message_link||{},e.energy_level=i.energy_level,e.a11y_energy_label=t.options.a11y_energy_label,i.api_override&&(e.name=i.api_override.name||e.name,e.headline=i.api_override.headline||e.headline,e.description=i.api_override.description||e.description));const n=s.filter((t=>t.ranges.some((t=>e.ranges.includes(t)))));n&&n.length&&(e.colors=n.map((e=>({colorCategoryId:e.colorCategories?e.colorCategories[0]:"",sku:e.legacyId,name:e.colorShade?.name,code:e.colorShade?.cssColorCode}))))}));const r=[];let a=null;const o=s.filter((e=>{a=e?.ranges[0];const t=!r.includes(a);return r.push(a),t}));return Pt(e,t,St,Ot,Tt,o)},xt=tt("type"),Mt=tt("key"),Bt=tt("iconFn"),Dt=tt("filterFn"),Ft=tt("title"),Ht=tt("values"),qt=tt("after"),Rt=tt("before");class zt{constructor(e){Object.defineProperty(this,xt,{writable:!0,value:""}),Object.defineProperty(this,Mt,{writable:!0,value:""}),Object.defineProperty(this,Bt,{writable:!0,value:{}}),Object.defineProperty(this,Dt,{writable:!0,value:{}}),Object.defineProperty(this,Ft,{writable:!0,value:""}),Object.defineProperty(this,Ht,{writable:!0,value:[]}),Object.defineProperty(this,qt,{writable:!0,value:"</fieldset/>"}),Object.defineProperty(this,Rt,{writable:!0,value:`<fieldset><legend class='${u.is.mobile?"t-sm-700-sl":"t-md-700-sl"}'>{title}</legend>`}),Ze(this,xt)[xt]=e.type,Ze(this,Mt)[Mt]=e.key,Ze(this,Bt)[Bt]=e.iconFn?e.iconFn:null,Ze(this,Dt)[Dt]=e.filterFn?e.filterFn:null;const t=e.title?e.title.toLowerCase():"Filter";Ze(this,Ft)[Ft]=t.charAt(0).toUpperCase()+t.slice(1),Ze(this,Rt)[Rt]=e.before?e.before:Ze(this,Rt)[Rt],Ze(this,qt)[qt]=e.after?e.after:Ze(this,qt)[qt]}set values(e){Ze(this,Ht)[Ht]=e}set after(e){Ze(this,qt)[qt]=e}get after(){return Ze(this,qt)[qt]}get values(){return Ze(this,Ht)[Ht]}get type(){return Ze(this,xt)[xt]}get filterFn(){return Ze(this,Dt)[Dt]}get iconFn(){return Ze(this,Bt)[Bt]}get key(){return Ze(this,Mt)[Mt]}renderBefore(){return Ze(this,Rt)[Rt].replace("{title}",Ze(this,Ft)[Ft])}renderAfter(){return Ze(this,qt)[qt]}pushValues(e){-1===(()=>Ze(this,Ht)[Ht].findIndex((t=>t.value===e.value)))()&&Ze(this,Ht)[Ht].push(e)}}var jt=tt("value"),Vt=tt("label"),Wt=tt("filterType"),Gt=tt("filterKey"),Ut=tt("icon"),Kt=tt("color"),Yt=tt("selected"),Qt=tt("disabled");class Jt{constructor({value:e,label:t,filterType:i,filterKey:s,icon:n="",color:r="",selected:a=!1,disabled:o=!1}){Object.defineProperty(this,jt,{writable:!0,value:null}),Object.defineProperty(this,Vt,{writable:!0,value:null}),Object.defineProperty(this,Wt,{writable:!0,value:null}),Object.defineProperty(this,Gt,{writable:!0,value:null}),Object.defineProperty(this,Ut,{writable:!0,value:""}),Object.defineProperty(this,Kt,{writable:!0,value:""}),Object.defineProperty(this,Yt,{writable:!0,value:!1}),Object.defineProperty(this,Qt,{writable:!0,value:!1}),e?t?i?s?(Ze(this,jt)[jt]=e,Ze(this,Vt)[Vt]=t,Ze(this,Wt)[Wt]=i,Ze(this,Gt)[Gt]=s,Ze(this,Ut)[Ut]=n,Ze(this,Kt)[Kt]=r,Ze(this,Yt)[Yt]=a,Ze(this,Qt)[Qt]=o):console.error("DefaultFilterChipType: filterKey is required"):console.error("DefaultFilterChipType: filterType is required"):console.error("DefaultFilterChipType: label is required"):console.error("DefaultFilterChipType: value is required")}set disabled(e){Ze(this,Qt)[Qt]=!!e}set selected(e){Ze(this,Yt)[Yt]=!!e}get filterType(){return Ze(this,Wt)[Wt]}get value(){return"object"==typeof Ze(this,jt)[jt]?Ze(this,jt)[jt].join(","):Ze(this,jt)[jt]}get label(){return Ze(this,Vt)[Vt]}get color(){return Ze(this,Kt)[Kt]}render(){return`<nb-chip\n                  data-filter-value="${Ze(this,jt)[jt]}"\n                  data-filter-key="${Ze(this,Gt)[Gt]}"\n                  data-filter-label="${Ze(this,Vt)[Vt]}"\n                  checked="${Ze(this,Yt)[Yt]}"\n                  disabled="${Ze(this,Qt)[Qt]}"\n                  ${Ze(this,Ut)[Ut]?`icon="${Ze(this,Ut)[Ut]}"`:""}\n                  ${Ze(this,Kt)[Kt]?`color="${Ze(this,Kt)[Kt]}"`:""}\n                >${Ze(this,Vt)[Vt]}</nb-chip>`}}var Xt=(e,t,i)=>{if(!t)return console.error("createFilter.js No categories found in the data"),[];if(!e)return console.error("createFilter.js No Filter definition found in the variables"),[];const s=[];e.forEach((e=>{s.push(new zt(e))}));return t.reduce(((e,t)=>e.concat(t.products)),[]).map((e=>{s.forEach((t=>{"object"==typeof e[t.key]?e[t.key].map((e=>{const s=((e,t)=>{const i=e.find((e=>e.id===t));return i?{label:i.name,color:i.cssColorCode?i.cssColorCode:null,icon:i.icon?.icon}:null})(i,e);s&&t.pushValues(new Jt({value:e,label:s.label,filterType:t.type,filterKey:t.key,icon:t.iconFn&&t.iconFn(e),color:s.color?s.color:null}))})):t.pushValues(new Jt({value:e[t.key],label:"function"==typeof t.filterFn?t.filterFn(e[t.key]):e[t.key],filterType:t.type,filterKey:t.key,icon:t.iconFn&&t.iconFn(t.key)}))}))})),s};const Zt=(e,t,i,s)=>{if(!e)return console.error("plp-machine.filterPrice.dto.js categories is not defined"),[];const n=e.map((e=>e.products.map((e=>e.price)))).flat().sort(((e,t)=>parseFloat(e)-parseFloat(t))).filter(((e,t,i)=>i.indexOf(e)===t));if(n.length<3)return console.error("plp-machine.filterPrice.dto.js not enough unique prices for filter"),[];const r=Math.round(.33*n.length)-1,a=Math.round(.66*n.length)-1,o=new zt({type:"default",key:"priceFilter",title:i["productlistrespblock.filterlabels.price"]}),l=[{min:n.at(0),max:n.at(r),label:t.copywriting.filter_group_price_low||"Low {range}",value:"low-price"},{min:n.at(r+1),max:n.at(a),label:t.copywriting.filter_group_price_medium||"Mid {range}",value:"mid-price"},{min:n.at(a+1),max:n.at(-1),label:t.copywriting.filter_group_price_high||"Hign {range}",value:"high-price"}];return l.forEach((e=>{o.pushValues(new Jt({value:[e.value],label:e.label.replace("{range}",` ${s.priceFormatter.short(s.currency,e.min)} - ${s.priceFormatter.short(s.currency,e.max)}`),filterType:o.type,filterKey:o.key}))})),e.forEach((e=>{e.products.forEach((e=>{e.priceFilter=l.reduce(((t,i)=>(e.price>=i.min&&e.price<=i.max&&t.push(i.value),t)),[])}))})),[o]},ei=(e,t,i,s,n)=>[...Xt([{type:"default",key:"colorFilter",title:s["productlistrespblock.filterlabels.color"]||"Color"}],e,i),...Zt(e,t,s,n)],ti=e=>[{id:"default",label:e.copywriting.dropdown_recommended_option_label,key:"recommended",order:"asc",checked:!0},{id:"sortPriceAscending",label:e.copywriting.dropdown_price_ascending_option_label,key:"price",order:"asc",checked:!1},{id:"sortPriceDescending",label:e.copywriting.dropdown_price_descending_option_label,key:"price",order:"desc",checked:!1}];class ii extends ot{constructor(){super(),this.plpType="machine",this.dataTransformService=It,this.dataFiltersService=ei,this.dataSortService=ti}}customElements.get("nb-plp-machine")||customElements.define("nb-plp-machine",ii);export{e as B,r as E,Ne as F,a as N,Me as P,xe as S,Ze as _,Ie as a,Ae as b,tt as c,i as d,s as e,ii as f,Qe as h};
