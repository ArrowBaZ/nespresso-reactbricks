const e=e=>{const i=(e=>e.find((e=>"data"===e.nodeName)))([...e]),s=[...e].filter((e=>"data"!==e.nodeName)).reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{});if(t(i))return s;try{return{...s,...JSON.parse(i.nodeValue)}}catch(e){console.log("ERROR: No data",e)}},t=e=>null==e;function i(e,t,i,s,n){const a=(t,i)=>{e.setAttribute(t,i);const a=()=>e.classList.add("lazy-loaded");if(s){const t=new Image;return t.src=s,t.onload=a,void(t.onerror=()=>{n&&n(`Image ${s} cannot be loaded.`),e.classList.add("lazy-loaded-error")})}a()};if(/Trident\/|MSIE/.test(window.navigator.userAgent)||(r=window.navigator.userAgent,o=r.indexOf("OS "),(r.indexOf("iPhone")>-1||r.indexOf("iPad")>-1)&&o>-1&&window.Number(r.substr(o+3,3).replace("_","."))<14))a(t,i);else if("IntersectionObserver"in window){e.classList.add("lazy-load");let s=new IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting&&(a(t,i),s.unobserve(e.target))}))}));s.observe(e)}else a(t,i);var r,o}function s(e,t,i,s){let n=0;for(;e;){const a=e.indexOf(i,n);if(-1===a)break;const r=e.indexOf(s,a+1);if(-1===r)break;const o=e.substring(a+i.length,r);null!=t[o]?(e=e.substr(0,a)+t[o]+e.substr(r+s.length),n=a):n=r}return e}const n=e=>a(JSON.stringify(e)),a=e=>e?e.toString().replace(/"/g,"&quot;").replace(/'/g,"&apos;"):"",r=(e,t)=>{for(let i in t)e.setAttribute(i,t[i])};function o(e){return e.sales_multiple=e.sales_multiple||e.salesMultiple,!(e.sales_multiple>1&&1===e.unitQuantity)&&(1===e.sales_multiple&&e.unitQuantity>1)}const l=async e=>{const t=await(async()=>await window.napi.priceFormat())(),i=window[window.config.padl.namespace].dataLayer.app.app.currency;return t.html?t.html(i,e):t.short(i,e)||""};class c extends HTMLElement{constructor(){super(),this.template=""}connectedCallback(){this.props=this._createProps(),this.onStart?.(),this.loadTemplate(),this.onReady?.()}_createProps(e=null){const t=e||this.attributes;let i;try{i=[...t].reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{});const e=[...t].find((e=>"data"===e.nodeName));return null==e?i:{...i,...JSON.parse(e.nodeValue)}}catch(e){console.log("ERROR: No data",e)}}render(e=!1){e&&(this.innerHTML="");const t=(e,i)=>{const s=e=>3===e.nodeType?"text":8===e.nodeType?"comment":e.tagName.toLowerCase(),n=e=>e.childNodes&&e.childNodes.length>0?null:e.textContent;var a=Array.prototype.slice.call(i.childNodes),r=Array.prototype.slice.call(e.childNodes),o=a.length-r.length;if(o>0)for(;o>0;o--)a[a.length-o].parentNode.removeChild(a[a.length-o]);r.forEach((function(e,r){if(a[r])if(s(e)===s(a[r])){var o=n(e);if(o&&o!==n(a[r])&&(a[r].textContent=o),a[r].childNodes.length>0&&e.childNodes.length<1)a[r].innerHTML="";else{if(a[r].childNodes.length<1&&e.childNodes.length>0){var l=document.createDocumentFragment();return t(e,l),void a[r].appendChild(l)}e.childNodes.length>0&&t(e,a[r])}}else a[r].parentNode.replaceChild(e.cloneNode(!0),a[r]);else i.appendChild(e.cloneNode(!0))}))},i=(s=this.template,(new DOMParser).parseFromString(s,"text/html").body);var s;t(i,this)}loadTemplate(e="",t=!1){this.template=""===e?this.template:`${e}`,this.render(t)}disconnectedCallback(){this.onDestroy?.()}}customElements.get("nb-nespresso-element")||customElements.define("nb-nespresso-element",c);const d={get is(){const{innerWidth:e,devicePixelRatio:t}=window;return{mobile:e<768,mobile_tablet:e<1024,tablet:e>=768&&e<1024,desktop:e>=1024&&t<=1,retina:e>=1024&&t>1}},lt:e=>window.innerWidth<e},u={getResponsiveSrc:e=>{const t=(i=e,Array.isArray(i)||"object"==typeof i?["mobile","tablet","desktop","retina"].find((e=>!0===d.is[e]&&e in i&&""!==i[e])):null);var i;return t?e[t]:e.desktop}},p=["upvote","19-bar","24-7-service","360-view","accessories-and-sweets","address-2","address","amex-card","android","apple-pay-card","apple-pay","apple","arrow-bottom","arrow-filled-down","arrow-left","arrow-right","arrow-top","assistance-alt","assistance-videos","assistance","boutique","brand_coffee_capsule-vl-carafe","brand_coffee_capsule-vl-double-espresso-gran-lungo","brand_coffee_capsule-vl-espresso","brand_coffee_capsule-vl-mug","brand_coffee_capsule_ol","brand_coffee_capsule_pro","brand_coffee_capsule_vl","brand_coffee_cereals","brand_coffee_citrus","brand_coffee_cocoa","brand_coffee_coffee-assortment","brand_coffee_coffee-discovery-set","brand_coffee_machines","brand_coffee_malted","brand_coffee_notes-herbal","brand_delivery_boutique-location","brand_delivery_delivery","brand_delivery_free_delivery","brand_delivery_package","brand_delivery_schedule_delivery","brand_general_coffee","brand_machines_auto_clean_system","brand_machines_automatic_off","brand_machines_digital_display","brand_machines_energy_class","brand_machines_fast_heat_up","brand_machines_low_water_alert","brand_machines_milk_frothing","brand_machines_pump_pressure_bar","brand_payment_credit_card","brand_payment_gift_card","brand_payment_invoice","brand_payment_secure","brand_services_assistance","brand_services_boutique","brand_services_easy_order","brand_services_help","brand_services_promotions","brand_services_recycling","brand_services_recycling_ol","brand_services_recycling_vl","brand_services_subscription","brand_services_sustainability","calendar","capsule-cupSize-Cappuccino-And-Latte-Macchiato","capsule-cupSize-Cortado-Cappuccino","capsule-cupSize-icedRecipe-vertuo","capsule-cupSize-icedRecipe","capsule-cupSize-alto","capsule-cupSize-carafe-vertuo","capsule-cupSize-coffee","capsule-cupSize-double-espresso-vertuo","capsule-cupSize-espresso-vertuo","capsule-cupSize-espresso","capsule-cupSize-gran-lungo","capsule-cupSize-lungo","capsule-cupSize-mug","capsule-cupSize-ristretto","capsule-cupSize-americano","capsule-cupSize-large-americano","check","chevron-down","chevron-left","chevron-right","chevron-up","check-mark","clock","close-2","close","coffee","coffee_capsule-ol_24","credit-card-flag","credit-card","delivery-fast","delivery-scheduled","delivery-standard","eco-mode","edit","error","espresso-vertuo-capsule","eye-closed","eye-opened","facebook","filter","find-us-alt","find-us","free-return","gift-card","globe","gran-lungo-vertuo-capsule","help","hero-chat","huawei","information-24","information","instagram","invoice","language","linkedin","link","live-chat","loading-nitro","loading","loan","logout","machine_machines_ol_24","machines-2","machines","mail","mastercard-card","mastercard","menu","minus-16","minus-24","minus-o","modal-alert","modal-check","more-info","nespresso-logo","nespresso-monogram","nespresso-professional-2","nespresso-professional","nespresso","notification","orders","original","package-box","payment-bcorp","payment-bvr","payment-google-pay","payment-ideal","payment-klarna","payment-lsv","payment-postfinance","payment-twint","paypal-card","paypal","phone","pin","pinterest","play-button","play-mini","play","plus-16","plus-24","plus-o","promotions","recycling-point","recycling","remove","search","secure","set-up","shopping-bag","signal-high","signal-low","signal-med","speed","star","rating","subscription-2","subscription","sustainability","tag","twitter","ui_payment_cash","ui_coffee_bergamot","ui_coffee_capsule-ol","ui_coffee_capsule-vl-carafe","ui_coffee_capsule-vl-double-espresso_gran-lungo","ui_coffee_capsule-vl-espresso","ui_coffee_capsule-vl-mug","ui_coffee_capsule-vl","ui_coffee_capsule_professional","ui_coffee_cardamom","ui_coffee_cocoa","ui_coffee_hazelnut","ui_coffee_honey","ui_coffee_notes-cereal","ui_coffee_notes-malted","ui_coffee_winey","ui_delivery_calendar","ui_delivery_clock","ui_general_alerts","ui_general_arrow-right","ui_general_check","ui_general_chevron-bottom","ui_general_chevron-left","ui_general_chevron-right","ui_general_chevron-top","ui_general_credit-card","ui_general_edit","ui_general_error","ui_general_eye-close","ui_general_eye-open","ui_general_faq","ui_general_filter","ui_general_gift-card","ui_general_globe","ui_general_information","ui_general_language","ui_general_link","ui_general_loading","ui_general_log-out","ui_general_map_view","ui_general_menu","ui_general_minus","ui_general_notification","ui_general_order","ui_general_play","ui_general_plus","ui_general_promotions","ui_general_remove","ui_general_search","ui_general_secure","ui_general_shopping-bag","ui_general_tag","ui_general_user-account","ui_general_warranty","ui_general_wifi","ui_general_x","ui_map_directions","ui_payment_invoice","ui_services_assistance","ui_services_delivery","ui_services_easy_order","ui_services_find-us","ui_services_free-return","ui_services_mail","ui_services_phone","ui_services_subscription","ui_sustainability_climate","ui_sustainability_recycling","ui_sustainability_recycling_ol","ui_sustainability_recycling_vl","ui_sustainability_social_sustainability","ui_user_member_status","ui_user_my-address","ui_user_my_information","ultra-compact","user-account","versatil-coffee-system","video-play","vertuo","visa-card","visa","warranty","youtube","services-anticipation-of-maintenance","services-assistance","services-avant-premiere","services-avant-premiere-ol","services-avant-premiere-vl","services-coffee-assortment","services-coffee-coffee-sample","services-coffee-discovery-set","services-coffee-experiences","services-contact-chat","services-contact-community-forum","services-contact-mobile","services-contact-sms","services-contact-video-assistance","services-contact-virtual","services-data-insight","services-delivery-boutique-location","services-delivery-boutique-pick-up","services-delivery-delivery","services-delivery-delivery-bike","services-delivery-delivery-fast","services-delivery-free-delivery","services-delivery-next-day-delivery","services-delivery-package","services-delivery-pick-up-points","services-delivery-schedule-delivery","services-easy-maintenance","services-easy-order","services-easy-stock-management","services-generic","services-gifting-card","services-help","services-orders","services-payments-credit-card","services-payments-gift-card","services-payments-invoice","services-phone","services-reorder","services-satisfied-or-reimbursed","services-services-boutique","services-subscription","services-vip-masterclass","services-voice-enabled","payments-cash","delivery-same-day-delivery","contact-voice-assistant-chatbot","contact-video-chat","contact-mobile-push-notification","contact-chat-bot","coffee-coffee-tasting","contact-video-assistance","filter-style_step-01","filter-style_step-02","filter-style_step-03","filter-style_step-04"].concat(["notes-almonds","notes-balanced","notes-bergamot","notes-berry","notes-biscuity","notes-blueberry","notes-cardamom","notes-cereal","notes-citrus","notes-cocoa","notes-default","notes-flowery","notes-fruity","notes-hazelnut","notes-herbal","notes-honey","notes-leather","notes-malted","notes-roasted","notes-spicy","notes-sugar","notes-winey","notes-wood","notes-brand-coffee-roasted","notes-brand-coffee-caramel","notes-brand-coffee-intense-roasted"]).concat(["machine_technology_machine-ol","machine_technology_machine-vl","machine_details_deluxe-version","machine_details_machine-tutorial-ol","machine_details_machine-tutorial-vl","machine_warranty_warranty-ol","machine_warranty_warranty-vl","machine_features_generic","machine_features_auto-clean-system","machine_features_automatic-off","machine_features_blend-specific-brewing","machine_features_bluetooth","machine_features_capsule-ejection-ol","machine_features_capsule-ejection-vl","machine_features_centrifusion","machine_features_cold-foam-ol","machine_features_cold-foam-vl","machine_features_descale-alert","machine_features_descale","machine_features_digital-display","machine_features_dimensions","machine_features_eco-mode","machine_features_energy-class","machine_features_fast-heat-up","machine_features_hot-foam-ol","machine_features_hot-foam-vl","machine_features_hot-milk","machine_features_hot-foam","machine_features_hot-water","machine_features_low-water-alert","machine_features_manual-lever","machine_features_milk-frothing","machine_features_mobile-push-notification","machine_features_one-touch","machine_features_power-off","machine_features_pump-pressure-bar","machine_features_rinse","machine_features_settings","machine_features_steam","machine_features_temperature-settings-invert","machine_features_temperature-settings","machine_features_temperature","machine_features_ultra-compact","machine_features_water-tank","machine_features_weight"]),_=({key:e="icon",type:t="string",title:i="Icon",list:s=["",...p],description:n="Add icon",default:a=""}={})=>{const r={};return r[e]={type:t,title:i,enum:s,description:n,default:a},r};_({key:"icon_left",title:"Left icon",default:""}),_({key:"icon_right",title:"Right icon",default:""});class h extends HTMLElement{constructor(){super(),this.props={}}connectedCallback(){this.props=e(this.attributes),this.render(),this.initLazyLoad(),this.trackDetailView()}render(){const{layout:e,copywriting:t,options:i}=this.props,{sales_multiple:s,unit_quantity:n,technologies:a}=i,r={salesMultiple:s,unitQuantity:n,technologies:a},l=function(e){function t(e,t){return e%t==0}return"original"===function(e){const t=e.technologies[0];return t.substring(t.indexOf("/machineTechno/")+"/machineTechno/".length)}(e)?1===e.sales_multiple?t(e.unitQuantity,10)?e.unitQuantity/10:NaN:t(e.sales_multiple,10)?e.sales_multiple/10:NaN:1===e.sales_multiple?t(e.unitQuantity,10)&&1!==e.unitQuantity?e.unitQuantity/10:t(e.unitQuantity,7)&&1!==e.unitQuantity?e.unitQuantity/7:NaN:t(e.sales_multiple,10)?e.sales_multiple/10:t(e.sales_multiple,7)?e.sales_multiple/7:NaN}(r),{background:c}=e,{disclaimer_text:d,link:u,logos:p,image:_,show_sleeve:h}=t,m=JSON.stringify({...p,...t,...i,unit_quantity:n,sales_multiple:s,sleeve_variation_pdp:!0,number_of_sleeves:l,bundled:o(r),show_sleeve:!isNaN(l)&&h,logos:i.logos,position:1,src_page:"pdp"});this.innerHTML=`\n            <nb-container\n                contrast='light'\n                background_mobile='${c.mobile}'\n                background_desktop='${c.desktop}'\n                background_retina='${c.retina}'>\n                <div class="cb-col1">\n                    ${u&&u.link&&u.label?`<nb-link link='${u.link}' seo_label='${u.seo_label}' color='black' size='large'\n                                >${u.label}</nb-link>`:""}\n                    <img alt="${_.alt_text}" class="sku"/>\n                    <small class="t-xs-500">${d}</small>\n                </div>\n                <div class="cb-col2">\n                    <nb-plp-product-card data='${m}' variation="pdp"></nb-plp-product-card>\n                </div>\n            </nb-container>\n        `}async trackDetailView(){window.napi.data().product().setProductData(await window.productHelper.getPadlProductDetail(await window.napi.catalog().getProduct(this.props.options.longSku)))}initLazyLoad(){const{image:e}=this.props.copywriting,t=this.querySelector(".sku");if(!t)return;const s=u.getResponsiveSrc(e);i(t,"src",s,s)}}customElements.get("nb-pdp-header")||customElements.define("nb-pdp-header",h);const m=()=>{const e=window[window?.padlNamespace]?.dataLayer;return e?e.app.app.market.toLocaleLowerCase():"ch"},g={fair_trade:"https://www.nespresso.com/shared_res/agility/commons/img/icons/fairTrade.svg",is_organic:function(){let e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-eu.svg";switch(m()){case"us":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-us.svg";break;case"ca":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-ca.svg";break;case"br":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-br.svg";break;case"jp":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-jp.svg";break;case"be":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-be.png"}return e}(),only_vertuo_next:"https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-only-vertuo-next.svg",is_q_certified_arabica:"https://www.nespresso.com/shared_res/agility/commons/img/icons/q_grade_certification_arabica.svg",is_rainforest:"https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-rainforest.svg",is_sustainable:"https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-sustainability.svg",is_design_award_2021:"https://www.nespresso.com/shared_res/agility/commons/img/icons/design_award_2021.svg"};function b(e){return e.find((e=>function(e){return $("cat/capsule-attribute-only-vertuo-next").test(e.id)}(e)))}function f(e){return e.find((e=>function(e){return $("capsule-attribute-organic-eu").test(e.id)}(e)))}function v(e){return e.find((e=>function(e){return $("capsule-attribute-rainforest").test(e.id)}(e)))}function y(e){return e.find((e=>function(e){return $("capsule-attribute-sustainability").test(e.id)}(e)))}function w(e){return e.find((e=>function(e){return $("capsule-attribute-arabica").test(e.id)}(e)))}function k(e){return e.filter((e=>function(e){return $("cat/capsule-range-label").test(e.id)}(e)))}function x(e){return e.find((e=>function(e){return $("cat/capsule-attribute-highlight").test(e.id)}(e)))}function E(e){return e.find((e=>function(e){return $("cat/capsule-range-fair-trade").test(e.id)}(e)))}function $(e){return new RegExp(e.replace(/\//g,"\\/"))}async function C(e){const{configuration:{eCommerceData:{categories:t,product:i}={}}={}}=e;if(i.ranges&&i.ranges.length>0){const e=i.ranges[0],s=t.find((t=>t.id===e));null!=s&&(i.rangeData=s)}return function(e,t){const i=k(e).map((e=>e.description));t.labels=i}(t,i),function(e,t){const i=E(e);if(!i)return;t.fairTrade=i.name}(t,i),function(e,t){if(!x(e))return;t.highlighted=!0}(t,i),function(e,t){if(!b(e))return;t.onlyVertuoNext=!0}(t,i),function(e,t){f(e)&&(t.organicEu=!0)}(t,i),function(e,t){v(e)&&(t.rainforest=!0)}(t,i),function(e,t){y(e)&&(t.sustainability=!0)}(t,i),function(e,t){w(e)&&(t.arabica=!0)}(t,i),e}async function L(){return await window.pdpData}window.gtmDataObject=window.gtmDataObject||[];const S=e=>{window.gtmDataObject.push({event:"impression",eventRaisedBy:"Web component",eventAction:"Promo Impression - On Scroll",ecommerce:{},...e})};class P extends class{constructor(e,t){this.observer=new IntersectionObserver((e=>this.onChange(e)),{threshold:[0],rootMargin:"0% 0%"}),this.el=e,this.data=t,this.el instanceof Element&&this.observer.observe(this.el)}onChange(e){e.forEach((e=>{e.isIntersecting&&(this.track(e),this.observer.unobserve(e.target))}))}track(){window.requestIdleCallback((()=>this.runTrack()))}runTrack(){this.data.id&&null!==this.data.id&&""!==this.data.id&&S({ecommerce:{promoView:{promotions:[this.data]}}})}}{constructor(e,t){super(e),this.data=t}runTrack(){this.data.id&&null!==this.data.id&&""!==this.data.id&&S({ecommerce:{promoView:{promotions:[this.data]}}})}}class T extends HTMLElement{constructor(){super(),this.props={},this.labels=[]}connectedCallback(){this.props=e(this.attributes),this.render()}render(){const{labels:e=[],direction:t="column"}=this.props;if(this.classList.add(""+("row"===t?"direction-row":"direction-"+t)),0===e.length)return"";this.labels=e,this.innerHTML=`${this.renderLabels()}`}renderLabels(){return this.labels.map((e=>{const{name:t="",bgColor:i="",color:s=""}=e;return`<mark class="t-3xs-500"\n                            ${i&&s&&`style="background: ${i}; color: ${s}"`}>\n                            <span aria-hidden="true">${t}</span>\n                            <span class="sr-only">${t}</span>\n                        </mark>`})).join("")}}customElements.get("nb-card-labels")||customElements.define("nb-card-labels",T);class I extends HTMLElement{constructor(){super(),this.props={}}connectedCallback(){this.props=e(this.attributes),this.render()}render(){let e,t,i,s,n,a,r,o,l,c,d,u,{direction:p="row",logos:_}=this.props;this.classList.add(""+("column"===p?"direction-column":"direction-"+p));let h=[];null==_?(e=this.props?.fair_trade,t=this.props?.alt_fair_trade,i=this.props?.is_organic,s=this.props?.alt_organic,n=this.props?.only_vertuo_next,a=this.props?.alt_vertuo_next,r=this.props?.is_rainforest,o=this.props?.alt_rainforest,l=this.props?.is_sustainable,c=this.props?.alt_sustainable,d=this.props?.is_q_certified_arabica,u=this.props?.alt_q_certification_arabica):void 0===_.length?(e=_?.fair_trade,t=_?.alt_fair_trade,i=_?.is_organic,s=_?.alt_organic,n=_?.only_vertuo_next,a=_?.alt_vertuo_next,r=_?.is_rainforest,o=_?.alt_rainforest,l=_?.is_sustainable,c=_?.alt_sustainable,d=_?.is_q_certified_arabica,u=_?.alt_q_certification_arabica):_.length&&(h=[..._]),[[e,"fair_trade",t,h],[i,"is_organic",s,h],[n,"only_vertuo_next",a,h],[r,"is_rainforest",o,h],[l,"is_sustainable",c,h],[d,"is_q_certified_arabica",u,h]].map((e=>this.appendLogo.apply(this,e))),this.innerHTML=h.map((e=>`<img src="${g[e.name]}" alt="${e.alt}" loading="lazy">`)).join("")}appendLogo(e,t,i,s){e&&!this.hasLogo(s,t)&&s.push({name:t,alt:i})}hasLogo(e,t){return e.some((e=>e.name===t))}}customElements.get("nb-card-logos")||customElements.define("nb-card-logos",I);class N extends HTMLElement{constructor(){super(),this.props={},this.level="",this.levelPlus=""}connectedCallback(){this.props=e(this.attributes),this.render()}render(){const{a11y_label:e,level:t}=this.props;if(""===e||""===t)return"";switch(this.classList.add(`level_${t}`),t){case"g":this.level="G";break;case"f":this.level="F";break;case"e":this.level="E";break;case"d":this.level="D";break;case"c":this.level="C";break;case"b":this.level="B";break;case"a4":this.level="A";break;case"a3":this.level="A",this.levelPlus="+";break;case"a2":this.level="A",this.levelPlus="++";break;default:this.level="A",this.levelPlus="+++"}this.innerHTML=`\n            <mark aria-label='${e} ${this.level}${this.levelPlus}'>\n                ${this.level}\n                ${""!==this.levelPlus?`<sup>${this.levelPlus}</sup>`:""}\n            </mark>\n        `}}customElements.get("nb-energy-label")||customElements.define("nb-energy-label",N);class M extends HTMLElement{constructor(){super(),this.props={}}connectedCallback(){this.props=e(this.attributes),this.render()}render(){const{intensity_label:e="Intensity",a11y_intensity_max:t,max_intensity:i}=this.props,s=parseInt(this.props.intensity);if(!s||isNaN(s))return"";const n=t.replace("{max_intensity}",i);this.innerHTML=`\n            <div aria-label="${e} ${s} ${n}">\n                ${e}${this.renderIntensityMin(s)}\n                ${s}\n                ${this.renderIntensityMax(s)}\n            </div>\n        `}renderIntensityMin(e){return new Array(Math.max(e,0)-0).fill('<span class="bar filled"></span>').join("")}renderIntensityMax(e){let{max_intensity:t}=this.props;return t&&"undefined"!==t||(t=14),new Array(parseInt(t)-Math.min(e,parseInt(t))).fill('<span class="bar"></span>').join("")}}customElements.get("nb-intensity")||customElements.define("nb-intensity",M);const D=({eventName:e,args:t,element:i})=>{let s;i=i||window,t?s=new CustomEvent(e,{detail:t,bubbles:!0}):"function"==typeof Event?s=new Event(e):(s=document.createEvent("Event"),s.initEvent(e,!0,!0)),i.dispatchEvent(s)};let A,O="";const q=e=>{V(e),e.bundlePopIn=document.getElementById("bundle-popin-id"),e.appendChild(e.bundlePopIn),r(e.bundlePopIn,{variation:"before",bgcolor:"white",size:"L",padding:"false",label_close:A,content:O}),e.bundlePopIn.classList.add("nb-popin--bundle"),D({eventName:"WEB_COMPONENT_POPIN_OPEN",args:{id:"bundle-popin-id"}})},V=e=>{if(null!=document.getElementById("bundle-popin-id"))return;let t=document.createElement("nb-popin");t=e.appendChild(t),t.setAttribute("id","bundle-popin-id"),t.setAttribute("content","")};function z({icon:e,text:t}){return`<nb-icon-text data="${n({icon:e,label:t,classname:"t-xs-500"})}"></nb-icon-text>`}const W=({price:e,giftcard_price:t,type:i,hidePrice:s})=>!e||"giftcard"===i&&!t||s?"":`<p class="cn_card__priceWrapper--current"><span>${e}</span></p>`,B=e=>{const{sales_multiple:t,label_sleeve:i,label_sleeves:n,show_sleeve:a=!1,sleeve_syntax:r="{numberOfSleeves} {sleeveLabel} ({quantity} {label_capsules})",number_of_sleeves:o,label_capsules:l,type:c,bundled:d,unit_quantity:u,unitQuantity:p}=e,_=o,h=_>1&&n?n:i,m=!1===d?t:u||p||0;let g;return a&&"capsule"===c&&_&&i&&l?(g=r,`<p class="cn_card__priceWrapper--items showSleeve">${s(g,{numberOfSleeves:_,sleeveLabel:h,quantity:m,label_capsules:l,label_sleeve:i},"{","}")}</p>`):""};async function H(e){const{in_stock:t,strikethrough_price:i,hide_add_to_cart:a=!1}=e,r=null!=t&&!t;return!0===a?"":`\n        <div class="cn_card__priceWrapper">\n            <div class="cn_card__priceInnerWrapper">\n                ${i?await(async e=>e?`<p class="cn_card__strikethroughPrice">${await l(e)}</p>`:"")(i):""}\n                ${W(e)}\n                ${r?"":B(e)}\n                ${r?"":(e=>{const{show_capsule_price:t=!1,price_per_capsule:i,capsule_price_label:n,capsule_price_syntax:a="{capsule_price_label}: {price_per_capsule}"}=e;return t?`<p class="cn_card__priceWrapper--items capsulePrice">${s(a,{capsule_price_label:n,price_per_capsule:i},"{","}")}</p>`:""})(e)}\n                ${(({type:e,price:t,price_per_capsule:i,a11y_price:s="euros per sleeve",a11y_capsule_price:n="Capsule price",sleeve_variation_pdp:a="false"})=>`<span class="sr-only">\n      ${"true"===a?"capsule"===e?`${n}: ${i}`:"":`${t} ${s}`}\n    </span>`)(e)}\n                ${r?(e=>{const{label_outofstock:t}=e.shop_similar;return""===t?"":`<p class="cn_card__priceWrapper--items t-xs-500-sl">${t}</p>`})(e):""}\n            </div>\n            ${(e=>{const{category_name:t="",type:i,sku:s,longSku:a="",position:r,giftcard_price:o,variation:l="plp",quantity_selector:c,hidePrice:u,url:p,view_details_label:_="View details"}=e;let h="large";if("plp"===l&&(h=d.is.mobile?"small":"large"),"giftcard"===i&&o)return`<nb-add-gift-card data="${n({price:o,sku:s,add_to_cart:h,quantity_selector:c})}"></nb-add-gift-card>`;return u?`<nb-cta link="${p}" variation="primary">${_}</nb-cta>`:`\n        <nb-add-to-cart\n            sku="${s}"\n            longSku="${a}"\n            buttonSize="${h}"\n            showPrice\n            range='${t}'\n            position='${r}'\n        ></nb-add-to-cart>\n    `})(e)}\n        </div>`}class R{constructor(e){this._carousel=e,this._carousel._container.addEventListener("dragstart",(e=>e.preventDefault())),this._carousel._container.addEventListener("touchstart",(e=>this.startDrag(e)),{passive:!0}),this._carousel._container.addEventListener("mousedown",(e=>this.startDrag(e))),this._carousel._container.addEventListener("touchstart",(e=>this.startDrag(e)),{passive:!0}),window.addEventListener("mousemove",(e=>this.drag(e)),{passive:!1}),window.addEventListener("touchmove",(e=>this.drag(e)),{passive:!1}),window.addEventListener("mouseup",(()=>this.endDrag())),window.addEventListener("touchend",(()=>this.endDrag())),window.addEventListener("touchcancel",(()=>this.endDrag())),this.translateFactor=150}startDrag(e){e.touches&&e.touches.length>1||(e.touches&&(e=e.touches[0]),this._origin={x:e.screenX,y:e.screenY},this._width=this._carousel.containerWidth)}drag(e){if(!this._origin)return;const t=e.touches?e.touches[0]:e,i={x:t.screenX-this._origin.x,y:t.screenY-this._origin.y};this._lastTranslate=i;const s=this._carousel._currentIndex*this._carousel._widthSlide-this.translateFactor*i.x/this._width;this._carousel.translate(s)}preventMobileYTranslate(e,t){e.touches&&(e.touches&&Math.abs(t.x)>Math.abs(t.y)||e.touches&&Math.abs(t.y)>Math.abs(t.x))&&(e.preventDefault(),e.stopPropagation())}endDrag(){if(!this._origin||!this._lastTranslate)return this._origin=null,void(this._lastTranslate=null);const e=this._lastTranslate.x/this._carousel.carouselWidth;if(Math.abs(e)>.1){const e=this._lastTranslate.x<0?"next":"prev";this._carousel[e]()}else this._carousel.goToItem(this._carousel._currentIndex);this._origin=null,this._lastTranslate=null}}class j{constructor(e){this._carousel=e,new MutationObserver((e=>{e.forEach((function(e){if(!e||!e.oldValue||!e.classList)return;const t=e.classList.contains("has-overlay-absolute"),i=document.body.classList.contains("has-overlay");t&&!i&&this._carousel.goToItem(this._carousel._currentIndex)}))})).observe(document.body,{attributes:!0,attributeFilter:["class"],attributeOldValue:!0})}}class F{constructor(e,t={}){this._element=e,this._slides=[].slice.call(e.children);const i=t.index||0;this._options=Object.assign({},{slidesToScroll:1,slidesVisible:1,spaceBetween:0,navigationButton:!0,loop:!0,pagination:!0,hookGetRightBoundary:null,hookSlideChange:null,hookMove:null,hookNext:null,hookPrevious:null,pagination_variation:null,nav_centered:!1},t),this.moveCallbacks=[],this._ratio=this._slides.length/this._options.slidesVisible,this.buildIHM(),new j(this),this.hasPagination()&&(new R(this),this.goToItem(i))}get element(){return this._element}get slidesToScroll(){return this._options.slidesToScroll}get slidesVisible(){return this._options.slidesVisible}get slidesTotal(){return this._slides.length}get navigationButton(){return this._options.navigationButton}get navigationVariation(){return this._options.navigation_variation}get navigationSize(){return this._options.navigation_size}get loop(){return this._options.loop}get pagination(){return this._options.pagination}get containerWidth(){return this._container.offsetWidth}get carouselWidth(){return this._root.offsetWidth}get wrapperWidth(){return this._wrapper.offsetWidth}get paginationVariation(){return this._options.pagination_variation}get nav_centered(){return this._options.nav_centered}getSlideWidth(e){const{slidesVisible:t,spaceBetween:i}=this._options;return(e+parseInt(i))/t}buildIHM(){this._root=this.createElement("div","carousel"),this._container=this.createElement("div","container"),this._wrapper=this.createElement("div","wrapper"),this._children=this._slides.map((e=>{const t=this.createElement("div","item");return t.appendChild(e),this._container.appendChild(t),t})),this._wrapper.appendChild(this._container),this._root.appendChild(this._wrapper),this._element.appendChild(this._root),this.setWrapperStyle(),this.hasPagination()&&(this.navigationButton&&this.createNavigation(),this.pagination&&this.createPagination())}setWrapperStyle(){const e=this.wrapperWidth,t=this.getSlideWidth(e),i=t*this._children.length;this.setContainerWidth(i),this.setWrapperWidth(e);for(const e of this._children)this.setSlideWidth(e,t);this._widthContainer=i,this._widthSlide=t,this._widthWrapper=e}setSlideWidth(e,t){e.style.width=t-this._options.spaceBetween+"px",this._options.spaceBetween&&(e.style.marginRight=`${this._options.spaceBetween}px`)}setContainerWidth(e){this._container.style.width=`${e}px`}setWrapperWidth(e){this._wrapper.style.width=`${e}px`}disableTransition(){this._container.style.transition="none"}enableTransition(){this._container.style.transition=""}translate(e){this._container.style.left=-e+"px"}createElement(e,t){let i=document.createElement(e);return i.setAttribute("class",t),i}createNavigation(){const e=this.createElement("nb-cta","prev");e.setAttribute("variation","navigation"),e.setAttribute("contrast",this.navigationVariation),e.setAttribute("size",this.navigationSize),e.setAttribute("icon_right","chevron-left"),e.setAttribute("label","a11y_slider_previous_button");const t=this.createElement("nb-cta","next");t.setAttribute("variation","navigation"),t.setAttribute("contrast",this.navigationVariation),t.setAttribute("size",this.navigationSize),t.setAttribute("icon_right","chevron-right"),t.setAttribute("label","a11y_slider_next_button"),t.addEventListener("click",(()=>this.next())),e.addEventListener("click",(()=>this.prev())),t.addEventListener("keydown",(e=>"Enter"===e.key||"Space"===e.key?this.next():null)),e.addEventListener("keydown",(e=>"Enter"===e.key||"Space"===e.key?this.prev():null));let i=this._root.parentElement;i.appendChild(e),i.appendChild(t),this.onMove((i=>{const s=i._currentIndex+this.slidesVisible;this.loop||(i._currentIndex<=0?e.classList.add("hidden"):e.classList.remove("hidden"),this._slides.length===s?t.classList.add("hidden"):t.classList.remove("hidden"),this._options.hookMove&&this._options.hookMove(t))}))}getSlideNotVisible(){return this._children.length-(this.slidesVisible-1)}hasPagination(){return this.getSlideNotVisible()>1}createPaginationBullets(){const e=document.createElement("nav"),t=[];for(let i=0;i<this.getSlideNotVisible();i+=this.slidesToScroll){let s=document.createElement("span");s.innerText=(i+1).toString();let n=document.createElement("button");n.addEventListener("click",(()=>this.goToItem(i))),n.appendChild(s),e.appendChild(n),t.push(n)}const i=e=>{let i=t[e/this.slidesToScroll];i&&(t.forEach((e=>e.classList.remove("active"))),i.classList.add("active"))};i(this._currentIndex),this.onMove((()=>i(this._currentIndex))),this._root.parentElement.parentElement.appendChild(e)}createPaginationStepper(){const e=document.createElement("nav");let t=document.createElement("div");t.innerText=this.slidesTotal-this.slidesVisible+1,t.classList.add("totalPages");let i=document.createElement("div");i.innerText="/";let s=document.createElement("div");s.classList.add("currentPage"),e.appendChild(s),e.appendChild(i),e.appendChild(t),this.onMove((()=>s.innerText=this._currentIndex+1)),this.onMove((()=>e.setAttribute("aria-label",s.innerText+" "+i.innerHTML+" "+t.innerHTML))),this._root.parentElement.parentElement.appendChild(e)}createPagination(){this.slidesTotal<=5?this.createPaginationBullets():"stepper"===this.paginationVariation?(this.createPaginationStepper(),console.info("paginationVariation >> enabled")):(this.createPaginationBullets(),console.info("bullets enabled"))}next(){let e=this._currentIndex+this.slidesToScroll;this._options.hookNext&&(e=this._options.hookNext(e)),this.goToItem(e)}prev(){let e=this._currentIndex-this.slidesToScroll;this._options.hookPrevious&&(e=this._options.hookPrevious(e)),this.goToItem(e)}goToItem(e){this.hackUi();const t=this.getOverflowingIndex(e);let i=t*this._widthSlide;this._options.hookSlideChange&&(i=this._options.hookSlideChange(t,i)),this.translate(i),this._currentIndex=t,this.indexHasChange()}hackUi(){const e=document.querySelector("html");!e.classList.contains("has-overlay-absolute")&&e.classList.contains("has-overlay")}getOverflowingIndex(e){const t=this.getLeftBoundary(e),i=this.getRightBoundary(e),s=this._children.length-this._options.slidesVisible;return t?this.loop?s:0:i?this.loop?0:s:e}getLeftBoundary(e){return e<0}getRightBoundary(e){const t=e>=this._children.length,i=this.currentIndex+this.slidesVisible,s=void 0!==this._children[i],n=e>this.currentIndex;let a=t||n&&!s;return this._options.hookGetRightBoundary&&(a=this._options.hookGetRightBoundary(a,e)),a}_getMaxSlideWidth(e){return e.reduce(((e,t)=>Math.max(e,t.offsetWidth)),0)}onSlideChange(e){this.onMove(e)}onMove(e){this.moveCallbacks.push(e)}indexHasChange(){this.moveCallbacks.forEach((e=>e(this))),this.activateItems()}activateItems(){const e=this._currentIndex+this.slidesVisible;this._slides.map(((t,i)=>{t.classList.remove("active"),t.parentElement.classList.remove("activeParent"),i>=this._currentIndex&&i<e&&(t.classList.add("active"),t.parentElement.classList.add("activeParent"))}))}setClass(e){this._element.classList.add(e)}unsetClass(e){this._element.classList.remove(e)}get currentIndex(){return this._currentIndex}}class Q extends HTMLElement{constructor(){super(),this._slider=null,this.randomId="slider_"+function(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=i.length,n=0;n<e;n++)t+=i.charAt(Math.floor(Math.random()*s));return t}(5)}static get observedAttributes(){return["slides_to_scroll","slides_visible","pagination","pagination_variation","nav_centered"]}connectedCallback(){this.slot=this.innerHTML,this.props=e(this.attributes),this.render()}createProps(){return[...this.attributes].reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{})}render(){this.innerHTML=`<div class="slider ${this.randomId}">${this.slot}</div>`,this.loadSlider()}loadSlider(){const{indexSlider:e=0,slides_loop:t="true",slides_visible:i=4,slides_to_scroll:s=1,navigation:n="true",pagination:a="true",space_between:r=0,navigation_variation:o="dark",navigation_size:l="48",pagination_variation:c="stepper",nav_centered:d="false"}=this.props,u=this.querySelector(`.${this.randomId}`),p={index:parseInt(e),slidesToScroll:parseInt(s),slidesVisible:parseInt(i),spaceBetween:r,loop:"true"===t,navigationButton:"true"===n,pagination:"true"===a,navigation_variation:o,navigation_size:l,pagination_variation:c,nav_centered:d};this._slider=new F(u,p),this._slider.setClass("first"),this._slider.onSlideChange(this.handleClick.bind(this))}handleClick(){var e;D({eventName:"WEB_COMPONENT_SLIDE_CHANGE"}),this.toggleClasses(),e={rootElement:["nb-slider"]},window.gtmDataObject.push({event:"itemDisplay",eventRaisedBy:"Web component",eventAction:"Click",itemTypes:["products"],...e})}toggleClasses(){const e=0===this._slider.currentIndex,t=this._slider.slidesTotal===this._slider.currentIndex+this._slider.slidesVisible;this._slider.unsetClass("last"),this._slider.unsetClass("first"),e?this._slider.setClass("first"):t&&this._slider.setClass("last")}}customElements.get("nb-slider")||customElements.define("nb-slider",Q);class J extends HTMLElement{constructor(){super(),this.props={}}connectedCallback(){this.props=e(this.attributes),this.render()}render(){const{slides:e,image_alt_text:t}=this.props;let s=document.createElement("nb-slider");r(s,{slides_to_scroll:"1",slides_visible:"1",navigation:"true",navigation_variation:"highlight",navigation_size:"32",pagination:"true"});let n=document.createElement("nb-loader");r(n,{icon:"loading"}),this.appendChild(n);e.forEach((e=>{const i=`${e.url}?impolicy=product&imwidth=600`;let n=document.createElement("img");n.setAttribute("alt",t),n.setAttribute("title",t),n.setAttribute("data-src",i),s.appendChild(n)})),this.appendChild(s),e.forEach((e=>{const t=`${e.url}?impolicy=product&imwidth=600`;i(s.querySelector(`img[data-src="${t}"]`),"src",t,t)}))}}function G({type:e,show_slider:t,slides:i,image:s,image_alt_text:a,plp_type:r},o){if(void 0===s||""===s||"pdp"===r)return"";const l=!o.is.mobile&&t&&i&&i.length>1;return("machine"===e||"machine"===r)&&l?function(e,t){return!e||e.length<=0?"":`<div class="cn_card__image">\n                <nb-product-card-image-slider\n                    data='${n({slides:e})}'\n                    image_alt_text=${t}>\n                </nb-product-card-image-slider>\n            </div>`}(i,a):function(e,t,i){return e?`<div class="cn_card__image">\n            ${i?`<a href="${i}" target="_self" aria-hidden="true" tabindex="-1">`:""}\n                <img class="cn_card__image__single" src=${e} alt="${t}"/>\n            ${i?"</a>":""}\n            </div>`:""}(s,a)}customElements.get("nb-product-card-image-slider")||customElements.define("nb-product-card-image-slider",J);class Y extends HTMLElement{async connectedCallback(){this.props=e(this.attributes),this.boundOnPDPLinkClick=this.onPDPLinkClick.bind(this),this.boundOnColorClick=this.onColorClick.bind(this),await this.render(),((e,t)=>{const{image:s=""}=e,n=t.querySelector("img.cn_card__image__single"),a="?impolicy=product&imwidth=150";n&&i(n,"src",`${s+a}`,s+a)})(this.props,this)}async render(){const{additional_message_icon:e,additional_message:t,category_name:i="",giftcard_price:s,hide_header:a,image:o,label_technology:l,label_range:c,labels:u=[],plp_type:p,position:_,rating_enabled:h=!1,show_ratings:m=!1,sku:g,src_page:b,type:f}=this.props;if("giftcard"===f&&!s)return null;!a&&o||this.classList.add("hide-header"),u.length&&this.classList.add("has-labels"),this.innerHTML=`\n            ${G(this.props,d)}\n            ${(({labels:e=[]})=>0===e.length?"":`<nb-card-labels data='${n({labels:e})}' direction="${d.is.mobile?"row":"column"}"></nb-card-labels>`)(this.props)}\n            ${((e,t)=>{const{fair_trade:i,alt_fair_trade:s,is_organic:a,alt_organic:r,only_vertuo_next:o,alt_vertuo_next:l,is_rainforest:c,alt_rainforest:d,is_sustainable:u,alt_sustainable:p,is_q_certified_arabica:_,alt_q_certification_arabica:h,logos:m}=e;return i||a||o||c||u||_||!(null==m||m.length<1)?(t.classList.add("has-logos"),`<nb-card-logos data='${n({fair_trade:i,alt_fair_trade:s,is_organic:a,alt_organic:r,only_vertuo_next:o,alt_vertuo_next:l,is_rainforest:c,alt_rainforest:d,is_sustainable:u,alt_sustainable:p,is_q_certified_arabica:_,alt_q_certification_arabica:h,logos:m})}'></nb-card-logos>`):""})(this.props,this)}\n            ${(({a11y_energy_label:e,energy_level:t})=>t?`<nb-energy-label data='${n({a11y_label:e,level:t})}'></nb-energy-label>`:"")(this.props)}\n            <div class="cn_card__content">\n                ${function(e){return e?`<p class="cn_card__technology t-xs-700">${e}</p>`:""}(l)}\n                ${function(e){return e?`<p class="cn_card__range t-xs-500">${e}</p>`:""}(c)}\n\n                ${(({url:e,a11y_product_card:t="",name:i="",label_decaffeinato:s,src_page:n=""},a)=>{const r=new RegExp(s,"ig"),o=s&&""!==s&&r.test(i);t=t.replace("{productName}",i),o?i=i.replace(r,"").trim():s="";const l="pdp"===n?"h1":"h3";return`${e?`<${l} class='cn_card__title'><a href="${e}" target="_self" title="${t}" aria-label="${t}">`:`<${l} class='cn_card__title'>`}\n${i}\n${s?`<span class='${a.is.mobile?"t-xs-700-caps":"t-sm-700-caps"}'>${s}</span>`:""}\n${e?`</a></${l}>`:`</${l}>`}`})(this.props,d)}\n                ${m&&h?'<div class="cn_card__rating"><nb-loader></nb-loader></div>':""}\n\n                ${function({headline:e="",is_headline_hidden:t=!1}){return""===e||t&&d.is.mobile?"":`<p class="cn_card__text">${e}</p>`}(this.props)}\n\n                ${"machine"===f?(({colors:e,sku:t,max_colors:i=4,a11y_extra_color:s="",url:a,activeSku:r,name:o})=>e?`<nb-colors data="${n({colors:e,max_colors:i,activeSku:r||t,extra_url:a,extra_title:o+", "+s})}" size="${d.is.mobile?"small":"large"}"></nb-colors>`:"")(this.props):""}\n                ${"machine"===f?function({features:e=[]}){return 0===e.length?"":`<div class="cn_card__features">${e.map(z).join("")}</div>`}(this.props):""}\n\n                ${"capsule"===f?(({type:e,bundle_details:t,bundled:i,sku:s,position:n,range:a},r)=>"capsule"===e&&t&&t.popin_link_text&&!0===i?(O=`<nb-bundle-details\n                main_sku='${s}'\n                description='${t.description}'\n                other_skus='${t.other_skus}'\n                other_skus_quantity= '${t.other_skus_quantity}'\n                range='${a}'\n                position='${n}'>\n            </nb-bundle-details>`,r.variation="white",A=t.popin_label_close,`<nb-link class="cn_card__cta__bundle" size="large" color="gold" label="${t.popin_link_text}"></nb-link>`):"")(this.props,this):""}\n                ${"capsule"===f?(({intensity:e,a11y_intensity_max:t,intensity_label:i=""})=>0===e||isNaN(parseInt(e))?"":`<nb-intensity\n        class="t-xs-500-sl"\n        intensity="${e}"\n        a11y_intensity_max="${t}"\n        intensity_label="${i}">\n    </nb-intensity>`)(this.props):""}\n\n                ${await H(this.props)}\n\n                ${"machine"===f?function(e){const{popin_id:t,subscription:i,view_details_label:s="View details"}=e;return void 0===i?"":`\n        <div class="cn_card__subscriptionWrapper">\n            ${W(e)}\n            <p class="t-sm-400">${i.text}</p>\n            <nb-cta class="cn_card__viewDetails" popin_id="${t}" variation="primary">${s}</nb-cta>\n        </div>\n        <nb-popin\n            id="${t}"\n            variation="before"\n            bgcolor="highlight"\n            size="L"\n            padding="false"\n            label_close="Close"\n            content="<nb-machine-details data='${n(e)}' />">\n        </nb-popin>\n    `}(this.props):""}\n\n                ${function(e,t){return t?`<p class="cn_card__additionalMessage t-sm-500-sl">\n        <nb-icon\n            icon="${e}"\n            class="additionalMsgIcon"\n        ></nb-icon> ${t}</p>`:""}(e,t)}\n            </div>\n        `,r(this,{"data-product-item-id":g,"data-product-section":i,"data-product-position":_,"data-src-page":b,"data-plp-type":p}),((e,t)=>{const{src_page:i,plp_type:s}=e;"plp"===i?"coffee"===s&&d.is.mobile?t.setAttribute("theme","landscape"):t.setAttribute("theme","portrait"):t.setAttribute("theme","pdp")})(this.props,this),this.bundlePopinLink=this.querySelector(".cn_card__cta__bundle button"),this.classList.add("cn_card"),this.bindEvent(),m&&h&&(({sku:e,minimum_rating:t=0},i)=>{if(!window.napi.ratings)return"";window.napi.ratings().summary(e).then((e=>e&&e.ratingAverage>0&&e.ratingAverage>t?e:"")).then((e=>e?{stars:e?parseFloat(e.ratingAverage.toFixed(2)):0}:"")).then((e=>{if(e){const t=document.createElement("nb-rating");t.setAttribute("stars",e?e.stars:0),i.querySelector("nb-loader").replaceWith(t)}else i.querySelector("nb-loader").remove()}))})(this.props,this.querySelector(".cn_card__rating"))}async onPDPLinkClick(){window.napi.data().product().setProductClickData(await window.productHelper.getPadlProductDetail(await window.napi.catalog().getProduct(this.props.lonGgSku)))}onColorClick(e){const t=(e=>{if(e.detail)return e.detail})(e);var i;t.sku&&(this.template="<nb-loader></nb-loader>",this.render(),(i=t.sku,window.napi.catalog().getProduct(i)).then((e=>{e&&(this.props={...this.props,sku:e.internationalId||"",longSku:e.id||"",image:e.images?.icon||"",image_alt_text:e.name||"",price:e.price,activeSku:e.internationalId||""})})).catch((()=>{console.error(`getProduct fail on sku ${t.sku}`)})))}bindEvent(){this.linkElements=[],this.unbindEvent(),this.linkElements=this.querySelectorAll("a[href]"),this.addEventListener("EVENT_COLOR_CLICKED",this.boundOnColorClick),this.linkElements.length&&Array.from(this.linkElements).forEach((e=>{e.addEventListener("click",this.boundOnPDPLinkClick)})),this.bundlePopinLink&&(this.boundBundlePopinLinkClick=q.bind(null,this),this.bundlePopinLink.addEventListener("click",this.boundBundlePopinLinkClick))}unbindEvent(){this.removeEventListener("EVENT_COLOR_CLICKED",this.boundOnColorClick),this.linkElements?.length&&(Array.from(this.linkElements).forEach((e=>{e.removeEventListener("click",this.boundOnPDPLinkClick)})),this.linkElements=[]),this.bundlePopinLink&&this.bundlePopinLink.removeEventListener("click",this.boundBundlePopinLinkClick)}disconnectedCallback(){this.unbindEvent()}}customElements.get("nb-plp-product-card")||customElements.define("nb-plp-product-card",Y);class K extends HTMLElement{constructor(){super()}connectedCallback(){this.props=this.createProps(),this.classes=this.createClasses(),this.render()}createProps(){return[...this.attributes].reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{})}createClasses(){const{padding_top:e="pt0",padding_bottom:t="pb0"}=this.props,i="nb-disclaimer";return{root:[i,e,t].join(" "),text:[`${i}__text`,"t-sm-400"].join(" ")}}render(){const{text:e="",content:t=""}=this.props;this.innerHTML=`\n          <nb-container\n            contrast="light"\n            element_class="${this.classes.root}"\n          >\n              <p class="${this.classes.text}">${e}</p>\n              ${t&&`<nb-tooltip content="${t}" />`}\n          </nb-container>\n        `}disconnectedCallback(){}attributeChangedCallback(){}adoptedCallback(){}}customElements.get("nb-disclaimer")||customElements.define("nb-disclaimer",K);class U extends HTMLElement{constructor(){super(),this.props={},this.pdpData={}}async connectedCallback(){this.props=e(this.attributes);try{this.priceFormatter=await async function(){return napi.priceFormat()}(),this.currency=(await async function(){return napi.market().read()}()).currency}catch(e){console.log(e)}!async function(){window.getPDPData=window.getPDPData||L}(),this.pdpData=await C(await window.getPDPData()),this.translations=this.pdpData.configuration.translations,this.product=this.pdpData.configuration.eCommerceData.product,this.categories=this.pdpData.configuration.eCommerceData.categories,this.render(),this.initTracking()}render(){const{show_sleeve_price:e,alt_fair_trade:t,alt_vertuo_next:i,alt_organic:s,alt_rainforest:n,alt_sustainability:r,alt_q_certification_arabica:l,logos:c,strikethrough_price:d}=this.props.copywriting,u=this.product;let{showCapsulePrice:p,price:_,price_per_capsule:h}=function(e,t,i){let s,n,a=e;const r=i(t);return e&&"capsule"===t.type&&!r?(s=!1===r?t.price*t.salesMultiple:t.price,s=Math.round(100*s)/100,n=t.price):(a=!1,s=t.price),{showCapsulePrice:a,price:s,price_per_capsule:n}}(e,u,o),m={sku:u.internationalId,technologies:u.technologies,longSku:u.id,name:u.name,headline:a(u.headline),sales_multiple:u.salesMultiple,unit_quantity:u.unitQuantity,type:u.type,intensity_label:this.translations["productdetailsrespblock.capsule.a11y.intensity"].replace("{intensity}","").trim(),intensity:u.intensity,category_name:u.rangeData?.name||"",label_range:u.rangeData?.name||"",show_sleeve_price:e,price:_?this.priceFormatter.short(this.currency,_):null,price_per_capsule:h?this.priceFormatter.short(this.currency,h):null,showCapsulePrice:p,show_capsule_price:p,strikethrough_price:d||""};try{m.label_technology=function(e){if(!e||!e.technologies||!e.technologies.length)return null;const t=e.technologies[0];return t.substring(t.indexOf("/machineTechno/")+"/machineTechno/".length)}(u)}catch(e){console.error("Technology not found",e)}if(null!=u.labels)try{m.labels=u.labels.map((e=>JSON.parse(e)))}catch(e){console.error("Wrong JSON format in HMC label categories capsule-range-label",e)}let g=null!=c?[...c]:[];[[u.fairTrade,"fair_trade",t,g],[u.organicEu,"is_organic",s,g],[u.onlyVertuoNext,"only_vertuo_next",i,g],[u.rainforest,"is_rainforest",n,g],[u.sustainability,"is_sustainable",r,g],[u.arabica,"is_q_certified_arabica",l,g]].map((e=>this.appendLogo.apply(this,e))),m.logos=g,m.variation="pdp",m.src_page="pdp",m.plp_type="pdp",null!=u.highlighted&&(m.highlighted=u.highlighted),function(e,t,i,s){const n=document.createElement(i);n.setAttribute("data",JSON.stringify(t)),function(e,t,i,s,n=!0){if(n){const t=e.getElementsByTagName(i);t.length>0&&t[0].parentElement&&t[0].parentElement.removeChild(t[0])}e.children.length>=s+1?e.insertBefore(t,e.children[s]):e.appendChild(t)}(e,n,i,s)}(this,{...this.props,options:m},"nb-pdp-header",0)}appendLogo(e,t,i,s){null==e||this.hasLogo(s,t)||s.push({name:t,alt:i})}hasLogo(e,t){return e.some((e=>e.name===t))}initTracking(){const{campaign:e}=this.props;!function(e,t){const i=new P(e,t)}(this,e)}}customElements.get("nb-pdp")||customElements.define("nb-pdp",U);export{U as default};
