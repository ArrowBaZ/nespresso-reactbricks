class e extends HTMLElement{constructor(){super(),this.template=""}connectedCallback(){this.props=this._createProps(),this.onStart?.(),this.loadTemplate(),this.onReady?.()}_createProps(e=null){const n=e||this.attributes;let t;try{t=[...n].reduce(((e,n)=>({...e,[n.nodeName]:n.nodeValue})),{});const e=[...n].find((e=>"data"===e.nodeName));return null==e?t:{...t,...JSON.parse(e.nodeValue)}}catch(e){console.log("ERROR: No data",e)}}render(e=!1){e&&(this.innerHTML="");const n=(e,t)=>{const i=e=>3===e.nodeType?"text":8===e.nodeType?"comment":e.tagName.toLowerCase(),o=e=>e.childNodes&&e.childNodes.length>0?null:e.textContent;var r=Array.prototype.slice.call(t.childNodes),s=Array.prototype.slice.call(e.childNodes),l=r.length-s.length;if(l>0)for(;l>0;l--)r[r.length-l].parentNode.removeChild(r[r.length-l]);s.forEach((function(e,s){if(r[s])if(i(e)===i(r[s])){var l=o(e);if(l&&l!==o(r[s])&&(r[s].textContent=l),r[s].childNodes.length>0&&e.childNodes.length<1)r[s].innerHTML="";else{if(r[s].childNodes.length<1&&e.childNodes.length>0){var a=document.createDocumentFragment();return n(e,a),void r[s].appendChild(a)}e.childNodes.length>0&&n(e,r[s])}}else r[s].parentNode.replaceChild(e.cloneNode(!0),r[s]);else t.appendChild(e.cloneNode(!0))}))},t=(i=this.template,(new DOMParser).parseFromString(i,"text/html").body);var i;n(t,this)}loadTemplate(e="",n=!1){this.template=""===e?this.template:`${e}`,this.render(n)}disconnectedCallback(){this.onDestroy?.()}}customElements.get("nb-nespresso-element")||customElements.define("nb-nespresso-element",e);const n={get is(){const{innerWidth:e,devicePixelRatio:n}=window;return{mobile:e<768,mobile_tablet:e<1024,tablet:e>=768&&e<1024,desktop:e>=1024&&n<=1,retina:e>=1024&&n>1}},lt:e=>window.innerWidth<e};class t extends e{loadTemplate(){const{campaign:e}=this.props;let{style:t,secondary_substyle:i,link:o,is_sticky:r,sticky_top:s,sticky_top_mobile:l}=this.props.copywriting;const a=document.querySelector(".nb-informative-stripe.nb-is-sticky");(n.is.mobile||n.is.tablet)&&(s=l),this.template=`\n            <div class="nb-informative-stripe ${this.getInformativeStripeCSSClasses(t,i)} ${"true"!==r||a?"":"nb-is-sticky"}">\n                <nb-container\n                    campaign_id="${e.id}"\n                    campaign_name="${e.name}"\n                    campaign_position="${e.position}"\n                    campaign_creative="${e.creative}">\n                    <div class="nb-informative-stripe__inner">\n                        ${this.renderIcon(t)}\n                        <div class="nb-informative-stripe__inner--info">\n                            <span>${this.renderDescription()}</span>\n                            <span>${this.renderLink()}</span>\n                        </div>\n                    </div>\n\n                    ${o.has_popin?this.renderPopin():""}\n                </nb-container>\n            </div>\n        `,this.render(),this.observeStickyNavbar(s),this.observeAppBanner(),this.setStaticPLPBelow()}setStaticPLPBelow(){const e=document.querySelector("nb-informative-stripe + nb-plp");if(e){const n=e.previousElementSibling;if(n){const e=n.querySelector(".nb-informative-stripe");e&&e.classList.add("nb-has-plp-below")}}}isAppBannerAvailable(e){return!!e&&"none"!==e.style.display}observeStickyNavbar(e){const n=document.querySelectorAll("nb-informative-stripe .nb-is-sticky")[0],t=document.querySelector("nb-plp");if(t&&n&&!this.isAppBannerAvailable()){new MutationObserver((function(t){const i=document.querySelector("plp-navigation");t.forEach((function(t){if("attributes"===t.type){const t=i.getAttribute("sticky");if(n.style.top=`${e}px`,"true"===t){const e=i.getBoundingClientRect().bottom;n.style.top=`${e}px`}}}))})).observe(t,{attributes:!0,childList:!0,subtree:!0})}}observeAppBanner(){const e=document.querySelector("nb-app-banner"),n=document.querySelectorAll("nb-informative-stripe .nb-is-sticky")[0];if(e&&n){new MutationObserver((function(e){const t=document.querySelector(".is-plp-nav-positioned");e.forEach((function(e){if("attributes"===e.type&&(n.style.removeProperty("top"),t)){const e=t.getBoundingClientRect().bottom;n.style.top=`${e}px`}}))})).observe(e,{attributes:!0,childList:!0,subtree:!0})}}getInformativeStripeCSSClasses(e,n="medium"){const{background_color:t}=this.props.layout;return"primary"===e&&t?`nb-informative-stripe--color-${t}`:"secondary"===e?`nb-informative-stripe--secondary nb-informative-stripe--secondary--${n}`:"tertiary"===e?"nb-informative-stripe--tertiary":""}renderIcon(e){const{icon_left:n}=this.props.copywriting.description;return n&&"tertiary"!==e?`\n            <span><nb-icon icon="${n}"></nb-icon></span>\n        `:""}renderDescription(){const{label:e}=this.props.copywriting.description;return e}renderLink(){const{style:e,link:t,popin:i}=this.props.copywriting,{background_color:o}=this.props.layout;return t.label?"true"===t.is_tooltip?`\n                <nb-tooltip\n                    content="${t.label}"\n                    position="top"\n                    alignment="${n.is.mobile?"right":"center"}">\n                </nb-tooltip>\n            `:(n.is.mobile||n.is.tablet)&&"secondary"===e?`\n                <nb-link\n                    seo_label="${t.seo_label}"\n                    tracking_label="${t.tracking_label}"\n                    custom_tracking="true"\n                    event_action="Click CTA"\n                    ${"true"===t.has_popin?`popin_id="${i.id}"`:`link="${t.link}"`}\n                    size="small"\n                    color="black"\n                ><nb-icon icon="chevron-right"></nb-icon></nb-link>\n            `:"tertiary"!==e?`\n                <nb-link\n                    ${"true"===t.has_popin?`popin_id="${i.id}"`:`link="${t.link}"`}\n                    seo_label="${t.seo_label}"\n                    tracking_label="${t.tracking_label}"\n                    custom_tracking="true"\n                    event_action="Click CTA"\n                    size="small"\n                    color="${"primary"===e?"highlight_250"===o?"black":"white":"gold"}"\n                >${t.label}</nb-link>\n            `:void 0:""}renderPopin(){const{copywriting:{popin:e={}}={}}=this.props,{id:n="",image:t="",heading:i="",description:o="",image_alt:r="",close:s=""}=e;return n&&`<nb-popin\n                id="${n}"\n                heading="${i}"\n                variation="next"\n                bgcolor="highlight"\n                label_close="${s}"\n                image="${t}"\n                image_alt="${r}"\n            >\n                ${o}\n            </nb-popin>`}}customElements.get("nb-informative-stripe")||customElements.define("nb-informative-stripe",t);export{t as default};
