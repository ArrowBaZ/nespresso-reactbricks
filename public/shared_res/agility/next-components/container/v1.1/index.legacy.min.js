window.gtmDataObject=window.gtmDataObject||[];const e=e=>{window.gtmDataObject.push({event:"impression",eventRaisedBy:"Web component",eventAction:"Promo Impression - On Scroll",ecommerce:{},...e})};class t extends class{constructor(e,t){this.observer=new IntersectionObserver((e=>this.onChange(e)),{threshold:[0],rootMargin:"0% 0%"}),this.el=e,this.data=t,this.el instanceof Element&&this.observer.observe(this.el)}onChange(e){e.forEach((e=>{e.isIntersecting&&(this.track(e),this.observer.unobserve(e.target))}))}track(){window.requestIdleCallback((()=>this.runTrack()))}runTrack(){this.data.id&&null!==this.data.id&&""!==this.data.id&&e({ecommerce:{promoView:{promotions:[this.data]}}})}}{constructor(e,t){super(e),this.data=t}runTrack(){this.data.id&&null!==this.data.id&&""!==this.data.id&&e({ecommerce:{promoView:{promotions:[this.data]}}})}}class n extends HTMLElement{constructor(){super(),this.template=""}connectedCallback(){this.props=this._createProps(),this.onStart?.(),this.loadTemplate(),this.onReady?.()}_createProps(e=null){const t=e||this.attributes;let n;try{n=[...t].reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{});const e=[...t].find((e=>"data"===e.nodeName));return null==e?n:{...n,...JSON.parse(e.nodeValue)}}catch(e){console.log("ERROR: No data",e)}}render(e=!1){e&&(this.innerHTML="");const t=(e,n)=>{const s=e=>3===e.nodeType?"text":8===e.nodeType?"comment":e.tagName.toLowerCase(),o=e=>e.childNodes&&e.childNodes.length>0?null:e.textContent;var i=Array.prototype.slice.call(n.childNodes),r=Array.prototype.slice.call(e.childNodes),a=i.length-r.length;if(a>0)for(;a>0;a--)i[i.length-a].parentNode.removeChild(i[i.length-a]);r.forEach((function(e,r){if(i[r])if(s(e)===s(i[r])){var a=o(e);if(a&&a!==o(i[r])&&(i[r].textContent=a),i[r].childNodes.length>0&&e.childNodes.length<1)i[r].innerHTML="";else{if(i[r].childNodes.length<1&&e.childNodes.length>0){var c=document.createDocumentFragment();return t(e,c),void i[r].appendChild(c)}e.childNodes.length>0&&t(e,i[r])}}else i[r].parentNode.replaceChild(e.cloneNode(!0),i[r]);else n.appendChild(e.cloneNode(!0))}))},n=(s=this.template,(new DOMParser).parseFromString(s,"text/html").body);var s;t(n,this)}loadTemplate(e="",t=!1){this.template=""===e?this.template:`${e}`,this.render(t)}disconnectedCallback(){this.onDestroy?.()}}customElements.get("nb-nespresso-element")||customElements.define("nb-nespresso-element",n);const s={get is(){const{innerWidth:e,devicePixelRatio:t}=window;return{mobile:e<768,mobile_tablet:e<1024,tablet:e>=768&&e<1024,desktop:e>=1024&&t<=1,retina:e>=1024&&t>1}},lt:e=>window.innerWidth<e};class o extends HTMLElement{constructor(){super(),this.slot=this.innerHTML}connectedCallback(){this.props=[...this.attributes].reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{}),this.render(),this.initTracking(),this.initLazyLoad()}initTracking(){const{campaign_id:e=null,campaign_name:n=null,campaign_position:s=null,campaign_creative:o=null}=this.props;!function(e,n){const s=new t(e,n)}(this,{id:e,name:n,position:s,creative:o})}initLazyLoad(){const e=this.querySelector(".cb-bg-img");if(!e)return;const t=this.getBgImgUrl();t&&function(e,t,n,s,o){const i=(t,n)=>{e.setAttribute(t,n);const i=()=>e.classList.add("lazy-loaded");if(s){const t=new Image;return t.src=s,t.onload=i,void(t.onerror=()=>{o&&o(`Image ${s} cannot be loaded.`),e.classList.add("lazy-loaded-error")})}i()};if(/Trident\/|MSIE/.test(window.navigator.userAgent)||(r=window.navigator.userAgent,a=r.indexOf("OS "),(r.indexOf("iPhone")>-1||r.indexOf("iPad")>-1)&&a>-1&&window.Number(r.substr(a+3,3).replace("_","."))<14))i(t,n);else if("IntersectionObserver"in window){e.classList.add("lazy-load");let s=new IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting&&(i(t,n),s.unobserve(e.target))}))}));s.observe(e)}else i(t,n);var r,a}(e,"style",`background-image: url(${t}); ${e.getAttribute("style")||""}`,t)}getBgImgUrl(){const{background_mobile:e="",background_tablet:t="",background_desktop:n="",background_retina:o=""}=this.props;return s.is.mobile&&e?e:s.is.tablet&&t?t:s.is.retina&&o?o:n}render(){const{styles:e="",contrast:t,background_color:n="",classname:s="",element_class:o="",slot:i}=this.props;let r="light";"undefined"===t?this.setAttribute("contrast",r):r=t,this.innerHTML=`\n            <section\n                class="${s}"\n                contrast="${r}"\n                style="${e}"\n            >\n                ${n||this.hasBgImage()?this.renderBg():""}\n                <div class="cb-inner ${o}">\n                    ${i}\n                </div>\n            </section>`}hasBgImage(){const{background_mobile:e,background_desktop:t,background_retina:n}=this.props;return!!e||!!t||!!n}renderBg(){const{background_color:e=""}=this.props;return`<div class="cb-bg-color ${e?`${e}`:""}">\n        </div>${this.hasBgImage()?'<div class="cb-bg-img"></div>':""}`}}customElements.get("nb-container")||customElements.define("nb-container",o);export{o as default};
