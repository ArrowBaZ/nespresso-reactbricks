const e=768,t="WEB_COMPONENT_POPIN_OPEN",s="WEB_COMPONENT_POPIN_CLOSE",i="WEB_COMPONENT_POPIN_CLOSED",n="WEB_COMPONENT_SLIDER_READY",r="WEB_COMPONENT_SORT_BY_CHANGE";class a extends HTMLElement{constructor(){super(),this.template=""}connectedCallback(){this.props=this._createProps(),this.onStart?.(),this.loadTemplate(),this.onReady?.()}_createProps(e=null){const t=e||this.attributes;let s;try{s=[...t].reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{});const e=[...t].find((e=>"data"===e.nodeName));return null==e?s:{...s,...JSON.parse(e.nodeValue)}}catch(e){console.log("ERROR: No data",e)}}render(e=!1){e&&(this.innerHTML="");const t=(e,s)=>{const i=e=>3===e.nodeType?"text":8===e.nodeType?"comment":e.tagName.toLowerCase(),n=e=>e.childNodes&&e.childNodes.length>0?null:e.textContent;var r=Array.prototype.slice.call(s.childNodes),a=Array.prototype.slice.call(e.childNodes),o=r.length-a.length;if(o>0)for(;o>0;o--)r[r.length-o].parentNode.removeChild(r[r.length-o]);a.forEach((function(e,a){if(r[a])if(i(e)===i(r[a])){var o=n(e);if(o&&o!==n(r[a])&&(r[a].textContent=o),r[a].childNodes.length>0&&e.childNodes.length<1)r[a].innerHTML="";else{if(r[a].childNodes.length<1&&e.childNodes.length>0){var l=document.createDocumentFragment();return t(e,l),void r[a].appendChild(l)}e.childNodes.length>0&&t(e,r[a])}}else r[a].parentNode.replaceChild(e.cloneNode(!0),r[a]);else s.appendChild(e.cloneNode(!0))}))},s=(i=this.template,(new DOMParser).parseFromString(i,"text/html").body);var i;t(s,this)}loadTemplate(e="",t=!1){this.template=""===e?this.template:`${e}`,this.render(t)}disconnectedCallback(){this.onDestroy?.()}}function o(e){const t=document.implementation.createHTMLDocument("");return t.body.innerHTML=e,t.body.childNodes}function l(e,t,s,i,n){const r=(t,s)=>{e.setAttribute(t,s);const r=()=>e.classList.add("lazy-loaded");if(i){const t=new Image;return t.src=i,t.onload=r,void(t.onerror=()=>{n&&n(`Image ${i} cannot be loaded.`),e.classList.add("lazy-loaded-error")})}r()};if(/Trident\/|MSIE/.test(window.navigator.userAgent)||(a=window.navigator.userAgent,o=a.indexOf("OS "),(a.indexOf("iPhone")>-1||a.indexOf("iPad")>-1)&&o>-1&&window.Number(a.substr(o+3,3).replace("_","."))<14))r(t,s);else if("IntersectionObserver"in window){e.classList.add("lazy-load");let i=new IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting&&(r(t,s),i.unobserve(e.target))}))}));i.observe(e)}else r(t,s);var a,o}customElements.get("nb-nespresso-element")||customElements.define("nb-nespresso-element",a);const c=e=>d(JSON.stringify(e)),d=e=>e?e.toString().replace(/"/g,"&quot;").replace(/'/g,"&apos;"):"",u={get is(){const{innerWidth:e,devicePixelRatio:t}=window;return{mobile:e<768,mobile_tablet:e<1024,tablet:e>=768&&e<1024,desktop:e>=1024&&t<=1,retina:e>=1024&&t>1}},lt:e=>window.innerWidth<e},h="plp",p=e=>"pdp"===e,b=e=>{const{url:t,name:s="",name_custom:i=""}=e;if(!s)return"";const n=""!==i?i:s,r=[],a=(({variation:e})=>p(e)?"h1":"h3")(e);return r.push(`<${a} class="cb-heading">`),t&&p(e.variation)?r.push((({url:e,a11y_product_card:t="",name:s="",name_custom:i=""})=>{const n=t.replace("{productName}",s);return`<a href="${e}" target="_self" title="${n}" aria-label="${n}">${""!==i?i:s}</a>`})(e)):r.push(`${n}`),r.push(`</${a}>`),r.join("")},m=async e=>{const t=await(async()=>await window.napi.priceFormat())(),s=window[window.config.padl.namespace].dataLayer.app.app.currency;return t.html?t.html(s,e):t.short(s,e)||""},g=e=>e.querySelector(".cb-price-old"),_=({strikethrough_price:e},t)=>{return e?((s=e,m(s)).then((e=>{const s=g(t);s&&(s.innerHTML=e)})).catch((e=>{console.error(`Error: Component SKU - Strike Through Price  - ${e}`);const s=g(t);s&&(s.style.display="none")})),'<p class="cb-price-old"></p>'):"";var s};class f extends a{constructor(){super(),this.type="default",this.boundOnPDPLinkClick=this.onPDPLinkClick.bind(this)}loadTemplate(){this.classList.add("nb-sku"),this.classList.add(`nb-sku__${this.type}`),(({variation:e,type:t},s)=>{"pdp"!==e?"capsule"===t&&u.is.mobile?s.setAttribute("landscape","true"):s.setAttribute("portrait","true"):s.setAttribute("pdp","true")})(this.props,this),this.template=`${this.renderVisual()}\n                          ${this.renderHeader()}\n                          <div class="cb-content">\n                              ${this.renderInformation()}\n                              <div class="cb-shop">\n                                  <div class="cb-price">\n                                      ${this.renderPricing()}\n                                  </div>\n                                  ${this.renderAction()}\n                              </div>\n                              ${this.renderFooter()}\n                          </div>`,this.render()}onReady(){const{sku:e,category_name:t,position:s=0}=this.props;this.setAttribute("data-product-item-id",e),this.setAttribute("data-product-section",t),this.setAttribute("data-product-position",s.toString()),this.activateLazyLoad(),this.bindEvent()}activateLazyLoad(){const{image:e}=this.props;if(!e)return"";(({image:e=""},t)=>{const s=".cb-image img",i=t.querySelector(s),n=e=>{console.log(e),console.error(`Error: Component SKU - Lazy Load - ${e}`),i&&(i.style.display="none")};if(!i)return n(`${s} HTMLElement not found.`),"";const r=e+((e="product",t=150)=>{const s=[];return e&&s.push(`impolicy=${e}`),t&&s.push(`imwidth=${t}`),`?${s.join("&")}`})();if(!r)return n(`${r} source file is empty.`),"";l(i,"src",`${r}`,r,n)})(this.props,this)}renderHeaderDefault(){return`${(({labels:e=[]},t=null)=>{if(!t||!e||!e.length)return"";t&&e.length&&t.classList.add("has-labels");const s=u.is.mobile?"row":"column";return`<nb-card-labels data="${c({labels:e})}" direction="${s}"></nb-card-labels>`})(this.props,this)}${((e,t)=>{const{fair_trade:s,alt_fair_trade:i,is_organic:n,alt_organic:r,only_vertuo_next:a,alt_vertuo_next:o,is_rainforest:l,alt_rainforest:d,is_sustainable:u,alt_sustainable:h,is_q_certified_arabica:p,alt_q_certification_arabica:b,logos:m}=e;return s||n||a||l||u||p||!(null==m||m.length<1)?(t.classList.add("has-logos"),`<nb-card-logos data='${c({fair_trade:s,alt_fair_trade:i,is_organic:n,alt_organic:r,only_vertuo_next:a,alt_vertuo_next:o,is_rainforest:l,alt_rainforest:d,is_sustainable:u,alt_sustainable:h,is_q_certified_arabica:p,alt_q_certification_arabica:b,logos:m})}'></nb-card-logos>`):""})(this.props,this)}`}renderHeader(){return this.renderHeaderDefault()}renderVisualDefault(){return(({url:e,image_alt_text:t,image:s})=>{if(!s)return"";let i=`<img src="" alt="${t||"loading"}"/>`;return e&&(i=`<a href="${e}" target="_self" aria-hidden="true" tabindex="-1">${i}</a>`),`<div class="cb-image">\n                ${i}\n            </div>`})(this.props)}renderVisual(){return this.renderVisualDefault()}renderInformationDefault(){return`${(({label_technology:e})=>e?`<p class="cb-technology t-xs-700">${e}</p>`:"")(this.props)}\n        ${(({label_range:e})=>e?`<p class="cb-range t-xs-500">${e}</p>`:"")(this.props)}\n        ${b(this.props)}\n        ${(({headline:e="",is_headline_hidden:t=!1})=>t&&u.is.mobile||!e?"":`<p class="cb-text">${e}</p>`)(this.props)}`}renderInformation(){return this.renderInformationDefault()}renderPricingDefault(){return`${_(this.props,this)}\n                ${(({price:e,hidePrice:t,giftcard_price:s})=>!e&&!s||t?"":`<p class="cb-price-current"><span>${e||s}</span></p>`)(this.props)}`}renderPricing(){return this.renderPricingDefault()}renderActionDefault(){return(e=>{const{category_name:t="",sku:s,longSku:i="",position:n,variation:r=h,hidePrice:a,url:o,view_details_label:l="View details",rendererName:c=""}=e;let d="large";return r===h&&(d=u.is.mobile?"small":"large"),"small"===r&&(d="small"),a?`<nb-cta link="${o}" variation="primary">${l}</nb-cta>`:`\n        <nb-add-to-cart\n            sku="${s}"\n            longSku="${i}"\n            buttonSize="${d}"\n            showPrice\n            range='${t}'\n            position='${n}'\n            rendererName='${c}'\n        ></nb-add-to-cart>\n    `})(this.props)}renderAction(){return this.renderActionDefault()}renderFooterDefault(){return(({additional_message_icon:e,additional_message:t,additional_message_link:s})=>{if(!t&&!s)return"";let i="";if(t){let s="";e&&(s=`<nb-icon icon="${e}" class="additionalMsgIcon"></nb-icon>`),i=`<p class="cb-warn t-sm-500-sl">\n            ${s}\n            ${t}</p>`}return s&&s.link&&s.label&&(i+=`<nb-link\n            link='${s.link}'\n            color="${s.color}"\n            size="${s.size}"\n            seo_label="${s.seo_label}">\n            ${s.label}\n        </nb-link>`),i})(this.props)}renderFooter(){return this.renderFooterDefault()}async onPDPLinkClick(){window.napi&&window.napi.data&&window.napi.data().product().setProductClickData(await window.productHelper.getPadlProductDetail(await window.napi.catalog().getProduct(this.props.longSku)))}bindEvent(){this.linkElements=[],this.unbindEvent(),this.linkElements=this.querySelectorAll("a[href]"),this.linkElements.length&&Array.from(this.linkElements).forEach((e=>{e.addEventListener("click",this.boundOnPDPLinkClick)}))}unbindEvent(){this.linkElements.length&&(Array.from(this.linkElements).forEach((e=>{e.removeEventListener("click",this.boundOnPDPLinkClick)})),this.linkElements=[])}disconnectedCallback(){this.unbindEvent()}}customElements.get("nb-sku")||customElements.define("nb-sku",f);customElements.get("nb-sku-accessory")||customElements.define("nb-sku-accessory",class extends f{constructor(){super(),this.type="accessory"}});const v=e=>{const t=(e=>e.find((e=>"data"===e.nodeName)))([...e]),s=[...e].filter((e=>"data"!==e.nodeName)).reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{});if(y(t))return s;try{return{...s,...JSON.parse(t.nodeValue)}}catch(e){console.log("ERROR: No data",e)}},y=e=>null==e;class k{constructor(){this._bus=document.createElement("div")}register(e,t){this._bus.addEventListener(e,t)}remove(e,t){this._bus.removeEventListener(e,t)}fire(e,t={}){this._bus.dispatchEvent(new CustomEvent(e,{detail:t}))}}if(!w)var w=new k;var E=w;const C=({eventName:e,args:t,element:s})=>{let i;s=s||window,t?i=new CustomEvent(e,{detail:t,bubbles:!0}):"function"==typeof Event?i=new Event(e):(i=document.createEvent("Event"),i.initEvent(e,!0,!0)),s.dispatchEvent(i)},L=e=>{if(e.detail)return e.detail};window.gtmDataObject=window.gtmDataObject||[];const $=e=>{window.gtmDataObject.push({event:"customEvent",eventRaisedBy:"Web component",eventCategory:"User Engagement",eventAction:"Click",eventLabel:"",nonInteraction:0,...e})},S=e=>{window.gtmDataObject.push({event:"impression",eventRaisedBy:"Web component",eventAction:"Promo Impression - On Scroll",ecommerce:{},...e})},O=e=>{window.gtmDataObject.push({event:"promoClick",eventRaisedBy:"Web component",ecommerce:{},...e})},A=()=>window[window?.padlNamespace]?.dataLayer,T=()=>{const e=A();return e?e.app.app.market.toLocaleLowerCase():"ch"},P=()=>A()?A().page.page.pageInfo.language.toLocaleLowerCase():"en";class N extends HTMLElement{constructor(){super(),this.props={},this.market=T(),this.language=P()}static get observedAttributes(){return["slot","quantity"]}connectedCallback(){this.props=v(this.attributes),this.boundHandleClick=this.handleClick.bind(this),this.slot=this.innerHTML.replace(/\n*$/,"").trim(),this.render()}render(){const{variation:e,contrast:t,transparent:s="false",size:i="48",icon_right:n="",icon_left:r="",label:a,seo_label:o="",aria_label_before:l,aria_label_after:c,link_new_tab:d=!1,label_update:u,add_to_cart:h=""}=this.props;let{link:p}=this.props;const b=this.slot?this.slot:a,m=document.createElement(p?"a":"button");p&&(p=p.replace("{market}",this.market),p=p.replace("{lang}",this.language),m.setAttribute("href",p)),p&&d&&m.setAttribute("target","_blank"),o&&p&&m.setAttribute("title",o),l&&m.setAttribute("aria-label",l+" "+b),c&&m.setAttribute("aria-label",b+" "+c),l&&c&&m.setAttribute("aria-label",l+" "+b+" "+c),"navigation"!==e&&m.classList.add("button--cta"),m.classList.add(`button--${e}`),t&&("true"===s?m.classList.add(`button--${t}--transparent`):m.classList.add(`button--${t}`)),i&&m.classList.add(`size--${i}`),"primary"!==e&&"tertiary"!==e||""===h||(this.setAttribute("quantity","0"),"small"===h?m.classList.add("addToCart--small"):m.classList.add("addToCart--large")),r&&this.setAttribute("icon_left",r),n&&this.setAttribute("icon_right",n),m.innerHTML=`\n                ${r&&`<nb-icon icon='${r}'></nb-icon>`}\n                <span>${b}</span>\n                ${"primary"===e&&""!==h&&""!==u?`<span class="update">${u}</span>`:""}\n                ${n&&`<nb-icon icon='${n}'></nb-icon>`}\n        `,this.innerHTML=m.outerHTML,this.removeListeners(),this.addListeners()}handleClick(){this.track();const{event_id:e="",popin_id:t="",qs_id:s=""}=this.props;e&&E.fire(e,{}),t&&this.popin(t),s&&this.openQuantitySelector(s)}popin(e){C({eventName:t,args:{id:e}})}openQuantitySelector(e){C({eventName:"WEB_COMPONENT_QS_OPEN",args:{id:e}})}track(){this.props.campaign_id&&this.handlePromoClick(),this.props.tracking_label&&this.handleCustomEvent()}handlePromoClick(){const{campaign_id:e="",campaign_name:t="",campaign_position:s="",campaign_creative:i=""}=this.props;""!==e&&O({ecommerce:{promoClick:{promotions:[{id:e,name:t,position:s,creative:i}]}}})}handleCustomEvent(){const{tracking_label:e=""}=this.props;""!==e&&$({eventAction:"Click CTA",eventLabel:e})}attributeChangedCallback(e){"slot"===e&&this.render(),"quantity"===e&&(this.classList.add("updated"),setTimeout((()=>{this.classList.remove("updated")}),1200))}addListeners(){this.addEventListener("click",this.boundHandleClick)}removeListeners(){this.removeEventListener("click",this.boundHandleClick)}disconnectedCallback(){this.removeListeners()}}customElements.get("nb-cta")||customElements.define("nb-cta",N);class x extends HTMLElement{constructor(){super(),this.slot=this.innerHTML,this.boundHandleClick=this.handleClick.bind(this),this.market=T(),this.language=P()}connectedCallback(){this.props=v(this.attributes),this.render(),this.setClassHelper(),this.bindEvents()}render(){const{size:e="large",color:t="gold",link:s="",icon_right:i="",icon_left:n="",image:r="",image_alt:a=""}=this.props;e&&this.setAttribute("size",e),t&&this.setAttribute("color",t),r&&this.setAttribute("image",r),a&&this.setAttribute("image_alt",a),n&&this.setAttribute("icon_left",n),i&&this.setAttribute("icon_right",i),""===s?this.renderButton():this.renderLink(),this.link=this.firstElementChild}renderLink(){const{label:e,seo_label:t="",tracking_label:s="",link_new_tab:i="false",a11y_label_new_tab:n="",icon_right:r="",image:a="",image_alt:o="",icon_left:l="",selected:c="",phantom:d=""}=this.props;let{link:u}=this.props;const h=this.slot?this.slot:e;u&&(u=u.replace("{market}",this.market),u=u.replace("{lang}",this.language)),this.innerHTML=`\n        <a\n            href="${u}"\n            ${"true"===i?'target="_blank"':""}\n            ${"true"===i&&""!==n?`aria-description='${n}'`:""}\n            ${s&&`tracking_label='${s}'`}\n            ${t?`title="${t}"`:""}\n            ${"true"===c?'aria-selected="true"':""}\n            ${"true"===d?`phantom="${h}"`:""}\n        >\n            ${l&&`<nb-icon icon='${l}'></nb-icon>`}\n            ${a&&`<img src='${a}' alt='${o}'/>`}\n            <span>${h}</span>\n            ${r&&`<nb-icon icon='${r}'></nb-icon>`}\n        </a>`}renderButton(){const{label:e,tracking_label:t="",icon_right:s="",icon_left:i="",selected:n="",image:r="",image_alt:a="",phantom:o=""}=this.props,l=this.slot?this.slot:e;this.innerHTML=`\n        <button\n            ${t&&`tracking_label='${t}'`}\n            ${"true"===n?'aria-selected="true"':""}\n            ${"true"===o?`phantom="${l}"`:""}\n        >\n            ${r&&`<img src='${r}' alt='${a}'/>`}\n            ${i&&`<nb-icon icon='${i}'></nb-icon>`}\n            <span>${l}</span>\n            ${s&&`<nb-icon icon='${s}'></nb-icon>`}\n        </button>`}setClassHelper(){const{size:e="large",cta_link_type:t="false"}=this.props;let s="";switch(e){case"xsmall":s="t-2xs-500";break;case"small":s="t-xs-500-sl";break;case"medium":s="t-sm-400-sl";break;default:s="t-xs-700-caps-sl"}"true"===t&&(s="t-sm-700-caps-sl",this.setAttribute("underline","false")),this.querySelector("a, button").classList.add(s)}handleClick(){this.track();const{popin_id:e=""}=this.props;e&&this.popin(e)}popin(e){C({eventName:t,args:{id:e}})}track(){this.props.campaign_id&&this.handlePromoClick(),this.props.custom_tracking&&this.handleCustomEvent()}handlePromoClick(){const{campaign_id:e="",campaign_name:t="",campaign_position:s="",campaign_creative:i=""}=this.props;""!==e&&O({ecommerce:{promoClick:{promotions:[{id:e,name:t,position:s,creative:i}]}}})}handleCustomEvent(){const{tracking_label:e=""}=this.props;""!==e&&$({eventAction:"Click",eventLabel:e})}bindEvents(){this.unbindEvents(),this.link.addEventListener("click",this.boundHandleClick)}unbindEvents(){this.link.removeEventListener("click",this.boundHandleClick)}disconnectedCallback(){this.unbindEvents()}}customElements.get("nb-link")||customElements.define("nb-link",x);class I{constructor(e,t){this.observer=new IntersectionObserver((e=>this.onChange(e)),{threshold:[0],rootMargin:"0% 0%"}),this.el=e,this.data=t,this.el instanceof Element&&this.observer.observe(this.el)}onChange(e){e.forEach((e=>{e.isIntersecting&&(this.track(e),this.observer.unobserve(e.target))}))}track(){window.requestIdleCallback((()=>this.runTrack()))}runTrack(){this.data.id&&null!==this.data.id&&""!==this.data.id&&S({ecommerce:{promoView:{promotions:[this.data]}}})}}function M(e,t){const s=new B(e,t);return{destroy:()=>{s.getIom().hasIntersectionObserver()||s.destroy()}}}class B extends I{constructor(e,t){super(e),this.data=t}runTrack(){this.data.id&&null!==this.data.id&&""!==this.data.id&&S({ecommerce:{promoView:{promotions:[this.data]}}})}}class D extends HTMLElement{constructor(){super(),this.slot=this.innerHTML}connectedCallback(){this.props=[...this.attributes].reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{}),this.render(),this.initTracking(),this.initLazyLoad()}initTracking(){const{campaign_id:e=null,campaign_name:t=null,campaign_position:s=null,campaign_creative:i=null}=this.props;M(this,{id:e,name:t,position:s,creative:i})}initLazyLoad(){const e=this.querySelector(".cb-bg-img");if(!e)return;const t=this.getBgImgUrl();t&&l(e,"style",`background-image: url(${t}); ${e.getAttribute("style")||""}`,t)}getBgImgUrl(){const{background_mobile:e="",background_tablet:t="",background_desktop:s="",background_retina:i=""}=this.props;return u.is.mobile&&e?e:u.is.tablet&&t?t:u.is.retina&&i?i:s}render(){const{styles:e="",contrast:t,background_color:s="",classname:i="",element_class:n="",slot:r}=this.props;let a="light";"undefined"===t?this.setAttribute("contrast",a):a=t,this.innerHTML=`\n            <section\n                class="${i}"\n                contrast="${a}"\n                style="${e}"\n            >\n                ${s||this.hasBgImage()?this.renderBg():""}\n                <div class="cb-inner ${n}">\n                    ${r}\n                </div>\n            </section>`}hasBgImage(){const{background_mobile:e,background_desktop:t,background_retina:s}=this.props;return!!e||!!t||!!s}renderBg(){const{background_color:e=""}=this.props;return`<div class="cb-bg-color ${e?`${e}`:""}">\n        </div>${this.hasBgImage()?'<div class="cb-bg-img"></div>':""}`}}customElements.get("nb-container")||customElements.define("nb-container",D);const F=["upvote","19-bar","24-7-service","360-view","accessories-and-sweets","address-2","address","amex-card","android","apple-pay-card","apple-pay","apple","arrow-bottom","arrow-filled-down","arrow-left","arrow-right","arrow-top","assistance-alt","assistance-videos","assistance","boutique","brand_coffee_capsule-vl-carafe","brand_coffee_capsule-vl-double-espresso-gran-lungo","brand_coffee_capsule-vl-espresso","brand_coffee_capsule-vl-mug","brand_coffee_capsule_ol","brand_coffee_capsule_pro","brand_coffee_capsule_vl","brand_coffee_cereals","brand_coffee_citrus","brand_coffee_cocoa","brand_coffee_coffee-assortment","brand_coffee_coffee-discovery-set","brand_coffee_machines","brand_coffee_malted","brand_coffee_notes-herbal","brand_delivery_boutique-location","brand_delivery_delivery","brand_delivery_free_delivery","brand_delivery_package","brand_delivery_schedule_delivery","brand_general_coffee","brand_machines_auto_clean_system","brand_machines_automatic_off","brand_machines_digital_display","brand_machines_energy_class","brand_machines_fast_heat_up","brand_machines_low_water_alert","brand_machines_milk_frothing","brand_machines_pump_pressure_bar","brand_payment_credit_card","brand_payment_gift_card","brand_payment_invoice","brand_payment_secure","brand_services_assistance","brand_services_boutique","brand_services_easy_order","brand_services_help","brand_services_promotions","brand_services_recycling","brand_services_recycling_ol","brand_services_recycling_vl","brand_services_subscription","brand_services_sustainability","calendar","capsule-cupSize-Cappuccino-And-Latte-Macchiato","capsule-cupSize-Cortado-Cappuccino","capsule-cupSize-icedRecipe-vertuo","capsule-cupSize-icedRecipe","capsule-cupSize-alto","capsule-cupSize-carafe-vertuo","capsule-cupSize-coffee","capsule-cupSize-double-espresso-vertuo","capsule-cupSize-espresso-vertuo","capsule-cupSize-espresso","capsule-cupSize-gran-lungo","capsule-cupSize-lungo","capsule-cupSize-mug","capsule-cupSize-ristretto","capsule-cupSize-americano","capsule-cupSize-large-americano","check","chevron-down","chevron-left","chevron-right","chevron-up","check-mark","clock","close-2","close","coffee","coffee_capsule-ol_24","credit-card-flag","credit-card","delivery-fast","delivery-scheduled","delivery-standard","eco-mode","edit","error","espresso-vertuo-capsule","eye-closed","eye-opened","facebook","filter","find-us-alt","find-us","free-return","gift-card","globe","gran-lungo-vertuo-capsule","help","hero-chat","huawei","information-24","information","instagram","invoice","language","linkedin","link","live-chat","loading-nitro","loading","loan","logout","machine_machines_ol_24","machines-2","machines","mail","mastercard-card","mastercard","menu","minus-16","minus-24","minus-o","modal-alert","modal-check","more-info","nespresso-logo","nespresso-monogram","nespresso-professional-2","nespresso-professional","nespresso","notification","orders","original","package-box","payment-bcorp","payment-bvr","payment-google-pay","payment-ideal","payment-klarna","payment-lsv","payment-postfinance","payment-twint","paypal-card","paypal","phone","pin","pinterest","play-button","play-mini","play","plus-16","plus-24","plus-o","promotions","recycling-point","recycling","remove","search","secure","set-up","shopping-bag","signal-high","signal-low","signal-med","speed","star","rating","subscription-2","subscription","sustainability","tag","twitter","ui_payment_cash","ui_coffee_bergamot","ui_coffee_capsule-ol","ui_coffee_capsule-vl-carafe","ui_coffee_capsule-vl-double-espresso_gran-lungo","ui_coffee_capsule-vl-espresso","ui_coffee_capsule-vl-mug","ui_coffee_capsule-vl","ui_coffee_capsule_professional","ui_coffee_cardamom","ui_coffee_cocoa","ui_coffee_hazelnut","ui_coffee_honey","ui_coffee_notes-cereal","ui_coffee_notes-malted","ui_coffee_winey","ui_delivery_calendar","ui_delivery_clock","ui_general_alerts","ui_general_arrow-right","ui_general_check","ui_general_chevron-bottom","ui_general_chevron-left","ui_general_chevron-right","ui_general_chevron-top","ui_general_credit-card","ui_general_edit","ui_general_error","ui_general_eye-close","ui_general_eye-open","ui_general_faq","ui_general_filter","ui_general_gift-card","ui_general_globe","ui_general_information","ui_general_language","ui_general_link","ui_general_loading","ui_general_log-out","ui_general_map_view","ui_general_menu","ui_general_minus","ui_general_notification","ui_general_order","ui_general_play","ui_general_plus","ui_general_promotions","ui_general_remove","ui_general_search","ui_general_secure","ui_general_shopping-bag","ui_general_tag","ui_general_user-account","ui_general_warranty","ui_general_wifi","ui_general_x","ui_map_directions","ui_payment_invoice","ui_services_assistance","ui_services_delivery","ui_services_easy_order","ui_services_find-us","ui_services_free-return","ui_services_mail","ui_services_phone","ui_services_subscription","ui_sustainability_climate","ui_sustainability_recycling","ui_sustainability_recycling_ol","ui_sustainability_recycling_vl","ui_sustainability_social_sustainability","ui_user_member_status","ui_user_my-address","ui_user_my_information","ultra-compact","user-account","versatil-coffee-system","video-play","vertuo","visa-card","visa","warranty","youtube","services-anticipation-of-maintenance","services-assistance","services-avant-premiere","services-avant-premiere-ol","services-avant-premiere-vl","services-coffee-assortment","services-coffee-coffee-sample","services-coffee-discovery-set","services-coffee-experiences","services-contact-chat","services-contact-community-forum","services-contact-mobile","services-contact-sms","services-contact-video-assistance","services-contact-virtual","services-data-insight","services-delivery-boutique-location","services-delivery-boutique-pick-up","services-delivery-delivery","services-delivery-delivery-bike","services-delivery-delivery-fast","services-delivery-free-delivery","services-delivery-next-day-delivery","services-delivery-package","services-delivery-pick-up-points","services-delivery-schedule-delivery","services-easy-maintenance","services-easy-order","services-easy-stock-management","services-generic","services-gifting-card","services-help","services-orders","services-payments-credit-card","services-payments-gift-card","services-payments-invoice","services-phone","services-reorder","services-satisfied-or-reimbursed","services-services-boutique","services-subscription","services-vip-masterclass","services-voice-enabled","payments-cash","delivery-same-day-delivery","contact-voice-assistant-chatbot","contact-video-chat","contact-mobile-push-notification","contact-chat-bot","coffee-coffee-tasting","contact-video-assistance","filter-style_step-01","filter-style_step-02","filter-style_step-03","filter-style_step-04"].concat(["notes-almonds","notes-balanced","notes-bergamot","notes-berry","notes-biscuity","notes-blueberry","notes-cardamom","notes-cereal","notes-citrus","notes-cocoa","notes-default","notes-flowery","notes-fruity","notes-hazelnut","notes-herbal","notes-honey","notes-leather","notes-malted","notes-roasted","notes-spicy","notes-sugar","notes-winey","notes-wood","notes-brand-coffee-roasted","notes-brand-coffee-caramel","notes-brand-coffee-intense-roasted"]).concat(["machine_technology_machine-ol","machine_technology_machine-vl","machine_details_deluxe-version","machine_details_machine-tutorial-ol","machine_details_machine-tutorial-vl","machine_warranty_warranty-ol","machine_warranty_warranty-vl","machine_features_generic","machine_features_auto-clean-system","machine_features_automatic-off","machine_features_blend-specific-brewing","machine_features_bluetooth","machine_features_capsule-ejection-ol","machine_features_capsule-ejection-vl","machine_features_centrifusion","machine_features_cold-foam-ol","machine_features_cold-foam-vl","machine_features_descale-alert","machine_features_descale","machine_features_digital-display","machine_features_dimensions","machine_features_eco-mode","machine_features_energy-class","machine_features_fast-heat-up","machine_features_hot-foam-ol","machine_features_hot-foam-vl","machine_features_hot-milk","machine_features_hot-foam","machine_features_hot-water","machine_features_low-water-alert","machine_features_manual-lever","machine_features_milk-frothing","machine_features_mobile-push-notification","machine_features_one-touch","machine_features_power-off","machine_features_pump-pressure-bar","machine_features_rinse","machine_features_settings","machine_features_steam","machine_features_temperature-settings-invert","machine_features_temperature-settings","machine_features_temperature","machine_features_ultra-compact","machine_features_water-tank","machine_features_weight"]),H=window.memoPromiseCache?window.memoPromiseCache:{};class q{constructor(e){this.getPromise=e,this.request=this.request.bind(this)}request({uniqueKey:e,url:t}){if(!e)return Promise.reject(new Error("Unique key not passed"));if(!H[e]){const s=this.getPromise(t);H[e]=s.then((e=>e.text())).catch((t=>{throw delete H[e],t}))}return H[e]}}class R extends HTMLElement{constructor(){super(),this.props={},this.path="",this.source=""}connectedCallback(){this.props=v(this.attributes),this.classList.add("lazy-load"),this.classList.add("nb-svg"),this.beforeRender(),this.render()}beforeRender(){}render(){if(""===this.source)return void console.error(`Error: Component SVG - render - 'source' property is not set:${this.source}`);this.innerHTML="<svg></svg>",this.afterHtmlRender();const e=this;!function(e,t){if(/Trident\/|MSIE/.test(window.navigator.userAgent)||(s=window.navigator.userAgent,i=s.indexOf("OS "),(s.indexOf("iPhone")>-1||s.indexOf("iPad")>-1)&&i>-1&&window.Number(s.substr(i+3,3).replace("_","."))<14))t();else if("IntersectionObserver"in window){let s=new IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting&&(t(),s.unobserve(e.target))}))}),{above:[0],rootMargin:"150% 0px"});s.observe(e)}var s,i}(e,(()=>{e.fetchSVG(this.source,`${this.path}${this.source}.svg`)}))}afterHtmlRender(){}request(e){return fetch(e)}async fetchSVG(e,t){const s=this.firstElementChild,i=new q(this.request),{request:n}=i;let r=await n({uniqueKey:e,url:t});let a=(new DOMParser).parseFromString(r,"image/svg+xml").getElementsByTagName("svg");if(!a.length)return console.error(`Error: Component SVG - fetchSVG - SVG not found ${a}`),this.classList.remove("lazy-load"),void this.classList.add("lazy-loaded-error");this.classList.remove("lazy-load"),this.classList.add("lazy-loaded"),a=a[0];const o=a.attributes,l=o.length;for(let e=0;e<l;++e)if(o[e].specified)if("class"===o[e].name){const t=o[e].value.replace(/\s+/g," ").trim().split(" "),i=t.length;for(let e=0;e<i;++e)s.classList.add(t[e])}else s.setAttribute(o[e].name,o[e].value);for(;a.childNodes.length;)s.appendChild(a.childNodes[0])}}customElements.get("nb-svg")||customElements.define("nb-svg",R);customElements.get("nb-icon")||customElements.define("nb-icon",class extends R{beforeRender(){const{icon:e}=this.props;-1!==F.indexOf(e)?(this.classList.add("nb-icon"),this.path="/shared_res/agility/next-components/assets/icons/",this.source=e):console.error(`Error: Component Icon - beforeRender - 'icon' is not part of the authorized list - Icon name:${e}`)}afterHtmlRender(){this.setAttribute("aria-hidden","true")}});class z extends HTMLElement{constructor(){super(),this.slot=this.innerHTML,this.checkbox=null}static get observedAttributes(){return["disabled","checked"]}connectedCallback(){this.props=v(this.attributes),this.render()}render(){const{content:e,icon:t="",color:s="",background_image:i="",filter_label_AA:n="filter",rounded:r="true",checked:a="false",disabled:o="false"}=this.props,l=this.slot?this.slot:e;const c="true"===a?"checked":"",d="true"===o?"disabled":"";this.innerHTML=`\n            <input type='checkbox' name='options' aria-label="${l+" "+n}" ${c} ${d}>\n            <label style=''>\n                ${t&&`<nb-icon icon='${t}'></nb-icon>\n                `}\n                ${s&&`<div class='chip-color' style='background:${s}'></div>\n                `}\n                ${i&&`<div class='chip-image ${"true"===r?"rounded":""}' style='background-image:url("${i}")'></div>\n                `}\n                <span aria-hidden="true" phantom="${l}">${l}</span>\n            </label>\n        `,this.querySelector("label").addEventListener("click",(e=>{e.preventDefault(),this.querySelector("input").click()})),this.checkbox=this.getElementsByTagName("input")[0]}attributeChangedCallback(e,t,s){this.checkbox&&("disabled"===e?this.checkbox.disabled="true"===s:"checked"===e&&(this.checkbox.checked="true"===s))}disconnectedCallback(){this.querySelector("label").removeEventListener("click",(e=>{e.preventDefault(),this.querySelector("input").click()}))}}function V(e,t){const s=e.parentNode;if(s===document.getElementsByTagName("body")[0])return;const i=s.children;for(const s of i)s!==e&&(t?s.setAttribute("aria-hidden",t):s.removeAttribute("aria-hidden"));V(s,t)}function W(e,t,s){t.contains(e.target)?t.lastFocused=e.target:t.lastFocused===t.firstFocusable?s?t.lastFocusable.focus():t.firstFocusable.focus():s?t.firstFocusable.focus():t.lastFocusable.focus()}function j(e){const t=e.querySelectorAll('button, [href], input, select, textarea, [tabindex="0"]');e.firstFocusable=t[0],e.lastFocusable=t[t.length-1],e.lastFocused=e.firstFocusable}customElements.get("nb-chip")||customElements.define("nb-chip",z);class G extends HTMLElement{constructor(){super(),this.isOpen=!1,this.selected=null,this.buttonElement=null,this.onClickOutside=this.onClickOutside.bind(this)}connectedCallback(){this.props=v(this.attributes),this.render()}render(){this.buttonElement=null;const{label:e="",aa_description:t}=this.props;let{options:s}=this.props;s=s.map((e=>{const t={...e};return t.checked=t.checked||t.selected,t})),this.unbindEvent(),this.innerHTML=`\n            <button\n                class='nb-dropdown__button'\n                aria-haspopup="listbox"\n                aria-expanded="${this.isOpen}"\n                aria-label="${e} ${s&&this.renderSelected()}"\n                ${""!==t?`aria-description="${t}"`:""}>\n                    <span class="nb-dropdown__button__label t-xs-700-caps-sl">${e}</span>\n                    <span class="nb-dropdown__button__value t-xs-500-sl" value="${s&&this.renderSelected()}">\n                    </span>\n                </button>\n            <div class="nb-dropdown__menu">\n                <div role="listbox">\n                    ${s&&s.length>0&&this.renderOptions()}\n                </div>\n            </div>\n        `,this.buttonElement=this.querySelector(".nb-dropdown__button"),this.buttonElementValue=this.querySelector(".nb-dropdown__button__value"),this.dropdownMenu=this.querySelector(".nb-dropdown__menu > div"),this.selectedOption=this.querySelector("button[aria-selected=true]"),this.selected||(this.selected=s[0]),j(this.dropdownMenu),this.bindEvent()}renderOptions(){const{label:e,aa_listbox_description:t,aa_select_description:s,icon_option:i,options:n}=this.props;return n.map((n=>`<button\n                    class="${u.is.mobile?"t-sm-400-sl":"t-xs-500-sl"}"\n                    role="option"\n                    aria-label='${e+" "+n.label}'\n                    value='${n.label}'\n                    aria-selected='${n.checked}'\n                    ${n.link&&`data-link='${n.link}'`}\n                    ${n.checked?void 0!==t&&`aria-description="${t}"`:void 0!==s&&`aria-description="${s}"`}>\n                  ${i&&`<nb-icon icon='${i}'></nb-icon>`} ${n.label}\n                </button>`)).join("")}renderSelected(){const e=this.props.options.find((e=>!0===e.checked||!0===e.selected));return`${e&&e.label||this.props.options[0].label}`}bindEvent(){this.boundHandleClick=this.handleClick.bind(this),this.boundHandleLabelClick=this.handleLabelClick.bind(this),this.boundHandleMobileClose=this.handleMobileClose.bind(this),this.boundFocus=this.focus.bind(this),this.boundFocusin=this.focusin.bind(this),this.boundKeyNav=this.keyNav.bind(this),this.buttonElement.addEventListener("click",this.boundHandleClick),this.querySelectorAll(".nb-dropdown__menu button").forEach((e=>{e.addEventListener("click",this.boundHandleLabelClick)})),this.dropdownMenu.addEventListener("click",this.boundHandleMobileClose),window.addEventListener("click",this.onClickOutside)}unbindEvent(){this.buttonElement&&(this.buttonElement.removeEventListener("click",this.boundHandleClick),this.querySelectorAll(".nb-dropdown__menu button").forEach((e=>{e.removeEventListener("click",this.boundHandleLabelClick)})),this.dropdownMenu.removeEventListener("click",this.boundHandleMobileClose),window.removeEventListener("click",this.onClickOutside),document.removeEventListener("keydown",this.boundKeyNav))}handleClick(){this.toogleDropdown(!this.isOpen)}handleMobileClose(){this.toogleDropdown(!1)}onClickOutside(e){!this.isOpen||e.target.classList.contains("nb-dropdown__button")||e.target.classList.contains("nb-dropdown__button__label")||e.target.classList.contains("nb-dropdown__button__value")||this.toogleDropdown(!1)}handleLabelClick(e){this.isOpen=!1,this.selectedOption.setAttribute("aria-selected","false"),this.selectedOption=e.target,this.selectedOption.setAttribute("aria-selected","true"),this.props.options=this.props.options.map((e=>({...e,checked:!1}))),this.selected=this.props.options.find((e=>e.label===this.selectedOption.value)),this.selected.checked=!0,this.reRender(),C({eventName:"WEB_COMPONENT_SORT_BY_CHANGE",args:{options:this.props.options,selected:this.selected},element:this})}reRender(){const{label:e,aa_listbox_description:t,aa_select_description:s}=this.props;this.buttonElementValue.setAttribute("value",this.selectedOption.value),this.buttonElement.setAttribute("aria-label",e+" "+this.renderSelected()),this.dropdownMenu.querySelectorAll("button").forEach((e=>{e.setAttribute("aria-description",s)})),this.selectedOption.setAttribute("aria-description",t)}setSelected(e,t=!1){const s=this.props.options.find((t=>t.value===e));s&&(this.selected.checked=!1,this.selected=s,this.selected.checked=!0),t&&C({eventName:"WEB_COMPONENT_SORT_BY_CHANGE",args:{options:this.props.options,selected:this.selected},element:this})}toogleDropdown(e){e?this.open():this.close(),this.isOpen=!this.isOpen,this.switchAriaModal(),this.buttonElement.setAttribute("aria-expanded",this.isOpen)}switchAriaModal(){this.dropdownMenu.setAttribute("aria-modal",this.isOpen),V(this.dropdownMenu,this.isOpen)}open(){this.dropdownMenu.addEventListener("transitionend",this.boundFocus),document.addEventListener("focusin",this.boundFocusin),document.addEventListener("keydown",this.boundKeyNav),this.buttonElement.classList.add("isOpen"),this.openingSource=document.activeElement}close(){this.dropdownMenu.addEventListener("transitionend",this.boundFocus),document.removeEventListener("focusin",this.boundFocusin),document.removeEventListener("keydown",this.boundKeyNav),this.buttonElement.classList.remove("isOpen"),this.buttonElement.setAttribute("aria-expanded",!1)}focus(){this.dropdownMenu.removeEventListener("transitionend",this.boundFocus),this.isOpen?(this.selectedOption.focus(),this.dropdownMenu.lastFocused=this.selectedOption):this.buttonElement.focus()}focusin(e){W(e,this.dropdownMenu,!1)}keyNav(e){switch(e.key){case"Escape":this.toogleDropdown(!1);break;case"ArrowUp":e.preventDefault(),this.prevOption();break;case"ArrowDown":e.preventDefault(),this.nextOption();break;case"Home":case"PageUp":e.preventDefault(),this.firstOption();break;case"End":case"PageDown":e.preventDefault(),this.lastOption()}}prevOption(){if(this.dropdownMenu.lastFocused!==this.dropdownMenu.firstFocusable){const e=this.dropdownMenu.lastFocused.previousElementSibling;e.focus(),this.dropdownMenu.lastFocused=e}}nextOption(){if(this.dropdownMenu.lastFocused!==this.dropdownMenu.lastFocusable){const e=this.dropdownMenu.lastFocused.nextElementSibling;e.focus(),this.dropdownMenu.lastFocused=e}}firstOption(){this.dropdownMenu.lastFocused!==this.dropdownMenu.firstFocusable&&(this.dropdownMenu.firstFocusable.focus(),this.dropdownMenu.lastFocused=this.dropdownMenu.firstFocusable)}lastOption(){this.dropdownMenu.lastFocused!==this.dropdownMenu.lastFocusable&&(this.dropdownMenu.lastFocusable.focus(),this.dropdownMenu.lastFocused=this.dropdownMenu.lastFocusable)}disconnectedCallback(){this.unbindEvent()}}customElements.get("nb-dropdown")||customElements.define("nb-dropdown",G);class U extends I{constructor(e,t,s,i,n){super(e),this.data=t,this.currency=s,this.range=i,this.position=n}async runTrack(){if(!this.data)return;const e=await this.getCategories(this.data);window.impressionsOnScroll=window.impressionsOnScroll||{},window.impressionsOnScroll[this.data.internationalId]=this.buildGTMProductObject(this.data,e)}async getPLPCategory(e){return(await window.getPLPData()).data.configuration.eCommerceData.categories.find((t=>t.id===e))}async getCategoriesWithPlpData(e){const t="/machineTechno/",s=[...e.cupSizes,...e.flavors,...e.ranges,...e.technologies];return(await Promise.all(s.map((async e=>{const s=await this.getPLPCategory(e);return!s&&(e=>-1!==e.indexOf(t))(e)?(e=>e.substr(e.indexOf(t)+t.length))(e):s.name})))).join("|")}async getCategories(e){return e?window.getPLPData?this.getCategoriesWithPlpData(e):Promise.all(e.supercategories.map((e=>window.napi.catalog().getCategory(e)))).then((e=>{const t=[];for(const s of e){const e=s.code;if(!e)return;(~e.indexOf("-cupSize-")||~e.indexOf("-range-")||~e.indexOf("capsule-aromatic-")||~e.indexOf("machine-keyFeature-")||~e.indexOf("machine-color-")||~e.indexOf("accessory-collection-")||~e.indexOf("accessory-hero-month"))&&t.push(s.name.toLowerCase())}return t.join("|")})):""}buildGTMProductObject(e,t){let s;"capsule"===e.type?s="capsules":"accessory"===e.type?s="accessories":"machine"===e.type&&(s="machines");let i=null;e.technologies&&(i=e.technologies.map((e=>function(e=""){return e[0].toUpperCase()+e.slice(1)}(e.split("/")[2]))).join("|||"));let n="";null!=e.productSelections&&(n=e.productSelections.join("|"));const r={brand:"Nespresso",category:s,dimension43:"false",dimension44:"false",dimension53:e.legacyId,dimension54:o(e.name)[0].textContent,dimension55:t,dimension56:i,dimension57:this.isBundled(e)?"bundled":"single",dimension130:n,id:e.internationalId,name:o(e.internationalName)[0].textContent,price:e.price};return this.range&&(r.list=this.range),this.position&&(r.position=parseInt(this.position)),r}isBundled(e){let t=1===e.salesMultiple&&e.unitQuantity>1;return e.bundled?t=e.bundled:e.salesMultiple>1&&1===e.unitQuantity&&(t=!1),t}}class K extends HTMLElement{connectedCallback(){this.sku=(this.getAttribute("sku")||"").trim(),this.range=this.getAttribute("range"),this.position=this.getAttribute("position"),this.longSku=(this.getAttribute("longSku")||"").trim(),this.buttonSize=this.getAttribute("buttonSize")||"small",this.rendererName=this.getAttribute("rendererName")||"default",this.elementID=`u-product-${""!==this.range?this.range.replace(/(\s|\W)/g,"")+"-":""}${this.position}-${this.sku}-${this.longSku.replace(/(\s|\W)/g,"")}-${this.rendererName}`,this.render(),this.isWindowNapiActive()&&(window.napi.getConfig().then((()=>{this.pushButton()})).catch((e=>console.error(e))),this.tracking().then((()=>{})).catch((e=>console.error(e))))}render(){this.innerHTML=`<div class="cb-AddToCart" id="${this.elementID}">\n                <button class='AddToBagButtonLarge'>\n                    <span class='AddToBagButtonLarge__label'>+</span>\n                </button>\n            </div>`}isWindowNapiActive(){return!!window.napi}pushButton(){if(!document.getElementById(this.elementID))return;const e=this.buttonSize;window.ui=window.ui||[],window.ui.push({id:this.elementID,module:"AddToBagButton",configuration:{props:{productId:this.longSku,buttonSize:e}},ecommerceData:{activated:!0}})}async tracking(){if(!this.isWindowNapiActive())return new Promise.resolve;!function(e,t,s,i,n){const r=new U(e,t,s,i,n)}(this,await this.getProductData(),window[window.config.padl.namespace].dataLayer.app.app.currency,this.range,this.position)}getSkuKey(e){return-1!==e.indexOf("prod/")?"id":"legacyId"}async getProductData(){if(null!=window.getPLPData){const e=this.getSkuKey(this.sku),t=await window.getPLPData(),s=[e,"internationalId","id","legacyId"];let i=0,n=null;for(;!n&&i<s.length-1;){const e=s[i];n=t.data.configuration.eCommerceData.products.find((t=>t[e]===this.sku)),i++}return n}if(this.isWindowNapiActive())return await window.napi.catalog().getProduct(this.longSku);console.error("Error: napi is not found.")}}customElements.get("nb-add-to-cart")||customElements.define("nb-add-to-cart",K);const Y=e=>[...e.querySelectorAll("[data-ref]")].reduce(Q,{}),Q=(e,t)=>{const{ref:s}=t.dataset,i=s.match(/(\w+)\[(.+)\]/);return null!==i?J(e,t,i):{...e,[t.dataset.ref]:t}},J=(e,t,[,s,i])=>(void 0===e[s]&&(e[s]=[]),e[s][i]=t,e);class X extends HTMLElement{constructor(){super(),this.baseClass="nb-bubble",this.boundOnSelected=this.onSelected.bind(this)}static get observedAttributes(){return["state"]}attributeChangedCallback(e){"state"===e&&this.updateState()}connectedCallback(){this.props=v(this.attributes),this.classes=this.createClasses(),this.render(),this.refs=Y(this),this.bindEvent(),this.initLazyLoad()}initLazyLoad(){let{visual:{src:e="",src_retina:t=""}={}}=this.props;const{visual:s}=this.refs;u.is.retina&&t&&(e=t),s&&e&&l(s,"src",`${e}`,e)}createClasses(){const{state:e="default"}=this.props;return{base:`${this.baseClass} ${this.baseClass}--${e}`,label:this.getLabelClassName(),theme:`${this.baseClass}__theme`,visual:`${this.baseClass}__visual `,avatar:`${this.baseClass}__avatar`,outline:`${this.baseClass}__outline`}}getLabelClassName(){const{state:e="default"}=this.props,t=["selected","focus"].includes(e);return[`${this.baseClass}__label`,t?"t-xs-700-sl":"t-xs-500-sl"].join(" ")}render(){this.innerHTML=`\n            <div data-ref="button" class='${this.classes.base}'>\n                <div class='${this.classes.avatar}'>\n                    <div class='${this.classes.outline}'></div>\n                    ${this.renderBackground()}\n                    ${this.renderVisual()}\n                </div>\n                ${this.renderLabel()}\n            </div>\n        `}renderBackground(){const{theme:e="#e1dad0"}=this.props;return`\n            <div\n                class='${this.classes.theme}'\n                style='background-color: ${e};'\n            ></div>\n        `}renderVisual(){const{visual:{alt:e="",src:t=""}={}}=this.props;return`${t&&`<img class="${this.classes.visual}" src="" alt="${e}" data-ref="visual"/>`}`}renderLabel(){const{label:e}=this.props;return`${e&&`<div class="${this.classes.label}" data-ref="label">${e}</div>`}`}updateState(){if(this.refs){const{button:e,label:t}=this.refs;e.className="",t.className="",this.props=v(this.attributes),this.classes=this.createClasses(),e.className=this.classes.base,t.className=this.classes.label}}bindEvent(){window.addEventListener("EVENT_BUBBLE_SELECTED",this.boundOnSelected)}unbindEvent(){window.removeEventListener("EVENT_BUBBLE_SELECTED",this.boundOnSelected)}onSelected(e){const t=L(e),{bubble:s}=t;this.setAttribute("state",s===this?"selected":"default")}disconnectedCallback(){this.unbindEvent()}}customElements.get("nb-bubble")||customElements.define("nb-bubble",X);class Z extends HTMLElement{constructor(){super(),this.boundGetChips=this.getChips.bind(this)}connectedCallback(){this.props=v(this.attributes),this.render(),this.addEventListener(n,this.boundGetChips),this.querySelectorAll(".nb-dropdown__menu button").forEach((e=>{e.addEventListener("click",this.clickChip)}))}render(){const{navigation:e=[],navigation_bubbles:t=""}=this.props;this.classList.add("nb-plp-sticky-bar"),this.innerHTML=`<div class="nb-plp-sticky-bar--inner">\n                ${this.renderLinksSelect(e)}\n                ${this.renderBubblesSlide(t)}\n            </div>`}renderLinksSelect(e){if(u.is.mobile||!e||e.length<=1)return"";const t=e.map((e=>(e.checked=e.selected,e)));return`<div class="nb-plp-sticky-bar--dropdown">\n            <nb-dropdown\n                data='${c({icon_option:"check",options:t})}'\n            ></nb-dropdown>\n        </div>`}renderBubblesSlide(e){const{a11y_slider_previous_button:t="",a11y_slider_next_button:s=""}=this.props;return`<nb-navigation-bubbles\n                a11y_slider_previous_button="${t}"\n                a11y_slider_next_button="${s}"\n                sticky='true' data='${e}'></nb-navigation-bubbles>`}getChips(){this.querySelectorAll("nb-chip").forEach((e=>{e.addEventListener("click",this.clickChip)}))}clickChip(e){e.preventDefault();const t=e.currentTarget.getAttribute("data-link");t&&(window.location.href=t)}disconnectedCallback(){this.removeEventListener(n,this.boundGetChips),this.querySelectorAll("nb-chip").forEach((e=>{e.removeEventListener("click",this.clickChip)})),this.querySelectorAll(".nb-dropdown__menu button").forEach((e=>{e.removeEventListener("click",this.clickChip)}))}}customElements.get("nb-plp-sticky-bar")||customElements.define("nb-plp-sticky-bar",Z);
/*!
 * swiped-events.js - v@version@
 * Pure JavaScript swipe events
 * https://github.com/john-doherty/swiped-events
 * @inspiration https://stackoverflow.com/questions/16348031/disable-scrolling-when-touch-moving-certain-element
 * @author John Doherty <www.johndoherty.info>
 * @license MIT
 */
const ee=(e,t,s)=>{if(e.nwcSwipeEvents)return;e.nwcSwipeEvents=!0,t.addEventListener("touchstart",(function(e){if("true"===e.target.getAttribute("data-swipe-ignore"))return;l=e.target,function(e){if(void 0===s||!s.contains(e))return;c=[],d=[];for(;e!==s;)c.push(e.scrollTop),d.push(e.scrollLeft),e=e.parentNode}(l),o=Date.now(),i=e.touches[0].clientX,n=e.touches[0].clientY,r=0,a=0}),!1),t.addEventListener("touchmove",(function(e){if(!i||!n)return;let t=e.touches[0].clientX,s=e.touches[0].clientY;r=i-t,a=n-s}),!1),t.addEventListener("touchend",(function(t){if(l!==t.target)return;const s=.25*e.innerHeight,c=.5*e.innerWidth;let d=parseInt(p(l,"data-swipe-threshold",s),10),h=parseInt(p(l,"data-swipe-threshold",c),10),b=parseInt(p(l,"data-swipe-timeout","500"),10),m=Date.now()-o,g="",_=t.changedTouches||t.touches||[];Math.abs(r)>Math.abs(a)?Math.abs(r)>h&&m<b&&(r>0?u("left",t)&&(g="swiped-left"):u("right",t)&&(g="swiped-right")):Math.abs(a)>d&&m<b&&(a>0?u("up",t)&&(g="swiped-up"):u("down",t)&&(g="swiped-down"));if(""!==g){let e={dir:g.replace(/swiped-/,""),touchType:(_[0]||{}).touchType||"direct",xStart:parseInt(i,10),xEnd:parseInt((_[0]||{}).clientX||-1,10),yStart:parseInt(n,10),yEnd:parseInt((_[0]||{}).clientY||-1,10)};l.dispatchEvent(new CustomEvent("swiped",{bubbles:!0,cancelable:!0,detail:e})),l.dispatchEvent(new CustomEvent(g,{bubbles:!0,cancelable:!0,detail:e}))}i=null,n=null,o=null}),!1);let i=null,n=null,r=null,a=null,o=null,l=null,c=[],d=[];function u(e,t){if(void 0===s)return!0;let i=t.target,n=!0,r=0;for(;i!==s&&n;){if(h(i))switch(e){case"up":n=c[r]===i.scrollHeight-i.clientHeight;break;case"down":n=0===c[r];break;case"left":n=d[r]===i.scrollWidth-i.clientWidth;break;case"right":n=0===d[r];break;default:n=!0}i=i.parentNode,r++}return n}function h(e){return e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth}function p(e,s,i){for(;e&&e!==t.documentElement;){let t=e.getAttribute(s);if(t)return t;e=e.parentNode}return i}};var te=e=>{const t=document.createElement("DIV");t.classList.add("nb-overlay"),t.addEventListener("click",(()=>{C({eventName:"WEB_COMPONENT_POPIN_CLOSE",args:{id:e}})})),document.body.appendChild(t),setTimeout((()=>{t.classList.add("fadein")}),1)},se=()=>{if(!document.getElementsByClassName("nb-overlay").length)return;const e=document.getElementsByClassName("nb-overlay")[0];e.classList.remove("fadein"),setTimeout((()=>{e.remove()}),1200)};class ie extends HTMLElement{constructor(){super(),this.props={},this.ariaModal=null,this.isVideo=null,this.boundOpen=this.open.bind(this),this.boundClose=this.close.bind(this),this.boundEscapeClose=this.escapeClose.bind(this),this.boundFocus=this.focus.bind(this),this.boundFocusin=this.focusin.bind(this)}connectedCallback(){this.style.display="none",this.props=v(this.attributes),this.content||this.slot||(this.slot=this.innerHTML),this.id||null==this.props.popin_id||""==this.props.popin_id||(this.id=this.props.popin_id),this.ariaModal=!1,this.isVideo=!1,this.render()}attributeChangedCallback(e,t,s){this.props=v(this.attributes),"content"===e&&(this.props.content=s)}static get observedAttributes(){return["content"]}disconnectedCallback(){this.hasEvent&&this.unbindEvent()}render(){this.hasEvent&&this.unbindEvent();const{heading:e="",bgcolor:t="highlight",size:s="M",label_close:i="Close",image:n="",image_alt:r="",content:a=""}=this.props,o=a||this.slot;if(""===o)return this.bindEvent(),this.classList.remove("isOpen"),this.isOpen=!1,!1;this.checkIsVideo(o),this.isVideo?this.setAttribute("size","L"):this.setAttribute("size",s),this.setAttribute("role","dialog"),this.setAttribute("aria-hidden","true"),this.setAttribute("bgcolor",t),this.innerHTML=`\n            <nb-cta\n                variation="navigation"\n                ${"white"===t?'contrast="highlight"':'contrast="light"'}\n                icon_right="close-2"\n                label="${i}"></nb-cta>\n            <div class="wrapper">\n                <div class="title">\n                    ${e&&`<h2 class="h-lg-700-caps-sl">${e}</h2>`}\n                </div>\n                <div class="content" tabindex="-1">\n                    ${n&&`<div class="popin-header-img"><img loading="lazy" src="${n}" alt="${r}" title="${r}" width="300" height="225" /></div>`}\n                    ${o}\n                </div>\n                ${this.renderFooter()}\n            </div>\n            ${this.isVideo&&u.is.mobile?'<div class="swipeOverlay"></div>':""}\n        `,setTimeout((()=>{this.style.display="inherit"}),100),j(this),this.buttonElement=this.querySelector("button"),this.bindEvent()}renderFooter(){const{footer:e}=this.props;var t;return!(!(t=e)||"false"===t)?"<footer></footer>":""}checkIsVideo(e){const t=document.createElement("div");t.innerHTML=e,1===t.children.length&&"NB-VIDEO"===t.children[0].tagName&&(this.isVideo=!0,this.setAttribute("video","true"))}addLock(){document.getElementsByTagName("html")[0].classList.add("scroll-lock"),te(this.props.popin_id)}removeLock(){this.parentNode.closest("nb-popin")||document.getElementsByTagName("html")[0].classList.remove("scroll-lock"),se()}switchAriaModal(){this.ariaModal=!this.ariaModal,this.setAttribute("aria-modal",this.ariaModal),V(this,this.ariaModal)}async open(e){this.addEventListener("transitionend",this.boundFocus),document.addEventListener("focusin",this.boundFocusin),this.openingSource=document.activeElement;const t=L(e);t.id===this.id?(this.addLock(),this.switchAriaModal(),this.setAttribute("aria-hidden","false"),this.isOpen=!this.isOpen,await new Promise((e=>{setTimeout((()=>{this.classList.add("isOpen"),e()}),300)})),C({eventName:"WEB_COMPONENT_POPIN_OPENED",args:{id:this.props.popin_id}})):console.log("return",t.id,this.id)}close(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),this.addEventListener("transitionend",this.boundFocus),document.removeEventListener("focusin",this.boundFocusin),this.removeLock(),this.switchAriaModal(),this.setAttribute("aria-hidden","true"),this.isOpen=!this.isOpen,this.classList.remove("isOpen"),C({eventName:"WEB_COMPONENT_POPIN_CLOSED",args:{id:this.props.popin_id}})}focus(){this.removeEventListener("transitionend",this.boundFocus),this.isOpen?this.buttonElement.focus():this.openingSource.focus()}focusin(e){W(e,this,!0)}escapeClose(e){"Escape"===e.key&&this.isOpen&&this.close(e)}swipeDown(e){this.isOpen&&this.close(e)}swipeOverlayTogglePlayPause(){C({eventName:"WEB_COMPONENT_VIDEO_TOGGLE",args:{id:this.props.popin_id}})}bindEvent(){this.hasEvent=!0,null!=this.buttonElement&&this.buttonElement.addEventListener("click",this.boundClose),window.addEventListener(t,this.boundOpen),window.addEventListener("WEB_COMPONENT_POPIN_CLOSE",this.boundClose),document.addEventListener("keydown",this.boundEscapeClose),u.is.mobile&&(ee(window,document,this),this.boundSwipeDown=this.swipeDown.bind(this),document.addEventListener("swiped-down",this.boundSwipeDown),this.isVideo&&(this.swipeOverlay=this.querySelector(".swipeOverlay"),this.boundSwipeOverlayTogglePlayPause=this.swipeOverlayTogglePlayPause.bind(this),this.swipeOverlay.addEventListener("click",this.boundSwipeOverlayTogglePlayPause)))}unbindEvent(){this.hasEvent=!1,null!=this.buttonElement&&this.buttonElement.removeEventListener("click",this.boundClose),window.removeEventListener(t,this.boundOpen),window.removeEventListener("WEB_COMPONENT_POPIN_CLOSE",this.boundClose),document.removeEventListener("keydown",this.boundEscapeClose),this.boundSwipeDown&&(document.removeEventListener("swiped-down",this.boundSwipeDown),this.boundSwipeDown=null),this.boundSwipeOverlayTogglePlayPause&&(this.swipeOverlay.removeEventListener("click",this.boundSwipeOverlayTogglePlayPause),this.boundSwipeOverlayTogglePlayPause=null)}}customElements.get("nb-popin")||customElements.define("nb-popin",ie);const ne={fair_trade:"https://www.nespresso.com/shared_res/agility/commons/img/icons/fairTrade.svg",is_organic:function(){let e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-eu.svg";switch(T()){case"us":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-us.svg";break;case"ca":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-ca.svg";break;case"br":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-br.svg";break;case"jp":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-jp.svg";break;case"be":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-be.png"}return e}(),only_vertuo_next:"https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-only-vertuo-next.svg",is_q_certified_arabica:"https://www.nespresso.com/shared_res/agility/commons/img/icons/q_grade_certification_arabica.svg",is_rainforest:"https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-rainforest.svg",is_sustainable:"https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-sustainability.svg",is_design_award_2021:"https://www.nespresso.com/shared_res/agility/commons/img/icons/design_award_2021.svg"};function re(e){return e.filter((e=>function(e){return(t="cat/capsule-range-label",new RegExp(t.replace(/\//g,"\\/"))).test(e.id);var t}(e)))}class ae extends HTMLElement{constructor(){super(),this.props={}}connectedCallback(){this.props=v(this.attributes),this.render()}render(){let e,t,s,i,n,r,a,o,l,c,d,u,{direction:h="row",logos:p}=this.props;this.classList.add(""+("column"===h?"direction-column":"direction-"+h));let b=[];null==p?(e=this.props?.fair_trade,t=this.props?.alt_fair_trade,s=this.props?.is_organic,i=this.props?.alt_organic,n=this.props?.only_vertuo_next,r=this.props?.alt_vertuo_next,a=this.props?.is_rainforest,o=this.props?.alt_rainforest,l=this.props?.is_sustainable,c=this.props?.alt_sustainable,d=this.props?.is_q_certified_arabica,u=this.props?.alt_q_certification_arabica):void 0===p.length?(e=p?.fair_trade,t=p?.alt_fair_trade,s=p?.is_organic,i=p?.alt_organic,n=p?.only_vertuo_next,r=p?.alt_vertuo_next,a=p?.is_rainforest,o=p?.alt_rainforest,l=p?.is_sustainable,c=p?.alt_sustainable,d=p?.is_q_certified_arabica,u=p?.alt_q_certification_arabica):p.length&&(b=[...p]),[[e,"fair_trade",t,b],[s,"is_organic",i,b],[n,"only_vertuo_next",r,b],[a,"is_rainforest",o,b],[l,"is_sustainable",c,b],[d,"is_q_certified_arabica",u,b]].map((e=>this.appendLogo.apply(this,e))),this.innerHTML=b.map((e=>`<img src="${ne[e.name]}" alt="${e.alt}" loading="lazy">`)).join("")}appendLogo(e,t,s,i){e&&!this.hasLogo(i,t)&&i.push({name:t,alt:s})}hasLogo(e,t){return e.some((e=>e.name===t))}}customElements.get("nb-card-logos")||customElements.define("nb-card-logos",ae);class oe extends HTMLElement{constructor(){super(),this.props={},this.labels=[]}connectedCallback(){this.props=v(this.attributes),this.render()}render(){const{labels:e=[],direction:t="column"}=this.props;if(this.classList.add(""+("row"===t?"direction-row":"direction-"+t)),0===e.length)return"";this.labels=e,this.innerHTML=`${this.renderLabels()}`}renderLabels(){return this.labels.map((e=>{const{name:t="",bgColor:s="",color:i=""}=e;return`<mark class="t-3xs-500"\n                            ${s&&i&&`style="background: ${s}; color: ${i}"`}>\n                            <span aria-hidden="true">${t}</span>\n                            <span class="sr-only">${t}</span>\n                        </mark>`})).join("")}}customElements.get("nb-card-labels")||customElements.define("nb-card-labels",oe);const le="pnAdvancerRight",ce="pnAdvancerLeft",de="#000000";class ue{constructor(e,t={}){return this.boundNextClick=this.onNextClick.bind(this),this.boundPrevClick=this.onPrevClick.bind(this),this.boundLinkClick=this.onLinkClick.bind(this),this.boundTouchEnd=this.onTouchEnd.bind(this),this.disableAutoScroll="true"===t.disableAutoScroll||!1,this._entriesBounds=null,new Promise((s=>{this._element=e,this._slides=[].slice.call(e.children),this._options=Object.assign({},{id:"uuid",last_known_scroll_position:0,ticking:!1,navBarTravelDirection:"",navBarTravelling:!1,navBarTravelDistance:150,scrollAmount:220},t),this.buildIHM(),s(this),setTimeout((()=>{this.setOverflowAttribute(),this.initializeIndicatorPosition()}),0)}))}get element(){return this._element}buildIHM(){this._root=this.createElement("div","pn-ProductNav"),this._container=this.createElement("div","pn-ProductNavContents"),this._pnIndicator=null,this._containerSlidesContent=null,this.hasContainer()&&(this._containerSlidesContent=this.createElement("div","pn-ProductContainer")),this.wrapItems(),this._root.appendChild(this._container),this._containerSlidesContent&&this._element.appendChild(this._containerSlidesContent),this._element.insertBefore(this._root,this._element.childNodes[2]),this.createIndicator()}hasContainer(){return!!document.querySelector(".slider-container")}wrapItems(){const e=[];this._slides.map((t=>{const s=function(e){for(var t="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=s.length,n=0;n<e;n++)t+=s.charAt(Math.floor(Math.random()*i));return t}(5);if(this.hasContainer()&&t.classList.contains("slider-container")&&(t.children&&t.children.length&&[...t.children].forEach(((t,s)=>{0!==s&&(t.style.display="none"),t.id=e[s],this._containerSlidesContent.appendChild(t)})),t.remove()),!t.classList.contains("pn-Advancer")){const i=this.createElement("div","pn-ProductNavLinkWrapper");i.appendChild(t),i.setAttribute("data-inner-content-id",s),e.push(s),this._container.appendChild(i)}}))}createElement(e,t){let s=document.createElement(e);return s.setAttribute("class",t),s}createIndicator(){this.elements=[],this._pnIndicator=this.createElement("div","pn-ProductNavIndicator"),this._container.appendChild(this._pnIndicator),this.elements=Array.from(this._container.querySelectorAll("nb-link a")),this.elements.forEach((e=>{e.addEventListener("click",this.boundLinkClick)}));const e=document.getElementById(`${ce}-${this._options.id}`);e&&e.addEventListener("click",this.boundPrevClick);const t=document.getElementById(`${le}-${this._options.id}`);t&&t.addEventListener("click",this.boundNextClick),this._root&&this._container.addEventListener("touchend",this.boundTouchEnd)}onLinkClick(e){this.goToElement(e.currentTarget)}goToSlide(e){this.goToElement(this._slides[e])}showContent(e){const t=document.querySelector(".pn-ProductContainer");t.children&&[...t.children].forEach((e=>e.style.display="none")),document.getElementById(e).style.display="block"}goToElement(e){if(this.hasContainer()){const t=e.closest("[data-inner-content-id]").getAttribute("data-inner-content-id");this.showContent(t)}if(this.deselectAllLinkBut(e),e.setAttribute("aria-selected","true"),!e||!this._entriesBounds)return;let t=0;for(const s of this._entriesBounds){if(s.target.getAttribute("data-href")===e.getAttribute("data-href"))break;t=t+s.boundingClientRect.width+10}this.disableAutoScroll||this._root.scroll({left:t,behavior:"smooth"})}deselectAllLinkBut(e){this.elements.map((t=>{t!==e&&t.setAttribute("aria-selected","false")}))}sideScroll(e,t,s,i,n){this.setOverflowAttribute();let r=0,a=setInterval((function(){"left"===t?e.scrollLeft-=n:e.scrollLeft+=n,r+=n,r>=i&&window.clearInterval(a)}),s);return{slideTimer:a}}onPrevClick(){this.sideScroll(this._root,"left",25,this._options.scrollAmount,10),setTimeout((()=>{this.setOverflowAttribute()}),300)}onNextClick(){this.sideScroll(this._root,"right",25,this._options.scrollAmount,10),setTimeout((()=>{this.setOverflowAttribute()}),300)}onTouchEnd(){this.setOverflowAttribute()}initializeIndicatorPosition(){const e=this._root.querySelector('[aria-selected="true"]');e&&this.moveIndicator(e,de)}determineOverflow(e,t){let s=t.getBoundingClientRect(),i=Math.floor(s.right),n=Math.floor(s.left),r=e.getBoundingClientRect(),a=Math.floor(r.right),o=Math.floor(r.left);return n>o&&i<a?"both":o<n?"left":a>i?"right":"none"}moveIndicator(e,t){if(!this._pnIndicator)return;let s=e.getBoundingClientRect(),i=this._container.getBoundingClientRect().left,n=s.left-i;this._pnIndicator.style.transform="translateX("+(n+this._container.scrollLeft+10)+"px) scaleX("+.01*(s.width-20)+")",this._root.scrollLeft=Math.floor(n+this._container.getBoundingClientRect().left/2),t&&(this._pnIndicator.style.backgroundColor=t)}onResize(){this.setOverflowAttribute(),this.initializeIndicatorPosition()}clearListeners(){this.elements.forEach((e=>{e.removeEventListener("click",this.boundLinkClick)}));const e=document.getElementById(`${ce}-${this._options.id}`);e&&e.removeEventListener("click",this.boundPrevClick);const t=document.getElementById(`${le}-${this._options.id}`);t&&t.removeEventListener("click",this.boundNextClick)}kill(){this.clearListeners()}setOverflowAttribute(){this._element.setAttribute("data-overflowing",this.determineOverflow(this._container,this._root)),this.observe()}observe(){if(!("IntersectionObserver"in window))return!1;this._entriesBounds=[];const e=new IntersectionObserver((t=>{for(const e of t)this._entriesBounds.push({target:e.target,intersection:e.boundingClientRect.right<=window.innerWidth-10&&e.boundingClientRect.left>=10,boundingClientRect:e.boundingClientRect});e.disconnect()}),{root:this._container});this._slides.map((t=>e.observe(t)))}isInViewport(e){if(!this._entriesBounds)return!1;return this._entriesBounds.find((t=>e===t.target)).intersection}}class he extends HTMLElement{constructor(){super(),this.slot=this.innerHTML,this.navBarTravelling=!0,this.disableAutoScroll=!1,this.navBarTravelDirection="",this.navBarTravelDistance=200,this.randomId="swiperMenu_"+function(e){for(var t="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=s.length,n=0;n<e;n++)t+=s.charAt(Math.floor(Math.random()*i));return t}(5),this.sliderMenu=null,this.boundOnResize=this.onResize.bind(this),this.onLoad=this.onLoad.bind(this),this.debouncedOnResize=function(e,t){let s;return t=t||100,function(i){s&&clearTimeout(s),s=setTimeout(e,t,i)}}(this.boundOnResize,250)}static get observedAttributes(){return["navBarTravelling","navBarTravelDirection","navBarTravelDistance"]}render(){const e="true"===this.getAttribute("navigation")||"",t=this.getAttribute("a11y_slider_previous_button")||"",s=this.getAttribute("a11y_slider_next_button")||"";this.innerHTML=`\n            <div id="pnProductNav-${this.randomId}" class="pn-ProductNavWrapper ${this.randomId}">\n                ${e&&`<nb-cta id="pnAdvancerLeft-${this.randomId}"\n                        class="pn-Advancer pn-AdvancerLeft"\n                        variation="navigation"\n                        contrast="highlight"\n                        size="32"\n                        icon_right="chevron-left"\n                        label="${t}"></nb-cta>`}\n                ${this.slot}\n                ${e&&`<nb-cta id="pnAdvancerRight-${this.randomId}"\n                        class="pn-Advancer pn-AdvancerRight"\n                        variation="navigation"\n                        contrast="highlight"\n                        size="32"\n                        icon_right="chevron-right"\n                        label="${s}"></nb-cta>`}\n                <span id="pnIndicator-${this.randomId}"\n                    class="pn-ProductNavIndicator">\n                </span>\n            </div>\n\n            `,this.loadSwiper()}connectedCallback(){this.navBarTravelling=this.getAttribute("navBarTravelling")||this.navBarTravelling,this.navBarTravelDirection=this.getAttribute("navBarTravelDirection")||this.navBarTravelDirection,this.navBarTravelDistance=this.getAttribute("navBarTravelDistance")||this.navBarTravelDistance,this.disableAutoScroll=this.getAttribute("disable_auto_scroll")||"",this.render(),window.addEventListener("resize",this.debouncedOnResize)}loadSwiper(){let e=this.navBarTravelDirection,t=this.navBarTravelDistance;this.sliderMenu=new ue(this.querySelector("."+this.randomId),{id:this.randomId,index:this.index,navBarTravelDirection:e,navBarTravelDistance:t,disableAutoScroll:this.disableAutoScroll}),this.sliderMenu.then((()=>{this.classList.add("is-show"),C({eventName:n,args:{className:this.randomId},element:this})}))}handleClick(){var e;C({eventName:"WEB_COMPONENT_SLIDE_CHANGE"}),e={rootElement:["nb-slider-menu"]},window.gtmDataObject.push({event:"itemDisplay",eventRaisedBy:"Web component",eventAction:"Click",itemTypes:["products"],...e})}onLoad(){this.sliderMenu.then((e=>e.onLoad()))}onResize(){this.sliderMenu.then((e=>e.onResize()))}onNavigationClick(e){let t="";e.target&&e.target.closest(".link")&&e.target.closest(".link").getAttribute("tracking_label")&&(t=e.target.closest(".link").getAttribute("tracking_label")),$({eventAction:"PLP Content Tab",eventLabel:t})}disconnectedCallback(){window.removeEventListener("resize",this.debouncedOnResize),this.sliderMenu.then((e=>e.kill()))}}customElements.get("nb-slider-menu")||customElements.define("nb-slider-menu",he);var pe=(e=[])=>{e.forEach((e=>{if(e&&e.element)return e.element.addEventListener(e.type,e.listener,e.options)}))},be=(e=[])=>{e.forEach((e=>{e&&e.element&&e.element.removeEventListener(e.type,e.listener)}))};const me=(()=>{const e=({identifier:e="",callback:t,options:s})=>{if(""===e)return{};const i=document.querySelectorAll(e),n=new IntersectionObserver(t,s);for(const e of i)n.observe(e);return{observer:n,targets:i}};return{initialize:t=>{t.map(e)},destroy:()=>{}}})(),ge=[.2,.8],_e=(()=>{let e=null,t=!1;const s=e=>{i(e[0])},i=t=>{if(t.isIntersecting&&!e.isScrolling){let{sectionId:e=""}=t.target.dataset;e=""===e?t.target.getAttribute("data-id"):"",C({eventName:"EVENT_NAVIGATION_SECTION_CHANGE",args:{sectionId:e}})}};return{initialize:i=>{e=i;const n=[{identifier:"[data-id]",callback:s,options:{threshold:ge,rootMargin:"-160px 0px 0px 0px"}}],r=()=>{t||(t=!0,me.initialize(n))};setTimeout((()=>{r()}),2e3),window.addEventListener("WEB_COMPONENT_PROJECTS_LOADED",(()=>{r()}))},destroy:()=>{}}})(),fe=e=>{const t=e=>{const t=e.querySelectorAll("a");for(const[e,i]of t.entries())i.addEventListener("click",s(e))},s=t=>s=>{s.preventDefault();const i=s.target.closest(".is-link");i&&(C({eventName:"EVENT_NAVIGATION_SECTION_CHANGE",args:{sectionId:i.getAttribute("data-href"),index:t}}),e.scroll&&e.scroll(i,t),window.location.hash=i.getAttribute("data-href"))},i=t=>{const{sectionId:s,index:i}=L(t);e.updateBubbles&&e.updateBubbles(s),e.updateChips&&e.updateChips(s),e.updateSlider&&e.updateSlider(s,i)};return{createListeners:()=>{const{containerBubble:s,containerChip:r,sliderBubble:a,sliderChip:o}=e.refs,l=[];return s&&l.push({element:s,type:n,listener:t(a),options:{once:!0}}),r&&l.push({element:r,type:n,listener:t(o),options:{once:!0}}),l.push({element:window,type:"EVENT_NAVIGATION_SECTION_CHANGE",listener:i}),l.push({element:window,type:"EVENT_HEADER_POSITION_CHANGED",listener:e.updateLayout.bind(e)}),pe(l),l}}};class ve{constructor(){this.promise=new Promise(((e,t)=>{this.reject=t,this.resolve=e}))}}class ye extends HTMLElement{static get observedAttributes(){return["sticky"]}constructor(){super(),this.isMobile=window.innerWidth<768,this.isScrolling=!1}connectedCallback(){this.props=v(this.attributes),this.classList.add("nb-navigation-bubbles"),this.init()}init(){this.render(),this.refs=Y(this),this.geometry=this.getGeometry(),this.slidesVisibles=this.getSlidesVisible(),_e.initialize(this),this.eventsListeners=fe(this).createListeners()}update(){this.eventListeners&&be(this.eventListeners),this.updateClasses(),this.render(),this.refs=Y(this),this.eventsListeners=fe(this).createListeners()}attributeChangedCallback(e,t,s){"sticky"===e&&this.props&&s!==t&&(this.props.sticky=s,this.update())}render(){let e="";e=this.isSticky()?`${this.renderNavigation(32,"Chip","white_1000")}`:`${this.renderNavigation(16,"Bubble","")}`,this.innerHTML=e,this.updateClasses()}renderNavigation(e,t,s){const{a11y_slider_previous_button:i,a11y_slider_next_button:n}=this.props,r=this.renderList(`render${t}`);return`\n            <nb-container\n                background_color="${s}"\n                class="nb-navigation-bubbles__container--${t.toLowerCase()}"\n                contrast="light"\n                data-ref="container${t}"\n            >\n                <nb-slider-menu\n                    a11y_slider_previous_button="${i}"\n                    a11y_slider_next_button="${n}"\n                    navigation="true"\n                    pagination="false"\n                    slides_loop="false"\n                    slides_visible="${this.slidesVisibles}"\n                    space_between="${e}"\n                    data-ref="slider${t}"\n                >\n                    ${r}\n                </nb-slider-menu>\n            </nb-container>\n        `}renderList(e){const{bubbles:t=[]}=this.props;return t.map((t=>this[e](t))).join("")}renderBubble(e){let{link:t}=e;if(!t)return null;const{linkNoHash:s,linkHash:i}=this._getHashLink(t);return`\n            <a href="${i}" class="is-link" data-href='${s}'>\n                <nb-bubble data='${JSON.stringify(e).replace(/"/g,"&quot;")}' data-ref="bubbles[${s}]"></nb-bubble>\n            </a>\n        `}_getHashLink(e){let t=e,s=e;return-1!==e.indexOf("#")?s=e.replace("#",""):t="#"+e,{linkNoHash:s,linkHash:t}}renderChip(e){const{link:t}=e;if(!t)return null;const{linkNoHash:s,linkHash:i}=this._getHashLink(t);return`\n            <a href="${i}" data-href='${s}' class="is-link">\n                <nb-chip\n                    background_image="${e.visual.src}"\n                    data-ref="chips[${s}]"\n                    rounded="false"\n                >\n                    ${e.label}\n                </nb-chip>\n            </a>\n        `}isSticky(){if(!this.props)return!1;const{sticky:e="false"}=this.props;return"true"===e}getMethod(e){return["add","remove"][e?0:1]}addClass(e,...t){this.classList[this.getMethod(e)](...t)}updateClasses(){const e=this.isSticky(),{padding_top:t,padding_bottom:s}=this.props;null!=s&&null!=t&&this.addClass(!e,t,s)}updateLayout(){this.geometry=this.getGeometry(),this.updatePosition()}updateBubbles(e){const{bubbles:t={}}=this.refs;for(const s in t){const i=t[s],n=s===e?"selected":"default";i.setAttribute&&i.setAttribute("state",n)}}updateChips(e){const{chips:t={}}=this.refs;for(const s in t){const i=t[s],n=s===e?"true":"false";i.setAttribute&&i.setAttribute("checked",n)}}async updateSlider(e,t){let s=t;if(this.refs.sliderChip){const i=await this.refs.sliderChip.sliderMenu;if(void 0===t){document.querySelectorAll("#pnProductNav-"+i._options.id+" .pn-ProductNavLinkWrapper").forEach(((t,i)=>{t.childNodes[0].getAttribute("data-href")===e&&(s=i)}))}s&&i&&i.goToSlide&&i.goToSlide(s)}}emit(e){C({element:this,...e})}async scroll(e,t){this.isScrolling=!0;const s=e.getAttribute("data-href"),{header:i,chips:n,navigation:r}=this.geometry,a=0===t?r.height:n.height,o={scrollPaddingTop:i.top+i.height+a};await((e,t={})=>{const s={scrollPaddingTop:140,scrollDuration:300,...t},i=new ve;let n;const r=typeof e;if(["string","object"].indexOf(r)>-1){n=e,"string"===r&&(n=document.querySelector(e));try{e=window.pageYOffset+n.getBoundingClientRect().top-s.scrollPaddingTop}catch(t){throw new Error(`error: No element found with the selector "${e}"`)}}else"number"!=typeof e&&(e=0);let a=window.performance.now(),o=0,l=window.pageYOffset-e,c=window.innerHeight,d=document.body.clientHeight;l>c&&d-c>0&&(s.scrollDuration=Math.abs(s.scrollDuration+s.scrollDuration*(Math.abs(l)/(d-c))));let u=a+s.scrollDuration;return window.requestAnimationFrame((function t(){let n=window.performance.now();if(n<u){o=(n-a)/s.scrollDuration,o=--o*o*o+1;const i=l*o;window.scrollTo(0,e+(l-i)),window.requestAnimationFrame(t)}else window.scrollTo(0,e),setTimeout((()=>i.resolve()),125);return i.promise})),i.promise})(`[data-id="${s}"]`,o),this.isScrolling=!1}track(e){const{customEventAction:t}=this.props;let s={eventRaisedBy:"Before",eventLabel:e};t&&(s.eventAction=t),$(s)}getGeometry(){const e=document.querySelector(".Header__top"),t=this?.getBoundingClientRect(),s=e?.getBoundingClientRect()||{height:0,y:0};return{header:{height:s.height,top:s.y},navigation:{height:t.height,top:window.scrollY+t.y},chips:{height:t.height,top:window.scrollY+t.y}}}getSlidesVisible(){const{sticky:e="false"}=this.props;return u.is.mobile?3:u.is.tablet?6:"true"===e?5:9}disconnectedCallback(){be(this.eventListeners)}}async function ke(){return await window.plpData}customElements.get("nb-navigation-bubbles")||customElements.define("nb-navigation-bubbles",ye);var we={init:async function(e){return window.plpDataType=e,window.getPLPData=window.getPLPData||ke,this.set("sessionId",(Math.random()+1).toString(36).substring(7)),this.set("filtersSelected",[]),this.set("sortCurrent",{}),this.set("sortOptions",[]),window.getPLPData()},set:function(e,t){this[e]=t},get:function(e){return this[e]||null},initPriceFormatter:function(){return async function(){return napi.priceFormat()}()},initCurrency:function(){return async function(){return napi.market().read()}()},productsList:function(){return this.products},productsListFiltered:function(){return this.products.reduce(((e,t)=>e.concat(t.products)),[]).filter(((e,t,s)=>this.get("filtersSelected").every((t=>!!e[t.key]&&("string"==typeof e[t.key]?e[t.key]===t.value:"number"==typeof e[t.key]?JSON.parse("["+t.value+"]").includes(e[t.key]):e[t.key].includes(t.value))))&&s.findIndex((t=>t.id===e.id))===t)).sort(((e,t)=>e[this.get("sortCurrent").key]<t[this.get("sortCurrent").key]?"asc"===this.get("sortCurrent").order?-1:1:e[this.get("sortCurrent").key]>t[this.get("sortCurrent").key]?"asc"===this.get("sortCurrent").order?1:-1:0))},productsFilteredCount:function(){return this.productsListFiltered().length},filtersUpdate:function(e,t=!0){const s=e.key,i=e.value,n=e.selected,r=this.get("filters").find((e=>e.key===s));r&&(r.values.forEach((e=>{("object"==typeof e.value?e.value.join(",")===i:e.value===i)&&(e.selected=n,n?this.get("filtersSelected").push({key:s,value:i,color:e.color||null}):this.set("filtersSelected",this.get("filtersSelected").filter((e=>!(e.key===s&&e.value===i)))))})),t&&this.fire())},filtersSelectedWithLabel:function(){return this.get("filtersSelected").map((e=>({label:this.get("filters").find((t=>t.key===e.key)).values.find((t=>t.value===e.value)).label,key:e.key,value:e.value})))},filtersSelectedCount:function(){return this.get("filtersSelected").length},filtersSelectedSerialized:function(){const e=[this.get("sortCurrent"),...this.get("filtersSelected")];return c(e)},filtersReset:function(){this.set("filtersSelected",[]),this.get("filters").forEach((e=>{e.values.forEach((e=>{e.selected=!1,e.disabled=!1}))})),this.set("sortCurrent",this.get("sortOptions")[0]),this.fire()},observers:[],subscribe:function(e){this.observers.push(e)},unsubscribe:function(e){this.observers=this.observers.filter((t=>{if(t!=e)return t}))},fire:function(){this.observers.forEach((e=>{e.call()}))}};const Ee="filtersPLP",Ce="plp-sort-menu",Le="plp-sort-menu-mobile",$e="plp-filter-popin";var Se=function(){document.getElementById("productsListPLP").parentElement.setAttribute("data-loaded",we.sessionId)},Oe=function(){const e=document.getElementById("filtersPLP"),t=document.getElementById("navigationPLP"),s=document.getElementById("productsListPLP"),i=document.getElementById("productsResultsPLP");e.setAttribute("data-request",we.sessionId),e.setAttribute("data-filter-counter",we.filtersSelectedCount()),t.setAttribute("data-request",we.sessionId),s.setAttribute("data-request",we.sessionId),e.style.display="block",t.style.display="block",s.style.display="block",i.style.display="none",document.getElementById("productsResultsPLP").style.display="none"},Ae=function(){const e=document.getElementById("filtersPLP"),t=document.getElementById("navigationPLP"),s=document.getElementById("productsListPLP"),i=document.getElementById("productsResultsPLP");e.style.display="block",e.setAttribute("data-request",we.sessionId),e.setAttribute("data-filter-counter",we.filtersSelectedCount()),t.style.display="none",s.style.display="none",i.setAttribute("data-request",we.filtersSelectedSerialized()),i.style.display="block"},Te=function(){let e=document.getElementsByClassName("plp-app")[0].querySelector(`#${$e}`);e?(e.querySelector("plp-filter-popin").setAttribute("data-refresh","true"),C({eventName:t,args:{id:$e}})):import("./plp.filter-popin-b85d3b86.js").then((()=>{e=((e,t)=>{for(let s in t)e.setAttribute(s,t[s]);return e})(document.createElement("nb-popin",{is:customElements.get("Popin")}),{"data-request":we.sessionId,id:$e,popin_id:$e,variation:"before",bgcolor:"white",heading:we.translations["productlistrespblock.filter.label"],label_close:"test",content:'<plp-filter-popin class="plp-filter-popin-content"></plp-filter-popin>'}),document.getElementsByClassName("plp-app")[0].appendChild(e),C({eventName:t,args:{id:$e}})}))},Pe=function(e){const t=e.detail.err||"Error";console.error(t)};const Ne=(e,t)=>{const s=window.location.href.split("#");history.pushState(null,null,((e,t,s)=>{const i=new RegExp("([?&])"+t+"=.*?(&|$)","i"),n=-1!==e.indexOf("?")?"&":"?";return e.match(i)?e.replace(i,"$1"+t+"="+s+"$2"):e+n+t+"="+s})(s[0],e,encodeURIComponent(JSON.stringify(t))))},xe=e=>{const t=window.location.search,s=new URLSearchParams(t).get(e);if(!s)return null;try{return JSON.parse(decodeURIComponent(s))}catch(e){console.error("plp.actions-getUrlVariable: url parsing failed")}},Ie=e=>{const{isSorted:t,isFiltered:s}=e;$(t||s?{eventAction:"PLP Filter click",eventLabel:[Me(e),Be(e)].join("|")}:{eventAction:"PLP Filter click",eventLabel:"none selected"})},Me=e=>{const{isSorted:t,sortKey:s,sortOrder:i}=e;return t?`sort:${i}|${s}`:"sort:none selected"},Be=e=>{const{isFiltered:t,filtersSelected:s}=e;let i="characteristics:";if(!t)return`${i}none selected`;return`${i}${[...new Set(s.map((e=>e.key)))].join(",")}`};let De={};const Fe=e=>e.get("sortCurrent").key!==e.get("sortOptions")[0].key||e.get("sortCurrent").order!==e.get("sortOptions")[0].order,He=e=>0!==e.filtersSelectedCount();var qe={onload:{process:function(e,t){const{plpType:s}=e.detail.value,i=we.init(s);we.set("plpType",s||null),we.set("innerWidth",window.innerWidth),we.set("innerHeight",window.innerHeight);const n=we.initCurrency(),r=we.initPriceFormatter();Promise.all([i,n,r]).then((e=>{De=e[0],we.set("currency",e[1].currency),we.set("priceFormatter",e[2]),t(new CustomEvent("onloadSuccess"))})).catch((e=>{console.error(e),t(new CustomEvent("onloadError",{detail:{err:e}}))}))}},onloadSuccess:{nextState:function(e){return Se(e)}},onloadError:{nextState:function(e){return Pe(e)}},onMergeData:{process:function(e,t){const{filtersService:s,productService:i,dataSortService:n,pageBuilderProps:r}=e.detail.value,{categories:a,enabledTechnologies:o,translations:l,categoriesExtraData:c,nav_links:d,bubbles:u}=i(De,r),h=n(r);we.set("sortOptions",h),we.set("sortCurrent",h[0]),we.set("enabledTechnologies",o),we.set("products",a),we.set("translations",l),we.set("nav_links",d),we.set("bubbles",u);const p=s(we.get("products"),r,c,l,{priceFormatter:we.get("priceFormatter"),currency:we.get("currency")});we.set("filters",p);const b=xe("filters");if(b&&b.length>0){const e=((e,t)=>{const s=[];return t.forEach((t=>{e.forEach((e=>{e.key===t.key&&e.values.forEach((i=>{t.value===i.value&&s.push({key:e.key,value:i.value,selected:!0})}))}))})),s})(we.get("filters"),b);if(e.length>0){let t=!1;e.forEach(((s,i)=>{t=i===e.length-1,we.filtersUpdate(s,t)}))}}const m=xe("sort");if(m){const e=(g=we.get("sortOptions"),_=m,[...g].filter((e=>e.key===_.key&&e.order===_.order)));e.length>0&&we.set("sortCurrent",e[0])}var g,_;(e=>{const{campaign_id:t,campaign_name:s,campaign_creative:i=null,campaign_position:n}=e,r=window.document.getElementById("filtersPLP");if(i)M(r,{id:t,name:s,position:n,creative:i});else{const{campaign:t=null}=e;t&&M(r,t)}})(r),t(new CustomEvent("switchProductsPage"))}},switchProductsPage:{nextState:function(e){return Fe(we)||He(we)?Ae(e):Oe(e)}},onMergeDataError:{nextState:function(e){return Pe(e)}},onFilter:{process:(e,t)=>{Ne("filters",we.get("filtersSelected")),Ne("sort",{key:we.get("sortCurrent").key,order:we.get("sortCurrent").order}),t(new CustomEvent("switchProductsPage")),Ie({isSorted:Fe(we),isFiltered:He(we),sortKey:we.get("sortCurrent").key,sortOrder:we.get("sortCurrent").order,filtersSelected:we.get("filtersSelected")})}},onSort:{process:(e,t)=>{Ne("filters",we.get("filtersSelected")),Ne("sort",{key:we.get("sortCurrent").key,order:we.get("sortCurrent").order}),t(new CustomEvent("switchProductsPage")),Ie({isSorted:Fe(we),isFiltered:He(we),sortKey:we.get("sortCurrent").key,sortOrder:we.get("sortCurrent").order,filtersSelected:we.get("filtersSelected")})}},onloadFilter:{process:function(e,t){t(new CustomEvent("onloadFilterSuccess",{detail:{e:e}}))}},onloadFilterSuccess:{nextState:function(e){return Te(e)}},onloadFilterError:{nextState:function(e){return Pe(e)}}},Re=(e,t,s=null)=>{let i=new CustomEvent(e,{detail:{value:t,fn:s}});ze(i)};const ze=e=>{qe[e.type].process(e,Ve)},Ve=e=>{qe[e.type].nextState(e)};customElements.get("plp-filter-cta")||customElements.define("plp-filter-cta",class extends a{bubbleElement=null;static get observedAttributes(){return["data-filter-counter"]}attributeChangedCallback(e,t,s){null!=s&&s.length>0&&s!==t&&"data-filter-counter"===e&&this.updateBubbleCounter(s)}onStart(){this.template=`<nb-cta id='plp-filter' variation='plpFilter' icon_right='filter'>${this.props.cta_filter_label}</nb-cta>`}onReady(){document.getElementById("plp-filter").addEventListener("click",(()=>{Re("onloadFilter",{})})),this.buttonElement=this.querySelector("nb-cta button"),this.bubbleElement=document.createElement("div"),this.bubbleElement.classList.add("t-2xs-700"),this.bubbleElement.classList.add("bubbleCounter"),this.bubbleElement.innerHTML="0",this.firstChild.firstChild.appendChild(this.bubbleElement)}updateBubbleCounter(e){if(!this.bubbleElement)return null;this.bubbleElement.innerHTML=e,"0"===e?this.buttonElement.classList.remove("bubbleActive"):this.buttonElement.classList.add("bubbleActive")}});customElements.get("plp-filter-links")||customElements.define("plp-filter-links",class extends a{onStart(){const e=we.innerWidth<768;this.template=`<nb-slider-menu\n                            a11y_slider_previous_button="${this.props.a11y_slider_previous_button}"\n                            a11y_slider_next_button="${this.props.a11y_slider_next_button}"\n                            navigation="${!e}"\n                            data-ref="navLink">\n                            ${this.renderLinksList()}\n                        </nb-slider-menu>`}renderLinksList(){const{navigation:e=[]}=this.props;return e.map((({link:e="",icon_left:t="",seo_label:s="",tracking_label:i="",label:n="",selected:r=!1})=>`<nb-link\n                                link='${e}'\n                                phantom='true'\n                                color='black'\n                                selected=${r}\n                                ${s&&`seo_label='${s}'`}\n                                ${i&&`tracking_label='${i}'`}\n                                ${t&&`icon_left='${t}'`}\n                    >${n}</nb-link>`)).join("")}});customElements.get("plp-filter-sort")||customElements.define("plp-filter-sort",class extends a{#e="plp-sort-menu";constructor(){super(),this.formatSortSeprator="::",we.subscribe(this.componentUpdated.bind(this)),this.sortButton={}}onStart(){this.props=this._createProps(document.getElementById("filtersPLP").parentElement.attributes);const{label_sort_by:e="Sort By",aa_description_sort_by:t="You can select different sorting values from this listbox. To interact with this listbox press SPACE or ENTER key.",aa_listbox_description_sort_by:s="You can navigate through the options using UP or DOWN arrows keys. To exit this listbox press ESCAPE key.",aa_select_description_sort_by:i="To select this option press SPACE or ENTER key.",label_close_sort_by:n="Close"}=this.props,r=we.get("sortOptions").map((e=>({label:e.label,value:this._formatSortValue(e.key,e.order),checked:e.checked})));we.get("sortCurrent").key!==we.get("sortOptions")[0].key&&r.forEach((e=>{e.checked=e.value===this._formatSortValue(we.get("sortCurrent").key,we.get("sortCurrent").order)}));const a={label:e,aa_description:t,aa_listbox_description:s,aa_select_description:i,icon_option:"check",label_close:n,options:r};this.template=`<nb-dropdown id="${this.#e}" data='${c(a)}'/>`}onReady(){document.getElementById(this.#e).addEventListener("WEB_COMPONENT_SORT_BY_CHANGE",(e=>{const[t,s]=e.detail.selected.value.split(this.formatSortSeprator);we.set("sortCurrent",{key:t,order:s}),Re("onSort")})),this.sortButton=document.getElementById(this.#e)}componentUpdated(){const{key:e,order:t}=we.get("sortCurrent");this.sortButton.setSelected(this._formatSortValue(e,t)),this.sortButton.render()}onDestroy(){we.unsubscribe(this.componentUpdated)}_formatSortValue(e,t){return`${e}${this.formatSortSeprator}${t}`}});customElements.get("plp-filter")||customElements.define("plp-filter",class extends a{static get observedAttributes(){return["data-request","data-filter-counter"]}attributeChangedCallback(e,t,s){null!=s&&s!==t&&s.length>0&&("data-request"===e?this.updateComponent():"data-filter-counter"===e&&document.getElementById("plp-filter-cta").setAttribute("data-filter-counter",s))}onStart(){this.props=this._createProps(this.parentElement.attributes),this.classList.add("plp-filter")}updateComponent(){const e=we.get("nav_links"),t=`<div class='plp-filter-restrict'>\n                        <plp-filter-cta\n                            id="plp-filter-cta"\n                            cta_filter_label="${this.props.copywriting?.cta_filter_label||this.props.cta_filter_label}"\n                            data-filter-counter="0"\n                        ></plp-filter-cta>\n                        <plp-filter-links\n                            data = '${c({navigation:e,a11y_slider_previous_button:this.props.a11y_slider_previous_button,a11y_slider_next_button:this.props.a11y_slider_next_button})}'\n                        ></plp-filter-links>\n                        <plp-filter-sort></plp-filter-sort>\n                    </div>`;this.loadTemplate(t)}});const We=(()=>{let e=null,t=0;const s=()=>{const s=e.getAttribute("sticky")||"false";let i=0,n=!1,r={};for(var a=0;a<e.parentElement.childNodes.length&&(e.parentElement.childNodes[a].tagName&&e.parentElement.childNodes[a].tagName===e.tagName&&(r=e.parentElement.childNodes[a+2],r&&(i=r.offsetTop-80,n=!0)),!n);a++);n&&0===i&&(i=e.parentElement.offsetTop+e.parentElement.offsetHeight);const o=window.scrollY-i>0;"true"===s!==o&&(e.setAttribute("sticky",o),t>0&&(document.body.style.paddingTop=o?t+"px":"0px"))},i=()=>{window.addEventListener("scroll",s)},n=()=>{window.removeEventListener("scroll",s)};return{initialize:(n,r=t)=>{e=n,t=r,e.setAttribute("sticky","false"),e.classList.add("nb-sticky-container"),s(),i()},destroy:()=>{n()},updatePosition:(t=0)=>{const s=document.querySelector(".Header__top")?.getBoundingClientRect()||{height:0,y:0},i=s.height,n=`${s.y+i+t}px`;return e.style.top=n,0}}})();var je=e=>{const{a11y_slider_previous_button:t,a11y_slider_next_button:s}=e,i=we.get("nav_links"),n=(({bubbles:e,a11y_slider_previous_button:t,a11y_slider_next_button:s})=>{let i="";return e&&(i=c({a11y_slider_previous_button:t,a11y_slider_next_button:s,bubbles:e,customEventAction:"PLP Content Tab"})),i})({bubbles:we.get("bubbles"),...e});let r=`<nb-navigation-bubbles data='${n}'></nb-navigation-bubbles>`;const a=(e=>{let t="";return e&&(t=c({navigation:e})),t})(i);return r+=`<nb-plp-sticky-bar\n                data="${a}"\n                a11y_slider_previous_button="${t}"\n                a11y_slider_next_button="${s}"\n                navigation_bubbles="${n}"\n            ></nb-plp-sticky-bar>`,r};customElements.get("plp-navigation")||customElements.define("plp-navigation",class extends a{#t=!0;onStart(){this.props=this._createProps(this.parentElement.attributes),this.#t&&We.initialize(this,0)}static get observedAttributes(){return["sticky","data-request"]}attributeChangedCallback(e,t,s){null!=s&&s!==t&&s.length>0&&("sticky"===e&&this.#t&&We.updatePosition(),"data-request"===e&&this.updateComponent())}updateComponent(){const e=je(this.props.copywriting?this.props.copywriting:this.props);this.loadTemplate(e)}onDestroy(){this.#t&&We.destroy()}});var Ge=(e,t="")=>{const s={...e,rendererName:t};s.price=we.priceFormatter.short(we.currency,e.price),s.price_per_capsule&&(s.price_per_capsule=we.priceFormatter.short(we.currency,e.price_per_capsule)),s.intensity_label=we.translations["productlistrespblock.capsule.a11y.intensity"],s.variation=h;const i=(({type:e})=>{let t="nb-sku";return"capsule"===e?t="nb-sku-coffee":"machine"===e?t="nb-sku-machine":"accessory"===e?t="nb-sku-accessory":"giftcard"===e&&(t="nb-sku-gift-card"),t})(s);return`<${i}\n                id="${s.sku}"\n                data="${c(s)}"\n                ${s.highlighted?`highlighted="${s.highlighted}"`:""}\n           ></${i}>`};customElements.get("plp-results-chip")||customElements.define("plp-results-chip",class extends a{onStart(){const{icon_right:e,variation:t,label:s,a11y_label:i,color:n}=this.props,r=n?`<div class="chip-color" style="background:${n}"></div>`:"";this.template=`<nb-cta\n                    icon_right="${e}"\n                    variation="${t}"\n                    aria_label_before="${i}"\n             >\n                    ${r}\n                    ${s}\n             </nb-cta>`}onReady(){const{value:e,type:t,label:s}=this.props;this.addEventListener("click",(()=>{const i={key:t,value:e,selected:!1,label:s};we.filtersUpdate(i),this.remove(),Re("onFilter")}))}});customElements.get("plp-results")||customElements.define("plp-results",class extends a{onStart(){this.props=this._createProps(this.parentElement.attributes),this.productListBkp=[],this.classList.add("plp-results")}static get observedAttributes(){return["data-request"]}attributeChangedCallback(e,t,s){null!=s&&s!==t&&s.length>0&&"data-request"===e&&this.updateComponent()}updateComponent(){if(this.arraysAreEqual(this.productListBkp,we.productsListFiltered()))return null;this.productListBkp=we.productsListFiltered();let e=(e=>{const{header_result_label:t="Currently shopping by",a11y_header_result_label_button:s="Reset filter",header_result_label_reset:i="Reset all",a11y_header_result_label_reset:n="Filters",header_result_label_results:r="Results",header_result_label_results_zero:a="",header_result_label_results_one:o="",a11y_header_result_label_results:l="With your filters activated, you have currently"}=e,c=we.productsFilteredCount();let d='<nb-container element_class="plp-results-header" contrast="light">';return we.filtersSelectedCount()>0&&(d+=`<p class="t-sm-400-sl cb-title">${t}</p>`,we.filtersSelectedWithLabel().forEach((e=>{d+=`<plp-results-chip\n                    icon_right="close-2"\n                    variation="secondary"\n                    value="${e.value}"\n                    type="${e.key}"\n                    label="${e.label}"\n                    color="${e.color||""}"\n                    a11y_label="${s}"\n             >${e.label}</plp-results-chip>`}))),d+=`<nb-link\n                  id="nb-plp-filter-results-reset-all"\n                  size="small"\n                  color="black"\n                  aria-label="${n}"\n             >\n                  ${i}\n             </nb-link>`,d+=`<p class="t-xs-700-caps-sl cb-results"><span class="sr-only">${l}</span> <span>${c}</span> ${0===we.filtersSelectedCount()?a:1===we.filtersSelectedCount()?o:r}:</p>`,d+="</nb-container>",d})(this.props);e+='<nb-container element_class="plp-grid" className="plp-grid--results-list">',we.productsListFiltered().forEach((t=>{e+=Ge(t,"results")})),e+="</nb-container>",this.loadTemplate(e,!0),document.querySelector("#nb-plp-filter-results-reset-all")?.addEventListener("click",this.resetClick)}arraysAreEqual(e,t){return e===t||e.length===t.length&&e.every(((e,s)=>e===t[s]))}onDestroy(){document.querySelector("#nb-plp-filter-results-reset-all")?.removeEventListener("click",this.resetClick)}resetClick(){we.filtersReset(),Re("onFilter")}});customElements.get("plp-products")||customElements.define("plp-products",class extends a{static get observedAttributes(){return["data-request"]}attributeChangedCallback(e,t,s){null!=s&&s!==t&&s.length>0&&"data-request"===e&&this.updateComponent()}updateComponent(){const e=we.get("products").reduce(((e,t)=>e+=(e=>{const{id:t=null,background_retina:s,background_desktop:i,background_mobile:n,background_tablet:r,contrast:a="dark",name:o=null,description:l,products:c=[]}=e;return`<div class='plp-category' data-id="${t}">\n                <nb-container\n                    classname="plp-category--header"\n                    contrast='${a}'\n                    background_retina='${s}'\n                    background_desktop='${i}'\n                    background_mobile='${n}'\n                    background_tablet='${r}'\n                >\n                    <header>\n                        ${o?`<h2 class="h-2xl-700-sl plp-category--title">${o}</h2>`:""}\n                        <div class="plp-category--description">\n                            ${l?`<p class="description t-md-400">${l}</p>`:""}\n                        </div>\n                    </header>\n                </nb-container>\n                <nb-container classname="plp-category--products" contrast='light'>\n                    <div class="plp-category--segment">\n                        <div class='plp-category--side'></div>\n                        <div class='plp-category--center'>\n                          <div class="plp-grid">\n                              ${c.map((t=>Ge(t,e))).join("")}\n                            </div>\n                        </div>\n                    </div>\n                </nb-container>\n            </div>`})(t)),"");this.loadTemplate(e)}});class Ue extends a{constructor(){super(),this.dataTransformService=()=>[],this.dataFiltersService=()=>[],this.dataSortService=()=>[]}static get observedAttributes(){return["data-loaded"]}attributeChangedCallback(e,t,s){null!=s&&s!==t&&s.length>0&&"data-loaded"===e&&Re("onMergeData",{filtersService:this.dataFiltersService,productService:this.dataTransformService,dataSortService:this.dataSortService,pageBuilderProps:this.props})}onStart(){Re("onload",{plpType:this.plpType}),this.classList.add("plp-app"),this.classList.add(`plp-app-${this.plpType}`),this.props.options&&this.props.options.items_per_row&&this.props.options.items_per_row>"3"&&this.classList.add(`plp-row-${this.props.options.items_per_row}`),this.template='\n            <plp-filter id="filtersPLP" style="display: none;"></plp-filter>\n            <plp-navigation id="navigationPLP" style="display: none;"></plp-navigation>\n            <plp-products id="productsListPLP" style="display: none;"></plp-products>\n            <plp-results id="productsResultsPLP" style="display: none;"></plp-results>\n        '}}class Ke extends class{#s="";#i="";#n="";#r=[];#a=null;#o=null;#l=null;#c=null;#d=[];#u=[];#h="";#p=new Date;#b=new Date;#m="/shared_res/agility/next-components/assets/backgrounds/barista_creation_range_XL.jpg";#g="/shared_res/agility/next-components/assets/backgrounds/barista_creation_range_L.jpg";#_="/shared_res/agility/next-components/assets/backgrounds/barista_creation_range_S.jpg";#f="";#v="dark";#y=!1;constructor(e,t){this.#s=e.id||this.#s,this.#i=e.name||this.#i,this.#a=e.capacityLabel||this.#a,this.#n=e.description||this.#n,this.#o=e.detailsIcon||this.#o,this.#l=e.icon||this.#l,this.#c=e.rangeLink||this.#c,this.#d=e.subCategories||this.#d,this.#u=e.superCategories||this.#u,this.#h=e.url||this.#h,this.#g=t?.background_desktop||this.#g,this.#_=t?.background_mobile||this.#_,this.#m=t?.background_retina||this.#m,this.#f=t?.background_tablet||this.#f,this.#v=t?.contrast||this.#v}get id(){return this.#s}get products(){return this.#r}set products(e){this.#r=e}get name(){return this.#i}get description(){return this.#n}get contrast(){return this.#v}get background_desktop(){return this.#g}get background_mobile(){return this.#_}get background_retina(){return this.#m}get background_tablet(){return this.#f}isProductCategory(){return!this.#y&&this.#r&&this.#r.length>0}}{constructor(e,t){super(e,t)}}class Ye extends class{id="";name="";available=!0;cupSizes=[];description=null;flavors=[];headline="";hidePrice=!1;image_alt_text="";image="";inStock=!0;internationalId="";internationalName="";legacyId="";maxOrderQuantity=null;packagingType=null;price=null;pushRatingEnabled=!1;ranges=[];salesMultiple=null;technologies=[];type="";unitQuantity=50;url="";labels=[];category_name="";constructor(e){if(this.id=e.id||this.id,this.name=e.name||this.name,this.available=e.available||this.available,this.cupSizes=e.cupSizes||this.cupSizes,this.description=e.description||this.description,this.flavors=e.flavors||this.flavors,this.headline=e.headline||this.headline,this.hidePrice=e.hidePrice||this.hidePrice,this.image_alt_text=e?.image?.altText||this.image_alt_text,this.image=e?.image?.url||this.image,this.inStock=e.inStock||this.inStock,this.internationalId=e.internationalId||this.internationalId,this.internationalName=e.internationalName||this.internationalName,this.legacyId=e.legacyId||this.legacyId,this.maxOrderQuantity=e.maxOrderQuantity||this.maxOrderQuantity,this.packagingType=e.packagingType||this.packagingType,this.price=e.price||this.price,this.pushRatingEnabled=e.pushRatingEnabled||this.pushRatingEnabled,this.ranges=e.ranges||this.ranges,this.salesMultiple=e.salesMultiple||this.salesMultiple,this.technologies=e.technologies||this.technologies,this.type=e.type||this.type,this.unitQuantity=e.unitQuantity||this.unitQuantity,this.url=e.url||this.url,null!=e.labels)try{this.labels=e.labels.map((e=>JSON.parse(e)))}catch(e){console.error("Wrong JSON format in HMC label categories capsule-range-label",e)}const t=e.categoryId?e.categoryId.split("/"):[""];this.category_name=t[t.length-1]}}{collections="";types="";strikethrough_price="";additional_message="";additional_message_icon="";additional_message_link={};constructor(e){super(e),this.collections=e.collections,this.types=e.types,this.strikethrough_price=e.strikethrough_price||this.strikethrough_price,this.additional_message=e.additional_message||this.additional_message,this.additional_message_icon=e.additional_message_icon||this.additional_message_icon,this.additional_message_link=e.additional_message_link||this.additional_message_link}}var Qe=(e,t,s,i,n=null,r=[])=>{if(!e.data)return[];let a=r;const{categories:o,productGroups:l,enabledTechnologies:c}=e.data.configuration.eCommerceData;r&&r.length||(a=e.data.configuration.eCommerceData.products);const{translations:d}=e.data.configuration;(({categories:e,productGroups:t,products:s})=>{const i=re(e),n=t.filter((e=>i.some((t=>t.id===e.categoryId))));n.forEach((e=>{const t=i.find((t=>t.id===e.categoryId));e.productIds.forEach((e=>{const i=s.find((t=>t.id===e));i.labels=i.labels||[],i.labels.push(t.description)}))})),n.forEach((e=>{const s=t.findIndex((t=>t.categoryId===e.categoryId));t.splice(s,1)}))})({categories:o,productGroups:l,products:a});const u=[];t.categories=t.copywriting?t.copywriting.categories:t.categories,o.forEach((e=>{const n=t.categories.find((t=>t.category_id===e.id)),r=new s(e,n);l.forEach((s=>{s.categoryId===e.id&&s.productIds.forEach((s=>{const n=a.find((e=>e.id===s));if(!n)return;n.categoryId=e.id;const o=new i(n,t);r.products.push(o)}))})),r.isProductCategory()&&u.push(r)}));const h=t.copywriting?t.copywriting.nav_links:t.nav_links,p=t.copywriting?t.copywriting.navigation_bubbles.bubbles:t.navigation_bubbles.bubbles,b=((e,t)=>{const s="gran-lungo-vertuo-capsule",i="brand_coffee_capsule_pro",n=e=>e.map((({id:e,url:t,name:s,isSelected:i})=>({link:t,label:s,seo_label:s,icon_left:r(e.split("/").pop()),selected:i}))),r=e=>{switch(e){case"vertuo":return s;case"pro":return i;default:return"original"}};if(!e.length&&t.length)return n(t);if(!t.length)return e;const a=[...e].filter((e=>{if("coffee"!==e.icon_left&&e.icon_left!==s&&e.icon_left!==i)return e}));return[...n(t),...a]})(h,c);let m;return m=n?n(t):((e,t,s)=>{const i=t.map((e=>e.categoryId)),n=[],r=e.map((e=>{const t={...e,link:e.link.replace("#","")};if(i.includes(t.link))return t})).filter((e=>void 0!==e));return i.forEach((e=>{const t=r.find((({link:t})=>t===e));if(t)n.push(t);else{const t=s.find((t=>t.id===e));if(t){const{name:e,id:s,icon:i}=t,r={link:s,tracking_label:e,label:e,visual:{src:i?.url||"",alt:i?.altText||e}};n.push(r)}}})),n})(p,l,o),{categories:u,translations:d,enabledTechnologies:c,categoriesExtraData:o,nav_links:b,bubbles:m}},Je=(e,t)=>{const{products:s}=e.data.configuration.eCommerceData;return s.forEach((e=>{const s=t.products&&t.products.find((t=>t.sku&&t.sku===e.legacyId));s&&(e.strikethrough_price=s.strikethrough_price,e.additional_message=s.additional_message,e.additional_message_icon=s.additional_message_icon,e.additional_message_link=s.additional_message_link||{},s.api_override&&(e.name=s.api_override.name||e.name,e.headline=s.api_override.headline||e.headline,e.description=s.api_override.description||e.description))})),Qe(e,t,Ke,Ye)};class Xe{#k="";#w="";#E={};#C={};#L="";#$=[];#S="</fieldset/>";#O=`<fieldset><legend class='${u.is.mobile?"t-sm-700-sl":"t-md-700-sl"}'>{title}</legend>`;constructor(e){this.#k=e.type,this.#w=e.key,this.#E=e.iconFn?e.iconFn:null,this.#C=e.filterFn?e.filterFn:null;const t=e.title?e.title.toLowerCase():"Filter";this.#L=t.charAt(0).toUpperCase()+t.slice(1),this.#O=e.before?e.before:this.#O,this.#S=e.after?e.after:this.#S}set values(e){this.#$=e}set after(e){this.#S=e}get after(){return this.#S}get values(){return this.#$}get type(){return this.#k}get filterFn(){return this.#C}get iconFn(){return this.#E}get key(){return this.#w}renderBefore(){return this.#O.replace("{title}",this.#L)}renderAfter(){return this.#S}pushValues(e){-1===(()=>this.#$.findIndex((t=>t.value===e.value)))()&&this.#$.push(e)}}class Ze{#A=null;#T=null;#P=null;#N=null;#l="";#x="";#I=!1;#M=!1;constructor({value:e,label:t,filterType:s,filterKey:i,icon:n="",color:r="",selected:a=!1,disabled:o=!1}){e?t?s?i?(this.#A=e,this.#T=t,this.#P=s,this.#N=i,this.#l=n,this.#x=r,this.#I=a,this.#M=o):console.error("DefaultFilterChipType: filterKey is required"):console.error("DefaultFilterChipType: filterType is required"):console.error("DefaultFilterChipType: label is required"):console.error("DefaultFilterChipType: value is required")}set disabled(e){this.#M=!!e}set selected(e){this.#I=!!e}get filterType(){return this.#P}get value(){return"object"==typeof this.#A?this.#A.join(","):this.#A}get label(){return this.#T}get color(){return this.#x}render(){return`<nb-chip\n                  data-filter-value="${this.#A}"\n                  data-filter-key="${this.#N}"\n                  data-filter-label="${this.#T}"\n                  checked="${this.#I}"\n                  disabled="${this.#M}"\n                  ${this.#l?`icon="${this.#l}"`:""}\n                  ${this.#x?`color="${this.#x}"`:""}\n                >${this.#T}</nb-chip>`}}const et=(e,t,s)=>((e,t,s)=>{if(!t)return console.error("createFilter.js No categories found in the data"),[];if(!e)return console.error("createFilter.js No Filter definition found in the variables"),[];const i=[];return e.forEach((e=>{i.push(new Xe(e))})),t.reduce(((e,t)=>e.concat(t.products)),[]).map((e=>{i.forEach((t=>{"object"==typeof e[t.key]?e[t.key].map((e=>{const i=((e,t)=>{const s=e.find((e=>e.id===t));return s?{label:s.name,color:s.cssColorCode?s.cssColorCode:null,icon:s.icon?.icon}:null})(s,e);i&&t.pushValues(new Ze({value:e,label:i.label,filterType:t.type,filterKey:t.key,icon:t.iconFn&&t.iconFn(e),color:i.color?i.color:null}))})):t.pushValues(new Ze({value:e[t.key],label:"function"==typeof t.filterFn?t.filterFn(e[t.key]):e[t.key],filterType:t.type,filterKey:t.key,icon:t.iconFn&&t.iconFn(t.key)}))}))})),i})([{type:"default",key:"collections",title:"COLLECTION"},{type:"default",key:"types",title:"TYPE"}],e,s),tt=e=>[{id:"default",label:e.dropdown_recommended_option_label,key:"recommended",order:"asc",checked:!0},{id:"sortPriceAscending",label:e.dropdown_price_ascending_option_label,key:"price",order:"asc",checked:!1},{id:"sortPriceDescending",label:e.dropdown_price_descending_option_label,key:"price",order:"desc",checked:!1},{id:"sortNameAscending",label:"Nombre A-Z",key:"name",order:"asc",checked:!1},{id:"sortNameDescending",label:"Nombre Z-A",key:"name",order:"desc",checked:!1}];class st extends Ue{constructor(){super(),this.plpType="accessory",this.dataTransformService=Je,this.dataFiltersService=et,this.dataSortService=tt}}customElements.get("nb-plp-accessory")||customElements.define("nb-plp-accessory",st);export{e as B,r as E,Ee as F,a as N,$e as P,Le as S,Ce as a,we as b,s as c,i as d,st as e,Re as h};
