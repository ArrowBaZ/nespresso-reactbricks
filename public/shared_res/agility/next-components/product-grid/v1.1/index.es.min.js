const e=e=>{const n=(e=>e.find((e=>"data"===e.nodeName)))([...e]),i=[...e].filter((e=>"data"!==e.nodeName)).reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{});if(t(n))return i;try{return{...i,...JSON.parse(n.nodeValue)}}catch(e){console.log("ERROR: No data",e)}},t=e=>null==e;class n extends HTMLElement{constructor(){super(),this.props={},this.labels=[]}connectedCallback(){this.props=e(this.attributes),this.render()}render(){const{labels:e=[],direction:t="column"}=this.props;if(this.classList.add(""+("row"===t?"direction-row":"direction-"+t)),0===e.length)return"";this.labels=e,this.innerHTML=`${this.renderLabels()}`}renderLabels(){return this.labels.map((e=>{const{name:t="",bgColor:n="",color:i=""}=e;return`<mark class="t-3xs-500"\n                            ${n&&i&&`style="background: ${n}; color: ${i}"`}>\n                            <span aria-hidden="true">${t}</span>\n                            <span class="sr-only">${t}</span>\n                        </mark>`})).join("")}}customElements.get("nb-card-labels")||customElements.define("nb-card-labels",n);const i=()=>{const e=window[window?.padlNamespace]?.dataLayer;return e?e.app.app.market.toLocaleLowerCase():"ch"},s={fair_trade:"https://www.nespresso.com/shared_res/agility/commons/img/icons/fairTrade.svg",is_organic:function(){let e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-eu.svg";switch(i()){case"us":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-us.svg";break;case"ca":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-ca.svg";break;case"br":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-br.svg";break;case"jp":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-jp.svg";break;case"be":e="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-be.png"}return e}(),only_vertuo_next:"https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-only-vertuo-next.svg",is_q_certified_arabica:"https://www.nespresso.com/shared_res/agility/commons/img/icons/q_grade_certification_arabica.svg",is_rainforest:"https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-rainforest.svg",is_sustainable:"https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-sustainability.svg",is_design_award_2021:"https://www.nespresso.com/shared_res/agility/commons/img/icons/design_award_2021.svg"};class a extends HTMLElement{constructor(){super(),this.props={}}connectedCallback(){this.props=e(this.attributes),this.render()}render(){let e,t,n,i,a,r,o,l,c,d,h,p,{direction:u="row",logos:_}=this.props;this.classList.add(""+("column"===u?"direction-column":"direction-"+u));let g=[];null==_?(e=this.props?.fair_trade,t=this.props?.alt_fair_trade,n=this.props?.is_organic,i=this.props?.alt_organic,a=this.props?.only_vertuo_next,r=this.props?.alt_vertuo_next,o=this.props?.is_rainforest,l=this.props?.alt_rainforest,c=this.props?.is_sustainable,d=this.props?.alt_sustainable,h=this.props?.is_q_certified_arabica,p=this.props?.alt_q_certification_arabica):void 0===_.length?(e=_?.fair_trade,t=_?.alt_fair_trade,n=_?.is_organic,i=_?.alt_organic,a=_?.only_vertuo_next,r=_?.alt_vertuo_next,o=_?.is_rainforest,l=_?.alt_rainforest,c=_?.is_sustainable,d=_?.alt_sustainable,h=_?.is_q_certified_arabica,p=_?.alt_q_certification_arabica):_.length&&(g=[..._]),[[e,"fair_trade",t,g],[n,"is_organic",i,g],[a,"only_vertuo_next",r,g],[o,"is_rainforest",l,g],[c,"is_sustainable",d,g],[h,"is_q_certified_arabica",p,g]].map((e=>this.appendLogo.apply(this,e))),this.innerHTML=g.map((e=>`<img src="${s[e.name]}" alt="${e.alt}" loading="lazy">`)).join("")}appendLogo(e,t,n,i){e&&!this.hasLogo(i,t)&&i.push({name:t,alt:n})}hasLogo(e,t){return e.some((e=>e.name===t))}}customElements.get("nb-card-logos")||customElements.define("nb-card-logos",a);class r extends HTMLElement{constructor(){super(),this.props={},this.level="",this.levelPlus=""}connectedCallback(){this.props=e(this.attributes),this.render()}render(){const{a11y_label:e,level:t}=this.props;if(""===e||""===t)return"";switch(this.classList.add(`level_${t}`),t){case"g":this.level="G";break;case"f":this.level="F";break;case"e":this.level="E";break;case"d":this.level="D";break;case"c":this.level="C";break;case"b":this.level="B";break;case"a4":this.level="A";break;case"a3":this.level="A",this.levelPlus="+";break;case"a2":this.level="A",this.levelPlus="++";break;default:this.level="A",this.levelPlus="+++"}this.innerHTML=`\n            <mark aria-label='${e} ${this.level}${this.levelPlus}'>\n                ${this.level}\n                ${""!==this.levelPlus?`<sup>${this.levelPlus}</sup>`:""}\n            </mark>\n        `}}customElements.get("nb-energy-label")||customElements.define("nb-energy-label",r);class o extends HTMLElement{constructor(){super(),this.props={}}connectedCallback(){this.props=e(this.attributes),this.render()}render(){const{intensity_label:e="Intensity",a11y_intensity_max:t,max_intensity:n}=this.props,i=parseInt(this.props.intensity);if(!i||isNaN(i))return"";const s=t.replace("{max_intensity}",n);this.innerHTML=`\n            <div aria-label="${e} ${i} ${s}">\n                ${e}${this.renderIntensityMin(i)}\n                ${i}\n                ${this.renderIntensityMax(i)}\n            </div>\n        `}renderIntensityMin(e){return new Array(Math.max(e,0)-0).fill('<span class="bar filled"></span>').join("")}renderIntensityMax(e){let{max_intensity:t}=this.props;return t&&"undefined"!==t||(t=14),new Array(parseInt(t)-Math.min(e,parseInt(t))).fill('<span class="bar"></span>').join("")}}function l(e,t,n,i,s){const a=(t,n)=>{e.setAttribute(t,n);const a=()=>e.classList.add("lazy-loaded");if(i){const t=new Image;return t.src=i,t.onload=a,void(t.onerror=()=>{s&&s(`Image ${i} cannot be loaded.`),e.classList.add("lazy-loaded-error")})}a()};if(/Trident\/|MSIE/.test(window.navigator.userAgent)||(r=window.navigator.userAgent,o=r.indexOf("OS "),(r.indexOf("iPhone")>-1||r.indexOf("iPad")>-1)&&o>-1&&window.Number(r.substr(o+3,3).replace("_","."))<14))a(t,n);else if("IntersectionObserver"in window){e.classList.add("lazy-load");let i=new IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting&&(a(t,n),i.unobserve(e.target))}))}));i.observe(e)}else a(t,n);var r,o}function c(e,t,n,i){let s=0;for(;e;){const a=e.indexOf(n,s);if(-1===a)break;const r=e.indexOf(i,a+1);if(-1===r)break;const o=e.substring(a+n.length,r);null!=t[o]?(e=e.substr(0,a)+t[o]+e.substr(r+i.length),s=a):s=r}return e}customElements.get("nb-intensity")||customElements.define("nb-intensity",o);const d=e=>h(JSON.stringify(e)),h=e=>e?e.toString().replace(/"/g,"&quot;").replace(/'/g,"&apos;"):"",p=(e,t)=>{for(let n in t)e.setAttribute(n,t[n])};class u extends HTMLElement{constructor(){super(),this.template=""}connectedCallback(){this.props=this._createProps(),this.onStart?.(),this.loadTemplate(),this.onReady?.()}_createProps(e=null){const t=e||this.attributes;let n;try{n=[...t].reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{});const e=[...t].find((e=>"data"===e.nodeName));return null==e?n:{...n,...JSON.parse(e.nodeValue)}}catch(e){console.log("ERROR: No data",e)}}render(e=!1){e&&(this.innerHTML="");const t=(e,n)=>{const i=e=>3===e.nodeType?"text":8===e.nodeType?"comment":e.tagName.toLowerCase(),s=e=>e.childNodes&&e.childNodes.length>0?null:e.textContent;var a=Array.prototype.slice.call(n.childNodes),r=Array.prototype.slice.call(e.childNodes),o=a.length-r.length;if(o>0)for(;o>0;o--)a[a.length-o].parentNode.removeChild(a[a.length-o]);r.forEach((function(e,r){if(a[r])if(i(e)===i(a[r])){var o=s(e);if(o&&o!==s(a[r])&&(a[r].textContent=o),a[r].childNodes.length>0&&e.childNodes.length<1)a[r].innerHTML="";else{if(a[r].childNodes.length<1&&e.childNodes.length>0){var l=document.createDocumentFragment();return t(e,l),void a[r].appendChild(l)}e.childNodes.length>0&&t(e,a[r])}}else a[r].parentNode.replaceChild(e.cloneNode(!0),a[r]);else n.appendChild(e.cloneNode(!0))}))},n=(i=this.template,(new DOMParser).parseFromString(i,"text/html").body);var i;t(n,this)}loadTemplate(e="",t=!1){this.template=""===e?this.template:`${e}`,this.render(t)}disconnectedCallback(){this.onDestroy?.()}}customElements.get("nb-nespresso-element")||customElements.define("nb-nespresso-element",u);const _={get is(){const{innerWidth:e,devicePixelRatio:t}=window;return{mobile:e<768,mobile_tablet:e<1024,tablet:e>=768&&e<1024,desktop:e>=1024&&t<=1,retina:e>=1024&&t>1}},lt:e=>window.innerWidth<e};const g=({eventName:e,args:t,element:n})=>{let i;n=n||window,t?i=new CustomEvent(e,{detail:t,bubbles:!0}):"function"==typeof Event?i=new Event(e):(i=document.createEvent("Event"),i.initEvent(e,!0,!0)),n.dispatchEvent(i)};let m,b="";const v=e=>{y(e),e.bundlePopIn=document.getElementById("bundle-popin-id"),e.appendChild(e.bundlePopIn),p(e.bundlePopIn,{variation:"before",bgcolor:"white",size:"L",padding:"false",label_close:m,content:b}),e.bundlePopIn.classList.add("nb-popin--bundle"),g({eventName:"WEB_COMPONENT_POPIN_OPEN",args:{id:"bundle-popin-id"}})},y=e=>{if(null!=document.getElementById("bundle-popin-id"))return;let t=document.createElement("nb-popin");t=e.appendChild(t),t.setAttribute("id","bundle-popin-id"),t.setAttribute("content","")};function f({icon:e,text:t}){return`<nb-icon-text data="${d({icon:e,label:t,classname:"t-xs-500"})}"></nb-icon-text>`}const k=({price:e,giftcard_price:t,type:n,hidePrice:i})=>!e||"giftcard"===n&&!t||i?"":`<p class="cn_card__priceWrapper--current"><span>${e}</span></p>`,w=e=>window.napi.catalog().getProduct(e);function $(e){return e.sales_multiple=e.sales_multiple||e.salesMultiple,!(e.sales_multiple>1&&1===e.unitQuantity)&&(1===e.sales_multiple&&e.unitQuantity>1)}const x=async e=>{const t=await(async()=>await window.napi.priceFormat())(),n=window[window.config.padl.namespace].dataLayer.app.app.currency;return t.html?t.html(n,e):t.short(n,e)||""},E=e=>{const{sales_multiple:t,label_sleeve:n,label_sleeves:i,show_sleeve:s=!1,sleeve_syntax:a="{numberOfSleeves} {sleeveLabel} ({quantity} {label_capsules})",number_of_sleeves:r,label_capsules:o,type:l,bundled:d,unit_quantity:h,unitQuantity:p}=e,u=r,_=u>1&&i?i:n,g=!1===d?t:h||p||0;let m;return s&&"capsule"===l&&u&&n&&o?(m=a,`<p class="cn_card__priceWrapper--items showSleeve">${c(m,{numberOfSleeves:u,sleeveLabel:_,quantity:g,label_capsules:o,label_sleeve:n},"{","}")}</p>`):""};async function C(e){const{in_stock:t,strikethrough_price:n,hide_add_to_cart:i=!1}=e,s=null!=t&&!t;return!0===i?"":`\n        <div class="cn_card__priceWrapper">\n            <div class="cn_card__priceInnerWrapper">\n                ${n?await(async e=>e?`<p class="cn_card__strikethroughPrice">${await x(e)}</p>`:"")(n):""}\n                ${k(e)}\n                ${s?"":E(e)}\n                ${s?"":(e=>{const{show_capsule_price:t=!1,price_per_capsule:n,capsule_price_label:i,capsule_price_syntax:s="{capsule_price_label}: {price_per_capsule}"}=e;return t?`<p class="cn_card__priceWrapper--items capsulePrice">${c(s,{capsule_price_label:i,price_per_capsule:n},"{","}")}</p>`:""})(e)}\n                ${(({type:e,price:t,price_per_capsule:n,a11y_price:i="euros per sleeve",a11y_capsule_price:s="Capsule price",sleeve_variation_pdp:a="false"})=>`<span class="sr-only">\n      ${"true"===a?"capsule"===e?`${s}: ${n}`:"":`${t} ${i}`}\n    </span>`)(e)}\n                ${s?(e=>{const{label_outofstock:t}=e.shop_similar;return""===t?"":`<p class="cn_card__priceWrapper--items t-xs-500-sl">${t}</p>`})(e):""}\n            </div>\n            ${(e=>{const{category_name:t="",type:n,sku:i,longSku:s="",position:a,giftcard_price:r,variation:o="plp",quantity_selector:l,hidePrice:c,url:h,view_details_label:p="View details"}=e;let u="large";if("plp"===o&&(u=_.is.mobile?"small":"large"),"giftcard"===n&&r)return`<nb-add-gift-card data="${d({price:r,sku:i,add_to_cart:u,quantity_selector:l})}"></nb-add-gift-card>`;return c?`<nb-cta link="${h}" variation="primary">${p}</nb-cta>`:`\n        <nb-add-to-cart\n            sku="${i}"\n            longSku="${s}"\n            buttonSize="${u}"\n            showPrice\n            range='${t}'\n            position='${a}'\n        ></nb-add-to-cart>\n    `})(e)}\n        </div>`}class L{constructor(e){this._carousel=e,this._carousel._container.addEventListener("dragstart",(e=>e.preventDefault())),this._carousel._container.addEventListener("touchstart",(e=>this.startDrag(e)),{passive:!0}),this._carousel._container.addEventListener("mousedown",(e=>this.startDrag(e))),this._carousel._container.addEventListener("touchstart",(e=>this.startDrag(e)),{passive:!0}),window.addEventListener("mousemove",(e=>this.drag(e)),{passive:!1}),window.addEventListener("touchmove",(e=>this.drag(e)),{passive:!1}),window.addEventListener("mouseup",(()=>this.endDrag())),window.addEventListener("touchend",(()=>this.endDrag())),window.addEventListener("touchcancel",(()=>this.endDrag())),this.translateFactor=150}startDrag(e){e.touches&&e.touches.length>1||(e.touches&&(e=e.touches[0]),this._origin={x:e.screenX,y:e.screenY},this._width=this._carousel.containerWidth)}drag(e){if(!this._origin)return;const t=e.touches?e.touches[0]:e,n={x:t.screenX-this._origin.x,y:t.screenY-this._origin.y};this._lastTranslate=n;const i=this._carousel._currentIndex*this._carousel._widthSlide-this.translateFactor*n.x/this._width;this._carousel.translate(i)}preventMobileYTranslate(e,t){e.touches&&(e.touches&&Math.abs(t.x)>Math.abs(t.y)||e.touches&&Math.abs(t.y)>Math.abs(t.x))&&(e.preventDefault(),e.stopPropagation())}endDrag(){if(!this._origin||!this._lastTranslate)return this._origin=null,void(this._lastTranslate=null);const e=this._lastTranslate.x/this._carousel.carouselWidth;if(Math.abs(e)>.1){const e=this._lastTranslate.x<0?"next":"prev";this._carousel[e]()}else this._carousel.goToItem(this._carousel._currentIndex);this._origin=null,this._lastTranslate=null}}class S{constructor(e){this._carousel=e,new MutationObserver((e=>{e.forEach((function(e){if(!e||!e.oldValue||!e.classList)return;const t=e.classList.contains("has-overlay-absolute"),n=document.body.classList.contains("has-overlay");t&&!n&&this._carousel.goToItem(this._carousel._currentIndex)}))})).observe(document.body,{attributes:!0,attributeFilter:["class"],attributeOldValue:!0})}}class P{constructor(e,t={}){this._element=e,this._slides=[].slice.call(e.children);const n=t.index||0;this._options=Object.assign({},{slidesToScroll:1,slidesVisible:1,spaceBetween:0,navigationButton:!0,loop:!0,pagination:!0,hookGetRightBoundary:null,hookSlideChange:null,hookMove:null,hookNext:null,hookPrevious:null,pagination_variation:null,nav_centered:!1},t),this.moveCallbacks=[],this._ratio=this._slides.length/this._options.slidesVisible,this.buildIHM(),new S(this),this.hasPagination()&&(new L(this),this.goToItem(n))}get element(){return this._element}get slidesToScroll(){return this._options.slidesToScroll}get slidesVisible(){return this._options.slidesVisible}get slidesTotal(){return this._slides.length}get navigationButton(){return this._options.navigationButton}get navigationVariation(){return this._options.navigation_variation}get navigationSize(){return this._options.navigation_size}get loop(){return this._options.loop}get pagination(){return this._options.pagination}get containerWidth(){return this._container.offsetWidth}get carouselWidth(){return this._root.offsetWidth}get wrapperWidth(){return this._wrapper.offsetWidth}get paginationVariation(){return this._options.pagination_variation}get nav_centered(){return this._options.nav_centered}getSlideWidth(e){const{slidesVisible:t,spaceBetween:n}=this._options;return(e+parseInt(n))/t}buildIHM(){this._root=this.createElement("div","carousel"),this._container=this.createElement("div","container"),this._wrapper=this.createElement("div","wrapper"),this._children=this._slides.map((e=>{const t=this.createElement("div","item");return t.appendChild(e),this._container.appendChild(t),t})),this._wrapper.appendChild(this._container),this._root.appendChild(this._wrapper),this._element.appendChild(this._root),this.setWrapperStyle(),this.hasPagination()&&(this.navigationButton&&this.createNavigation(),this.pagination&&this.createPagination())}setWrapperStyle(){const e=this.wrapperWidth,t=this.getSlideWidth(e),n=t*this._children.length;this.setContainerWidth(n),this.setWrapperWidth(e);for(const e of this._children)this.setSlideWidth(e,t);this._widthContainer=n,this._widthSlide=t,this._widthWrapper=e}setSlideWidth(e,t){e.style.width=t-this._options.spaceBetween+"px",this._options.spaceBetween&&(e.style.marginRight=`${this._options.spaceBetween}px`)}setContainerWidth(e){this._container.style.width=`${e}px`}setWrapperWidth(e){this._wrapper.style.width=`${e}px`}disableTransition(){this._container.style.transition="none"}enableTransition(){this._container.style.transition=""}translate(e){this._container.style.left=-e+"px"}createElement(e,t){let n=document.createElement(e);return n.setAttribute("class",t),n}createNavigation(){const e=this.createElement("nb-cta","prev");e.setAttribute("variation","navigation"),e.setAttribute("contrast",this.navigationVariation),e.setAttribute("size",this.navigationSize),e.setAttribute("icon_right","chevron-left"),e.setAttribute("label","a11y_slider_previous_button");const t=this.createElement("nb-cta","next");t.setAttribute("variation","navigation"),t.setAttribute("contrast",this.navigationVariation),t.setAttribute("size",this.navigationSize),t.setAttribute("icon_right","chevron-right"),t.setAttribute("label","a11y_slider_next_button"),t.addEventListener("click",(()=>this.next())),e.addEventListener("click",(()=>this.prev())),t.addEventListener("keydown",(e=>"Enter"===e.key||"Space"===e.key?this.next():null)),e.addEventListener("keydown",(e=>"Enter"===e.key||"Space"===e.key?this.prev():null));let n=this._root.parentElement;n.appendChild(e),n.appendChild(t),this.onMove((n=>{const i=n._currentIndex+this.slidesVisible;this.loop||(n._currentIndex<=0?e.classList.add("hidden"):e.classList.remove("hidden"),this._slides.length===i?t.classList.add("hidden"):t.classList.remove("hidden"),this._options.hookMove&&this._options.hookMove(t))}))}getSlideNotVisible(){return this._children.length-(this.slidesVisible-1)}hasPagination(){return this.getSlideNotVisible()>1}createPaginationBullets(){const e=document.createElement("nav"),t=[];for(let n=0;n<this.getSlideNotVisible();n+=this.slidesToScroll){let i=document.createElement("span");i.innerText=(n+1).toString();let s=document.createElement("button");s.addEventListener("click",(()=>this.goToItem(n))),s.appendChild(i),e.appendChild(s),t.push(s)}const n=e=>{let n=t[e/this.slidesToScroll];n&&(t.forEach((e=>e.classList.remove("active"))),n.classList.add("active"))};n(this._currentIndex),this.onMove((()=>n(this._currentIndex))),this._root.parentElement.parentElement.appendChild(e)}createPaginationStepper(){const e=document.createElement("nav");let t=document.createElement("div");t.innerText=this.slidesTotal-this.slidesVisible+1,t.classList.add("totalPages");let n=document.createElement("div");n.innerText="/";let i=document.createElement("div");i.classList.add("currentPage"),e.appendChild(i),e.appendChild(n),e.appendChild(t),this.onMove((()=>i.innerText=this._currentIndex+1)),this.onMove((()=>e.setAttribute("aria-label",i.innerText+" "+n.innerHTML+" "+t.innerHTML))),this._root.parentElement.parentElement.appendChild(e)}createPagination(){this.slidesTotal<=5?this.createPaginationBullets():"stepper"===this.paginationVariation?(this.createPaginationStepper(),console.info("paginationVariation >> enabled")):(this.createPaginationBullets(),console.info("bullets enabled"))}next(){let e=this._currentIndex+this.slidesToScroll;this._options.hookNext&&(e=this._options.hookNext(e)),this.goToItem(e)}prev(){let e=this._currentIndex-this.slidesToScroll;this._options.hookPrevious&&(e=this._options.hookPrevious(e)),this.goToItem(e)}goToItem(e){this.hackUi();const t=this.getOverflowingIndex(e);let n=t*this._widthSlide;this._options.hookSlideChange&&(n=this._options.hookSlideChange(t,n)),this.translate(n),this._currentIndex=t,this.indexHasChange()}hackUi(){const e=document.querySelector("html");!e.classList.contains("has-overlay-absolute")&&e.classList.contains("has-overlay")}getOverflowingIndex(e){const t=this.getLeftBoundary(e),n=this.getRightBoundary(e),i=this._children.length-this._options.slidesVisible;return t?this.loop?i:0:n?this.loop?0:i:e}getLeftBoundary(e){return e<0}getRightBoundary(e){const t=e>=this._children.length,n=this.currentIndex+this.slidesVisible,i=void 0!==this._children[n],s=e>this.currentIndex;let a=t||s&&!i;return this._options.hookGetRightBoundary&&(a=this._options.hookGetRightBoundary(a,e)),a}_getMaxSlideWidth(e){return e.reduce(((e,t)=>Math.max(e,t.offsetWidth)),0)}onSlideChange(e){this.onMove(e)}onMove(e){this.moveCallbacks.push(e)}indexHasChange(){this.moveCallbacks.forEach((e=>e(this))),this.activateItems()}activateItems(){const e=this._currentIndex+this.slidesVisible;this._slides.map(((t,n)=>{t.classList.remove("active"),t.parentElement.classList.remove("activeParent"),n>=this._currentIndex&&n<e&&(t.classList.add("active"),t.parentElement.classList.add("activeParent"))}))}setClass(e){this._element.classList.add(e)}unsetClass(e){this._element.classList.remove(e)}get currentIndex(){return this._currentIndex}}window.gtmDataObject=window.gtmDataObject||[];const T=e=>{window.gtmDataObject.push({event:"impression",eventRaisedBy:"Web component",eventAction:"Promo Impression - On Scroll",ecommerce:{},...e})};class I extends HTMLElement{constructor(){super(),this._slider=null,this.randomId="slider_"+function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=n.length,s=0;s<e;s++)t+=n.charAt(Math.floor(Math.random()*i));return t}(5)}static get observedAttributes(){return["slides_to_scroll","slides_visible","pagination","pagination_variation","nav_centered"]}connectedCallback(){this.slot=this.innerHTML,this.props=e(this.attributes),this.render()}createProps(){return[...this.attributes].reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{})}render(){this.innerHTML=`<div class="slider ${this.randomId}">${this.slot}</div>`,this.loadSlider()}loadSlider(){const{indexSlider:e=0,slides_loop:t="true",slides_visible:n=4,slides_to_scroll:i=1,navigation:s="true",pagination:a="true",space_between:r=0,navigation_variation:o="dark",navigation_size:l="48",pagination_variation:c="stepper",nav_centered:d="false"}=this.props,h=this.querySelector(`.${this.randomId}`),p={index:parseInt(e),slidesToScroll:parseInt(i),slidesVisible:parseInt(n),spaceBetween:r,loop:"true"===t,navigationButton:"true"===s,pagination:"true"===a,navigation_variation:o,navigation_size:l,pagination_variation:c,nav_centered:d};this._slider=new P(h,p),this._slider.setClass("first"),this._slider.onSlideChange(this.handleClick.bind(this))}handleClick(){var e;g({eventName:"WEB_COMPONENT_SLIDE_CHANGE"}),this.toggleClasses(),e={rootElement:["nb-slider"]},window.gtmDataObject.push({event:"itemDisplay",eventRaisedBy:"Web component",eventAction:"Click",itemTypes:["products"],...e})}toggleClasses(){const e=0===this._slider.currentIndex,t=this._slider.slidesTotal===this._slider.currentIndex+this._slider.slidesVisible;this._slider.unsetClass("last"),this._slider.unsetClass("first"),e?this._slider.setClass("first"):t&&this._slider.setClass("last")}}customElements.get("nb-slider")||customElements.define("nb-slider",I);class M extends HTMLElement{constructor(){super(),this.props={}}connectedCallback(){this.props=e(this.attributes),this.render()}render(){const{slides:e,image_alt_text:t}=this.props;let n=document.createElement("nb-slider");p(n,{slides_to_scroll:"1",slides_visible:"1",navigation:"true",navigation_variation:"highlight",navigation_size:"32",pagination:"true"});let i=document.createElement("nb-loader");p(i,{icon:"loading"}),this.appendChild(i);e.forEach((e=>{const i=`${e.url}?impolicy=product&imwidth=600`;let s=document.createElement("img");s.setAttribute("alt",t),s.setAttribute("title",t),s.setAttribute("data-src",i),n.appendChild(s)})),this.appendChild(n),e.forEach((e=>{const t=`${e.url}?impolicy=product&imwidth=600`;l(n.querySelector(`img[data-src="${t}"]`),"src",t,t)}))}}customElements.get("nb-product-card-image-slider")||customElements.define("nb-product-card-image-slider",M);function N({type:e,show_slider:t,slides:n,image:i,image_alt_text:s,plp_type:a},r){if(void 0===i||""===i||"pdp"===a)return"";const o=!r.is.mobile&&t&&n&&n.length>1;return("machine"===e||"machine"===a)&&o?function(e,t){return!e||e.length<=0?"":`<div class="cn_card__image">\n                <nb-product-card-image-slider\n                    data='${d({slides:e})}'\n                    image_alt_text=${t}>\n                </nb-product-card-image-slider>\n            </div>`}(n,s):function(e,t,n){return e?`<div class="cn_card__image">\n            ${n?`<a href="${n}" target="_self" aria-hidden="true" tabindex="-1">`:""}\n                <img class="cn_card__image__single" src=${e} alt="${t}"/>\n            ${n?"</a>":""}\n            </div>`:""}(i,s)}class A extends HTMLElement{async connectedCallback(){this.props=e(this.attributes),this.boundOnPDPLinkClick=this.onPDPLinkClick.bind(this),this.boundOnColorClick=this.onColorClick.bind(this),await this.render(),((e,t)=>{const{image:n=""}=e,i=t.querySelector("img.cn_card__image__single"),s="?impolicy=product&imwidth=150";i&&l(i,"src",`${n+s}`,n+s)})(this.props,this)}async render(){const{additional_message_icon:e,additional_message:t,category_name:n="",giftcard_price:i,hide_header:s,image:a,label_technology:r,label_range:o,labels:l=[],plp_type:c,position:h,rating_enabled:u=!1,show_ratings:g=!1,sku:v,src_page:y,type:w}=this.props;if("giftcard"===w&&!i)return null;!s&&a||this.classList.add("hide-header"),l.length&&this.classList.add("has-labels"),this.innerHTML=`\n            ${N(this.props,_)}\n            ${(({labels:e=[]})=>0===e.length?"":`<nb-card-labels data='${d({labels:e})}' direction="${_.is.mobile?"row":"column"}"></nb-card-labels>`)(this.props)}\n            ${((e,t)=>{const{fair_trade:n,alt_fair_trade:i,is_organic:s,alt_organic:a,only_vertuo_next:r,alt_vertuo_next:o,is_rainforest:l,alt_rainforest:c,is_sustainable:h,alt_sustainable:p,is_q_certified_arabica:u,alt_q_certification_arabica:_,logos:g}=e;return n||s||r||l||h||u||!(null==g||g.length<1)?(t.classList.add("has-logos"),`<nb-card-logos data='${d({fair_trade:n,alt_fair_trade:i,is_organic:s,alt_organic:a,only_vertuo_next:r,alt_vertuo_next:o,is_rainforest:l,alt_rainforest:c,is_sustainable:h,alt_sustainable:p,is_q_certified_arabica:u,alt_q_certification_arabica:_,logos:g})}'></nb-card-logos>`):""})(this.props,this)}\n            ${(({a11y_energy_label:e,energy_level:t})=>t?`<nb-energy-label data='${d({a11y_label:e,level:t})}'></nb-energy-label>`:"")(this.props)}\n            <div class="cn_card__content">\n                ${function(e){return e?`<p class="cn_card__technology t-xs-700">${e}</p>`:""}(r)}\n                ${function(e){return e?`<p class="cn_card__range t-xs-500">${e}</p>`:""}(o)}\n\n                ${(({url:e,a11y_product_card:t="",name:n="",label_decaffeinato:i,src_page:s=""},a)=>{const r=new RegExp(i,"ig"),o=i&&""!==i&&r.test(n);t=t.replace("{productName}",n),o?n=n.replace(r,"").trim():i="";const l="pdp"===s?"h1":"h3";return`${e?`<${l} class='cn_card__title'><a href="${e}" target="_self" title="${t}" aria-label="${t}">`:`<${l} class='cn_card__title'>`}\n${n}\n${i?`<span class='${a.is.mobile?"t-xs-700-caps":"t-sm-700-caps"}'>${i}</span>`:""}\n${e?`</a></${l}>`:`</${l}>`}`})(this.props,_)}\n                ${g&&u?'<div class="cn_card__rating"><nb-loader></nb-loader></div>':""}\n\n                ${function({headline:e="",is_headline_hidden:t=!1}){return""===e||t&&_.is.mobile?"":`<p class="cn_card__text">${e}</p>`}(this.props)}\n\n                ${"machine"===w?(({colors:e,sku:t,max_colors:n=4,a11y_extra_color:i="",url:s,activeSku:a,name:r})=>e?`<nb-colors data="${d({colors:e,max_colors:n,activeSku:a||t,extra_url:s,extra_title:r+", "+i})}" size="${_.is.mobile?"small":"large"}"></nb-colors>`:"")(this.props):""}\n                ${"machine"===w?function({features:e=[]}){return 0===e.length?"":`<div class="cn_card__features">${e.map(f).join("")}</div>`}(this.props):""}\n\n                ${"capsule"===w?(({type:e,bundle_details:t,bundled:n,sku:i,position:s,range:a},r)=>"capsule"===e&&t&&t.popin_link_text&&!0===n?(b=`<nb-bundle-details\n                main_sku='${i}'\n                description='${t.description}'\n                other_skus='${t.other_skus}'\n                other_skus_quantity= '${t.other_skus_quantity}'\n                range='${a}'\n                position='${s}'>\n            </nb-bundle-details>`,r.variation="white",m=t.popin_label_close,`<nb-link class="cn_card__cta__bundle" size="large" color="gold" label="${t.popin_link_text}"></nb-link>`):"")(this.props,this):""}\n                ${"capsule"===w?(({intensity:e,a11y_intensity_max:t,intensity_label:n=""})=>0===e||isNaN(parseInt(e))?"":`<nb-intensity\n        class="t-xs-500-sl"\n        intensity="${e}"\n        a11y_intensity_max="${t}"\n        intensity_label="${n}">\n    </nb-intensity>`)(this.props):""}\n\n                ${await C(this.props)}\n\n                ${"machine"===w?function(e){const{popin_id:t,subscription:n,view_details_label:i="View details"}=e;return void 0===n?"":`\n        <div class="cn_card__subscriptionWrapper">\n            ${k(e)}\n            <p class="t-sm-400">${n.text}</p>\n            <nb-cta class="cn_card__viewDetails" popin_id="${t}" variation="primary">${i}</nb-cta>\n        </div>\n        <nb-popin\n            id="${t}"\n            variation="before"\n            bgcolor="highlight"\n            size="L"\n            padding="false"\n            label_close="Close"\n            content="<nb-machine-details data='${d(e)}' />">\n        </nb-popin>\n    `}(this.props):""}\n\n                ${function(e,t){return t?`<p class="cn_card__additionalMessage t-sm-500-sl">\n        <nb-icon\n            icon="${e}"\n            class="additionalMsgIcon"\n        ></nb-icon> ${t}</p>`:""}(e,t)}\n            </div>\n        `,p(this,{"data-product-item-id":v,"data-product-section":n,"data-product-position":h,"data-src-page":y,"data-plp-type":c}),((e,t)=>{const{src_page:n,plp_type:i}=e;"plp"===n?"coffee"===i&&_.is.mobile?t.setAttribute("theme","landscape"):t.setAttribute("theme","portrait"):t.setAttribute("theme","pdp")})(this.props,this),this.bundlePopinLink=this.querySelector(".cn_card__cta__bundle button"),this.classList.add("cn_card"),this.bindEvent(),g&&u&&(({sku:e,minimum_rating:t=0},n)=>{if(!window.napi.ratings)return"";window.napi.ratings().summary(e).then((e=>e&&e.ratingAverage>0&&e.ratingAverage>t?e:"")).then((e=>e?{stars:e?parseFloat(e.ratingAverage.toFixed(2)):0}:"")).then((e=>{if(e){const t=document.createElement("nb-rating");t.setAttribute("stars",e?e.stars:0),n.querySelector("nb-loader").replaceWith(t)}else n.querySelector("nb-loader").remove()}))})(this.props,this.querySelector(".cn_card__rating"))}async onPDPLinkClick(){window.napi.data().product().setProductClickData(await window.productHelper.getPadlProductDetail(await window.napi.catalog().getProduct(this.props.lonGgSku)))}onColorClick(e){const t=(e=>{if(e.detail)return e.detail})(e);t.sku&&(this.template="<nb-loader></nb-loader>",this.render(),w(t.sku).then((e=>{e&&(this.props={...this.props,sku:e.internationalId||"",longSku:e.id||"",image:e.images?.icon||"",image_alt_text:e.name||"",price:e.price,activeSku:e.internationalId||""})})).catch((()=>{console.error(`getProduct fail on sku ${t.sku}`)})))}bindEvent(){this.linkElements=[],this.unbindEvent(),this.linkElements=this.querySelectorAll("a[href]"),this.addEventListener("EVENT_COLOR_CLICKED",this.boundOnColorClick),this.linkElements.length&&Array.from(this.linkElements).forEach((e=>{e.addEventListener("click",this.boundOnPDPLinkClick)})),this.bundlePopinLink&&(this.boundBundlePopinLinkClick=v.bind(null,this),this.bundlePopinLink.addEventListener("click",this.boundBundlePopinLinkClick))}unbindEvent(){this.removeEventListener("EVENT_COLOR_CLICKED",this.boundOnColorClick),this.linkElements?.length&&(Array.from(this.linkElements).forEach((e=>{e.removeEventListener("click",this.boundOnPDPLinkClick)})),this.linkElements=[]),this.bundlePopinLink&&this.bundlePopinLink.removeEventListener("click",this.boundBundlePopinLinkClick)}disconnectedCallback(){this.unbindEvent()}}customElements.get("nb-plp-product-card")||customElements.define("nb-plp-product-card",A);class O extends HTMLElement{constructor(){super(),this.slot=this.innerHTML}connectedCallback(){this.props=e(this.attributes),this.render()}render(){const{segments:e="false",background_retina:t="https://www.nespresso.com/shared_res/agility/next-components/assets/backgrounds/barista_creation_range_L.jpg",background_desktop:n="https://www.nespresso.com/shared_res/agility/next-components/assets/backgrounds/barista_creation_range_L.jpg",background_mobile:i="https://www.nespresso.com/shared_res/agility/next-components/assets/backgrounds/barista_creation_range_L.jpg",background_tablet:s="",contrast:a="dark",name:r="",description:o="",cta_text:l="",cta_link:c=""}=this.props;this.innerHTML=`\n            <article class='cb-plp-category ${"true"===e?"wSegments":"woSegments"}'>\n                <nb-container\n                    classname="cb-plp-category--header"\n                    contrast='${a}'\n                    background_retina='${t}'\n                    background_desktop='${n}'\n                    background_mobile='${i}'\n                    background_tablet='${s}'\n                >\n                    <header>\n                        ${r?this.renderHeading(r):""}\n                        <div class="cb-plp-category--description">\n                            ${o&&this.renderDescription(o)}\n                            ${c&&l&&this.renderCTA(c,l)}\n                        </divc>\n                    </header>\n                </nb-container>\n                <nb-container classname="cb-plp-category--coffees" contrast='light'>\n                    ${"true"===e?this.renderWithSegment():this.renderWithoutSegment()}\n                </nb-container>\n            </article>\n        `,this.setDesktopSegmentMarginTop()}setDesktopSegmentMarginTop(){let e=0,t=0;const n=this.querySelector("header");if(!n)return;const i=getComputedStyle(n);e=n.clientHeight-parseFloat(i.paddingBottom);const s=n.querySelector("h1");if(!s)return;const a=getComputedStyle(s);t=s.clientHeight+parseFloat(a.marginBottom);const r=e-t;n.closest(".cb-plp-category").style.setProperty("--woSegments-coffees-margin-top","-"+r+"px")}renderWithSegment(){return`${this.slot}`}renderWithoutSegment(){return`<div class="cb-plp-category--segment">\n            <div class='cb-plp-category--side'></div>\n            <div class='cb-plp-category--center'>${this.slot}</div>\n        </div>`}renderHeading(e){return`<h2 class="h-2xl-700-sl cb-plp-category--title">${e}</h2>`}renderDescription(e){return`<p class="t-md-400">${e}</p>`}renderCTA(e,t){const{contrast:n}=this.props;return`<nb-link class="top-range-link" color='${"dark"===n?"white":"black"}' size='large' link='${e}' seo_label="${t}">${t}</nb-link>`}}customElements.get("nb-plp-category")||customElements.define("nb-plp-category",O);class W extends class{constructor(e,t){this.observer=new IntersectionObserver((e=>this.onChange(e)),{threshold:[0],rootMargin:"0% 0%"}),this.el=e,this.data=t,this.el instanceof Element&&this.observer.observe(this.el)}onChange(e){e.forEach((e=>{e.isIntersecting&&(this.track(e),this.observer.unobserve(e.target))}))}track(){window.requestIdleCallback((()=>this.runTrack()))}runTrack(){this.data.id&&null!==this.data.id&&""!==this.data.id&&T({ecommerce:{promoView:{promotions:[this.data]}}})}}{constructor(e,t){super(e),this.data=t}runTrack(){this.data.id&&null!==this.data.id&&""!==this.data.id&&T({ecommerce:{promoView:{promotions:[this.data]}}})}}const D=(e,t)=>{if(!e||!t)return{};const{images:n,name:i,headline:s,description:a}=e,{api_override:r}=t;return r?{image:r?.image||n?.icon||n?.url,name:r?.name||i,headline:r?.headline||s,description:r?.description||a}:{}};const V=({technologies:e})=>e.indexOf("original")?14:12,B=(e,t,n,i,s)=>{const{bundle_details:a}=t,{options:r}=n,{show_sleeve_price:o}=r,l=$(e),{showCapsulePrice:c,price_per_capsule:d,price:h}=function(e,t,n){let i,s,a=e;const r=n(t);return e&&"capsule"===t.type&&!r?(i=!1===r?t.price*t.salesMultiple:t.price,i=Math.round(100*i)/100,s=t.price):(a=!1,i=t.price),{showCapsulePrice:a,price:i,price_per_capsule:s}}(o,e,$),p={bundled:l,intensity:e.capsuleProperties?.intensity||e.intensity||null,max_intensity:V(e),price_per_capsule:d?i.short(s,d):null,show_capsule_price:c};return o&&(p.price=i.short(s,h)),a&&(p.bundle_details=a),p},H=e=>e.name.indexOf("110")>-1?"110":"220",q=e=>({category:e.colorCategories&&e.colorCategories[0]?e.colorCategories[0]:null,name:e.colorShade?e.colorShade.name:null,code:e.colorShade?e.colorShade.cssColorCode:null,sku:e.internationalId,link:e.url}),z=(e,t,n)=>{const i=H(n),s=t.filter((e=>e.label!==i));if(!s||!s.length)return t;const a=s.pop().label,r=n.name.replace(i,a),o=e.find((e=>e.name===r&&n.colorShade.cssColorCode===e.colorShade.cssColorCode));if(!o)return t;const{url:l=""}=o;return t.map((e=>(e.label!==i?(e.url=l,e.selected=!1):e.selected=!0,e)))},R=(e,t,n,i,s)=>{const{options:a}=n,{variant:r,labels:o,strikethrough_price:l,additional_message:c,additional_message_icon:d,additional_message_link:p}=t;let u={sku:e.internationalId,technologies:e.technologies,longSku:e.id,name:e.name,headline:h(e.headline),sales_multiple:e.salesMultiple,unit_quantity:e.unitQuantity,type:e.type,category_name:e.rangeData?.name||"",label_range:e.rangeData?.name||"",price:e.price?i.short(s,e.price):null,strikethrough_price:l||"",variation:"plp",image_alt_text:e.name,image:e.images?.icon,additional_message:c||"",additional_message_icon:d||"",additional_message_link:p||{},...D(e,t)};o&&o.length&&(u.labels=o),e.highlighted&&(u.highlighted=e.highlighted);let _={};return"capsule"===e.type?_=B(e,t,n,i,s):"machine"===e.type?_=((e,t,n)=>{const{strikethrough_price:i,variant:s}=t,{show_voltage:a,voltage_label:r,a11y_voltage_label:o,voltage_list:l}=s,{colorVariants:c,ratingsAndReviews:d}=e;let h={ratings:d};if(a){const t=H(e),n=z(c,l,e),i=c.filter((e=>e.name.indexOf(t)>-1)).map((e=>q(e)));h={...h,colors:i,show_voltage:a,voltage_label:r,a11y_voltage_label:o,voltage_list:n}}return h.colors&&(h.activeSku=e.internationalId,h.colors=h.colors?h.colors:c.map((e=>q(e))),h.max_colors=99),h.strikethrough_price=i||"",h.show_ratings=n&&n.options.show_ratings||!1,h.minimum_rating=n&&n.options.minimum_rating||0,h})(e,t,n):"accessory"===e.type?_={}:"giftcard"===e.type&&(_=((e,t)=>{const{variant:n}=t;return{image:n&&n.default_image}})(0,t)),{...e,...a,...r,...u,..._}};async function j(){return napi.market().read()}async function F(){return napi.priceFormat()}class G extends HTMLElement{constructor(){super(),this.props={},this.currency=null,this.priceFormatter=null}connectedCallback(){this.props=e(this.attributes),this.render(),this.loadProducts().then()}async loadProducts(){const e=await Promise.all([j(),F()]),[{currency:t},n]=e;this.currency=t,this.priceFormatter=n,await this.renderProducts(),this.initTracking()}render(){const{layout:e={}}=this.props;this.innerHTML=`<div class="nb-product-grid ${e.padding_top} ${e.padding_bottom}">${this.renderCategoryContainer()}</div>\n        `,this.productContainer=this.querySelector(".nb-pcg-grid")}renderCategoryContainer(){const{copywriting:e={},layout:t={contrast:"dark"}}=this.props,{contrast:n,background:i={}}=t,{heading:s="",description:a="",link:r}=e,o=r&&r.label||"",l=r&&r.link||"",c=r&&r.seo_label||o||"";return`<nb-plp-category\n                        name="${s}"\n                        description="${a}"\n                        background_retina="${i.retina}"\n                        background_desktop="${i.desktop}"\n                        background_tablet="${i.tablet}"\n                        background_mobile="${i.mobile}"\n                        cta_text="${o}"\n                        cta_link="${l}"\n                        contrast="${n}">\n                        <div class='nb-pcg-grid'></div>\n                        ${o&&l?`<nb-link link='${l}' size='large' color='gold' class='bottom-range-link' seo_label="${c}">${o}</nb-link>`:""}\n                    </nb-plp-category>`}renderProducts(){this.props.products.forEach((async(e,t)=>{const n=await w(e.sku).catch((()=>{this.props.products.splice(this.props.products.indexOf(e.sku),1),console.error(`getProduct fail on sku ${e.sku}`)}));if(!n)return;const i=R(n,e,this.props,this.priceFormatter,this.currency);this.renderProductElement(i,t)}))}renderProductElement(e,t){const n=(({type:e})=>{let t="nb-sku";return"capsule"===e?t="nb-sku-coffee":"machine"===e?t="nb-sku-machine":"accessory"===e?t="nb-sku-accessory":"giftcard"===e&&(t="nb-sku-gift-card"),t})(e),i=document.createElement(n);i.setAttribute("data",JSON.stringify(e));const s=this.productContainer.children;t>s.length-1?this.productContainer.appendChild(i):this.productContainer.insertBefore(i,s[t])}initTracking(){const{campaign:e={}}=this.props;!function(e,t){const n=new W(e,t)}(this,{id:e.id,name:e.name,position:e.position,creative:e.creative})}}customElements.get("nb-product-grid")||customElements.define("nb-product-grid",G);export{G as default};
