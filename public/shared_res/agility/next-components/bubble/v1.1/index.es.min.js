const e=e=>{const s=(e=>e.find((e=>"data"===e.nodeName)))([...e]),a=[...e].filter((e=>"data"!==e.nodeName)).reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{});if(t(s))return a;try{return{...a,...JSON.parse(s.nodeValue)}}catch(e){console.log("ERROR: No data",e)}},t=e=>null==e,s=(e,t)=>{const{ref:s}=t.dataset,n=s.match(/(\w+)\[(.+)\]/);return null!==n?a(e,t,n):{...e,[t.dataset.ref]:t}},a=(e,t,[,s,a])=>(void 0===e[s]&&(e[s]=[]),e[s][a]=t,e);class n extends HTMLElement{constructor(){super(),this.template=""}connectedCallback(){this.props=this._createProps(),this.onStart?.(),this.loadTemplate(),this.onReady?.()}_createProps(e=null){const t=e||this.attributes;let s;try{s=[...t].reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{});const e=[...t].find((e=>"data"===e.nodeName));return null==e?s:{...s,...JSON.parse(e.nodeValue)}}catch(e){console.log("ERROR: No data",e)}}render(e=!1){e&&(this.innerHTML="");const t=(e,s)=>{const a=e=>3===e.nodeType?"text":8===e.nodeType?"comment":e.tagName.toLowerCase(),n=e=>e.childNodes&&e.childNodes.length>0?null:e.textContent;var l=Array.prototype.slice.call(s.childNodes),i=Array.prototype.slice.call(e.childNodes),r=l.length-i.length;if(r>0)for(;r>0;r--)l[l.length-r].parentNode.removeChild(l[l.length-r]);i.forEach((function(e,i){if(l[i])if(a(e)===a(l[i])){var r=n(e);if(r&&r!==n(l[i])&&(l[i].textContent=r),l[i].childNodes.length>0&&e.childNodes.length<1)l[i].innerHTML="";else{if(l[i].childNodes.length<1&&e.childNodes.length>0){var o=document.createDocumentFragment();return t(e,o),void l[i].appendChild(o)}e.childNodes.length>0&&t(e,l[i])}}else l[i].parentNode.replaceChild(e.cloneNode(!0),l[i]);else s.appendChild(e.cloneNode(!0))}))},s=(a=this.template,(new DOMParser).parseFromString(a,"text/html").body);var a;t(s,this)}loadTemplate(e="",t=!1){this.template=""===e?this.template:`${e}`,this.render(t)}disconnectedCallback(){this.onDestroy?.()}}customElements.get("nb-nespresso-element")||customElements.define("nb-nespresso-element",n);const l={get is(){const{innerWidth:e,devicePixelRatio:t}=window;return{mobile:e<768,mobile_tablet:e<1024,tablet:e>=768&&e<1024,desktop:e>=1024&&t<=1,retina:e>=1024&&t>1}},lt:e=>window.innerWidth<e};class i extends HTMLElement{constructor(){super(),this.baseClass="nb-bubble",this.boundOnSelected=this.onSelected.bind(this)}static get observedAttributes(){return["state"]}attributeChangedCallback(e){"state"===e&&this.updateState()}connectedCallback(){this.props=e(this.attributes),this.classes=this.createClasses(),this.render(),this.refs=[...this.querySelectorAll("[data-ref]")].reduce(s,{}),this.bindEvent(),this.initLazyLoad()}initLazyLoad(){let{visual:{src:e="",src_retina:t=""}={}}=this.props;const{visual:s}=this.refs;l.is.retina&&t&&(e=t),s&&e&&function(e,t,s,a,n){const l=(t,s)=>{e.setAttribute(t,s);const l=()=>e.classList.add("lazy-loaded");if(a){const t=new Image;return t.src=a,t.onload=l,void(t.onerror=()=>{n&&n(`Image ${a} cannot be loaded.`),e.classList.add("lazy-loaded-error")})}l()};if(/Trident\/|MSIE/.test(window.navigator.userAgent)||(i=window.navigator.userAgent,r=i.indexOf("OS "),(i.indexOf("iPhone")>-1||i.indexOf("iPad")>-1)&&r>-1&&window.Number(i.substr(r+3,3).replace("_","."))<14))l(t,s);else if("IntersectionObserver"in window){e.classList.add("lazy-load");let a=new IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting&&(l(t,s),a.unobserve(e.target))}))}));a.observe(e)}else l(t,s);var i,r}(s,"src",`${e}`,e)}createClasses(){const{state:e="default"}=this.props;return{base:`${this.baseClass} ${this.baseClass}--${e}`,label:this.getLabelClassName(),theme:`${this.baseClass}__theme`,visual:`${this.baseClass}__visual `,avatar:`${this.baseClass}__avatar`,outline:`${this.baseClass}__outline`}}getLabelClassName(){const{state:e="default"}=this.props,t=["selected","focus"].includes(e);return[`${this.baseClass}__label`,t?"t-xs-700-sl":"t-xs-500-sl"].join(" ")}render(){this.innerHTML=`\n            <div data-ref="button" class='${this.classes.base}'>\n                <div class='${this.classes.avatar}'>\n                    <div class='${this.classes.outline}'></div>\n                    ${this.renderBackground()}\n                    ${this.renderVisual()}\n                </div>\n                ${this.renderLabel()}\n            </div>\n        `}renderBackground(){const{theme:e="#e1dad0"}=this.props;return`\n            <div\n                class='${this.classes.theme}'\n                style='background-color: ${e};'\n            ></div>\n        `}renderVisual(){const{visual:{alt:e="",src:t=""}={}}=this.props;return`${t&&`<img class="${this.classes.visual}" src="" alt="${e}" data-ref="visual"/>`}`}renderLabel(){const{label:e}=this.props;return`${e&&`<div class="${this.classes.label}" data-ref="label">${e}</div>`}`}updateState(){if(this.refs){const{button:t,label:s}=this.refs;t.className="",s.className="",this.props=e(this.attributes),this.classes=this.createClasses(),t.className=this.classes.base,s.className=this.classes.label}}bindEvent(){window.addEventListener("EVENT_BUBBLE_SELECTED",this.boundOnSelected)}unbindEvent(){window.removeEventListener("EVENT_BUBBLE_SELECTED",this.boundOnSelected)}onSelected(e){const t=(e=>{if(e.detail)return e.detail})(e),{bubble:s}=t;this.setAttribute("state",s===this?"selected":"default")}disconnectedCallback(){this.unbindEvent()}}customElements.get("nb-bubble")||customElements.define("nb-bubble",i);export{i as default};
