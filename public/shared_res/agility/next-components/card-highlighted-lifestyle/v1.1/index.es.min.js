const e=e=>t(JSON.stringify(e)),t=e=>e?e.toString().replace(/"/g,"&quot;").replace(/'/g,"&apos;"):"",n=e=>{const t=(e=>e.find((e=>"data"===e.nodeName)))([...e]),n=[...e].filter((e=>"data"!==e.nodeName)).reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{});if(s(t))return n;try{return{...n,...JSON.parse(t.nodeValue)}}catch(e){console.log("ERROR: No data",e)}},s=e=>null==e;window.gtmDataObject=window.gtmDataObject||[];const i=e=>{window.gtmDataObject.push({event:"impression",eventRaisedBy:"Web component",eventAction:"Promo Impression - On Scroll",ecommerce:{},...e})};class r extends class{constructor(e,t){this.observer=new IntersectionObserver((e=>this.onChange(e)),{threshold:[0],rootMargin:"0% 0%"}),this.el=e,this.data=t,this.el instanceof Element&&this.observer.observe(this.el)}onChange(e){e.forEach((e=>{e.isIntersecting&&(this.track(e),this.observer.unobserve(e.target))}))}track(){window.requestIdleCallback((()=>this.runTrack()))}runTrack(){this.data.id&&null!==this.data.id&&""!==this.data.id&&i({ecommerce:{promoView:{promotions:[this.data]}}})}}{constructor(e,t){super(e),this.data=t}runTrack(){this.data.id&&null!==this.data.id&&""!==this.data.id&&i({ecommerce:{promoView:{promotions:[this.data]}}})}}class a extends HTMLElement{constructor(){super(),this.template=""}connectedCallback(){this.props=this._createProps(),this.onStart?.(),this.loadTemplate(),this.onReady?.()}_createProps(e=null){const t=e||this.attributes;let n;try{n=[...t].reduce(((e,t)=>({...e,[t.nodeName]:t.nodeValue})),{});const e=[...t].find((e=>"data"===e.nodeName));return null==e?n:{...n,...JSON.parse(e.nodeValue)}}catch(e){console.log("ERROR: No data",e)}}render(e=!1){e&&(this.innerHTML="");const t=(e,n)=>{const s=e=>3===e.nodeType?"text":8===e.nodeType?"comment":e.tagName.toLowerCase(),i=e=>e.childNodes&&e.childNodes.length>0?null:e.textContent;var r=Array.prototype.slice.call(n.childNodes),a=Array.prototype.slice.call(e.childNodes),o=r.length-a.length;if(o>0)for(;o>0;o--)r[r.length-o].parentNode.removeChild(r[r.length-o]);a.forEach((function(e,a){if(r[a])if(s(e)===s(r[a])){var o=i(e);if(o&&o!==i(r[a])&&(r[a].textContent=o),r[a].childNodes.length>0&&e.childNodes.length<1)r[a].innerHTML="";else{if(r[a].childNodes.length<1&&e.childNodes.length>0){var c=document.createDocumentFragment();return t(e,c),void r[a].appendChild(c)}e.childNodes.length>0&&t(e,r[a])}}else r[a].parentNode.replaceChild(e.cloneNode(!0),r[a]);else n.appendChild(e.cloneNode(!0))}))},n=(s=this.template,(new DOMParser).parseFromString(s,"text/html").body);var s;t(n,this)}loadTemplate(e="",t=!1){this.template=""===e?this.template:`${e}`,this.render(t)}disconnectedCallback(){this.onDestroy?.()}}customElements.get("nb-nespresso-element")||customElements.define("nb-nespresso-element",a);const o={get is(){const{innerWidth:e,devicePixelRatio:t}=window;return{mobile:e<768,mobile_tablet:e<1024,tablet:e>=768&&e<1024,desktop:e>=1024&&t<=1,retina:e>=1024&&t>1}},lt:e=>window.innerWidth<e},c={getResponsiveSrc:e=>{const t=(n=e,Array.isArray(n)||"object"==typeof n?["mobile","tablet","desktop","retina"].find((e=>!0===o.is[e]&&e in n&&""!==n[e])):null);var n;return t?e[t]:e.desktop}};class d extends HTMLElement{constructor(){super(),this.boundHandleClick=this.handleClick.bind(this)}connectedCallback(){this.props=n(this.attributes),this.render(),this.initTracking()}setContrast(){const{contrast:e="light"}=this.props.layout;this.contrast=e,this.setAttribute("contrast",this.contrast)}createClasses(){const e=Object.keys(o.is).filter((e=>o.is[e])).join(" ");return["nb-card",`nb-card--${this.contrast}`,`${e}`].join(" ")}createStyles(){const{background:e}=this.props.layout,t=e?c.getResponsiveSrc(e):"";return e?`style="background-image: url('${t}')"`:""}render(){this.setContrast();const e=o.is.tablet?this.renderTablet():this.renderDefault(),t=this.createClasses(),n=this.createStyles();this.innerHTML=`<div class="${t}" ${n}>\n                            ${e}\n                         </div>`,this.applyClassHelpers(),this.cta=this.querySelector(".nb-card__cta"),this.bindEvents()}applyClassHelpers(){}renderDefault(){return`${this.renderHeading()}\n                ${this.renderText()}\n                ${this.renderVisual()}\n                ${this.renderActions()}\n                ${this.renderPopin()}`}renderTablet(){return`${this.renderVisual()}\n                <div class="nb-card__tabletRightCol">\n                    ${this.renderHeading()}\n                    ${this.renderText()}\n                    ${this.renderActions()}\n                    ${this.renderPopin()}\n                </div>`}renderHeading(){const{heading:e=""}=this.props.copywriting;return e&&`<h2 class="nb-card__heading">${e}</h2>`}renderText(){const{text:e=""}=this.props.copywriting;return e&&`<p  class="nb-card__body">${e}</p>`}renderVisual(){const{src:e="",alt:t=""}=this.props.copywriting.visual;return e&&`<img loading="lazy" class="nb-card__visual" src="${e}" alt="${t}" />`}renderActions(){const{cta:e={}}=this.props.copywriting,{label:t=""}=e,{copywriting:{popin:n={}}={}}=this.props,{text:s=""}=n;return""!==t||s?`<div class='nb-card__actions'>\n                    ${this.renderCta()}\n                    ${this.renderLink()}\n                </div>`:""}renderCta(){const{cta:t={}}=this.props.copywriting,{label:n=""}=t;if(""===n)return"";const{campaign:s}=this.props;if(s){const{id:e,name:n,creative:i,position:r}=s;t.campaign_id=e,t.campaign_name=n,t.campaign_creative=i,t.campaign_position=r}return`<nb-cta class="nb-card__cta" data="${e(t)}">${n}</nb-cta>`}renderLink(){const{copywriting:e,campaign:t}=this.props,{popin:n={}}=e,{id:s="",text:i=""}=n;return i?`\n            <nb-link\n                campaign_id="${t.id||""}"\n                campaign_name="${t.name||""}"\n                campaign_position="${t.position||""}"\n                campaign_creative="${t.creative||""}"\n                size="xsmall"\n                color="${"light"===this.contrast?"black":"white"}"\n                popin_id="${s}"\n                class="nb-card__link"\n            >${i}</nb-link>\n        `:""}renderPopin(){const{copywriting:{popin:e={}}={}}=this.props,{id:t="",image:n="",heading:s="",description:i="",image_alt:r="",close:a=""}=e;return t&&`<nb-popin\n                id="${t}"\n                heading="${s}"\n                variation="next"\n                bgcolor="highlight"\n                label_close="${a}"\n            >\n                ${n&&`<div class="popin-header-img"><img\n                        loading="lazy"\n                        src="${n}"\n                        alt="${r}"\n                        title="${r}"\n                        width="300"\n                        height="225"\n                    /></div>\n                `}\n                ${i}\n            </nb-popin>`}initTracking(){const{campaign:e}=this.props;if(!e)return;const{id:t,name:n,creative:s,position:i}=e;!function(e,t){const n=new r(e,t)}(this,{id:t,name:n,position:i,creative:s})}handleClick(){this.querySelector(".nb-card__cta > *").click()}bindEvents(){if(this.unbindEvents(),this.cta){const e=document.createElement("div");e.classList.add("nb-card__overlay");const t=this.querySelector(".nb-card__actions");t.parentNode.insertBefore(e,t),e.addEventListener("click",this.boundHandleClick)}}unbindEvents(){this.cta&&this.removeEventListener("click",this.boundHandleClick)}disconnectedCallback(){this.unbindEvents()}}customElements.get("nb-card")||customElements.define("nb-card",d);customElements.get("nb-card-lifestyle")||customElements.define("nb-card-lifestyle",class extends d{constructor(){super(),this.classList.add("nb-card-lifestyle")}setContrast(){const{background_color:e}=this.props.layout;let t="light";"festive-blue"!==e&&"festive-red"!==e||(t="dark"),this.contrast=t,this.setAttribute("contrast",this.contrast)}renderDefault(){return this.applyLayoutSettings(),`<div class="nb-card-lifestyle--content">\n                    ${this.renderHeading()}\n                    ${this.renderText()}\n                    ${this.renderActions()}\n                    ${this.renderPopin()}\n                </div>\n                ${this.renderVisual()}`}renderTablet(){return this.applyLayoutSettings(),`${this.renderVisual()}\n                <div class="nb-card__tabletRightCol nb-card-lifestyle--content">\n                    ${this.renderHeading()}\n                    ${this.renderText()}\n                    ${this.renderActions()}\n                    ${this.renderPopin()}\n                </div>`}applyClassHelpers(){this.querySelector(".nb-card__heading").classList.add("h-xl-300"),this.querySelector(".nb-card__body").classList.add("t-sm-400")}applyLayoutSettings(){const{background_color:e="",image_position:t}=this.props.layout;""!==e&&this.classList.add(`nb-card-lifestyle--${e}`),"reverse"===t&&this.classList.add("nb-card-lifestyle-reverse")}});class l extends HTMLElement{constructor(){super(),this.slot=this.innerHTML}connectedCallback(){this.props=n(this.attributes),this.classList.add("nb-layout-cards"),this.render()}render(){const{layout:e}=this.props,t=this.slot;this.innerHTML=`\n            <nb-container\n                element_class="nb-layout-cards-inner"\n                contrast="${e.contrast}"\n                background_color="${e.background_color}"\n                classname='${e.padding_top} ${e.padding_bottom}'\n            >\n              ${t}\n            </nb-container>\n        `}}customElements.get("nb-layout-cards")||customElements.define("nb-layout-cards",l);class h extends HTMLElement{connectedCallback(){this.style.display="block",this.props=n(this.attributes),this.render()}render(){const t=e(this.props);this.innerHTML=`\n            <nb-layout-cards data="${t}">\n                ${this.renderCards()}\n            </nb-layout-cards>\n        `}renderCards(){const{cards:e=[]}=this.props;return e.map(this.renderCard).join("")}renderCard(t){return`<nb-card-lifestyle data="${e(t)}"></nb-card-lifestyle>`}}customElements.get("nb-card-highlighted-lifestyle")||customElements.define("nb-card-highlighted-lifestyle",h);export{h as default};
