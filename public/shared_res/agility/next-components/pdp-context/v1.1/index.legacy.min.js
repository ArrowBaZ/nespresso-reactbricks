const t=t=>{const e=(t=>t.find((t=>"data"===t.nodeName)))([...t]),i=[...t].filter((t=>"data"!==t.nodeName)).reduce(((t,n)=>({...t,[n.nodeName]:n.nodeValue})),{});if(n(e))return i;try{return{...i,...JSON.parse(e.nodeValue)}}catch(t){console.log("ERROR: No data",t)}},n=t=>null==t,e=t=>t?t.toString().replace(/"/g,"&quot;").replace(/'/g,"&apos;"):"";class i extends HTMLElement{connectedCallback(){this.props=t(this.attributes),this.render()}render(){const{campaign:t,layout:n}=this.props,{id:e,creative:i,name:a,position:r}=t,{padding_top:o,padding_bottom:s,background_color:c}=n;this.innerHTML=`\n            <nb-container\n                background_color="${c}"\n                campaign_id="${e}"\n                campaign_name="${a}"\n                campaign_creative="${i}"\n                campaign_position="${r}"\n                classname="${o} ${s}"\n                contrast="light">\n                ${this.renderHeader()}\n                ${this.renderCTA()}\n            </nb-container>\n        `}renderHeader(){const{copywriting:t}=this.props,{heading:n="",alternative_logo:e="",header_description_1:i="",header_description_2:a=""}=t;return`\n            ${n||e?`${this.renderImage()}`:""}\n            ${i&&`<p class="h-lg-300-sl">${i}</p>`}\n            ${a&&`<p class="t-sm-400">${a}</p>`}\n        `}renderImage(){const{copywriting:t}=this.props,{heading:n="",alternative_logo:e="",alternative_logo_text:i=""}=t;return e?" "!==e?`<img loading="lazy" src="${e}" alt="${i}" title="${i}" role="heading" aria-level="2" />`:"":`<h2 class="h-2xl-300-sl">${n}</h2>`}renderCTA(){const{copywriting:t,campaign:n}=this.props;let{cta:i}=t;const{id:a,name:r,position:o,creative:s}=n;return i&&i.label&&i.link?(i.campaign_id=a,i.campaign_name=r,i.campaign_creative=s,i.campaign_position=o,`<nb-cta class="nb-usp_cta" data="${c=i,e(JSON.stringify(c))}">${i.label}</nb-cta`):"";var c}}customElements.get("nb-context")||customElements.define("nb-context",i);const a=()=>{const t=window[window?.padlNamespace]?.dataLayer;return t?t.app.app.market.toLocaleLowerCase():"ch"};function r(t){return t.find((t=>function(t){return g("cat/capsule-attribute-only-vertuo-next").test(t.id)}(t)))}function o(t){return t.find((t=>function(t){return g("capsule-attribute-organic-eu").test(t.id)}(t)))}function s(t){return t.find((t=>function(t){return g("capsule-attribute-rainforest").test(t.id)}(t)))}function c(t){return t.find((t=>function(t){return g("capsule-attribute-sustainability").test(t.id)}(t)))}function p(t){return t.find((t=>function(t){return g("capsule-attribute-arabica").test(t.id)}(t)))}function d(t){return t.filter((t=>function(t){return g("cat/capsule-range-label").test(t.id)}(t)))}function u(t){return t.find((t=>function(t){return g("cat/capsule-attribute-highlight").test(t.id)}(t)))}function l(t){return t.find((t=>function(t){return g("cat/capsule-range-fair-trade").test(t.id)}(t)))}function g(t){return new RegExp(t.replace(/\//g,"\\/"))}async function m(t){const{configuration:{eCommerceData:{categories:n,product:e}={}}={}}=t;if(e.ranges&&e.ranges.length>0){const t=e.ranges[0],i=n.find((n=>n.id===t));null!=i&&(e.rangeData=i)}return function(t,n){const e=d(t).map((t=>t.description));n.labels=e}(n,e),function(t,n){const e=l(t);if(!e)return;n.fairTrade=e.name}(n,e),function(t,n){if(!u(t))return;n.highlighted=!0}(n,e),function(t,n){if(!r(t))return;n.onlyVertuoNext=!0}(n,e),function(t,n){o(t)&&(n.organicEu=!0)}(n,e),function(t,n){s(t)&&(n.rainforest=!0)}(n,e),function(t,n){c(t)&&(n.sustainability=!0)}(n,e),function(t,n){p(t)&&(n.arabica=!0)}(n,e),t}async function h(){return await window.pdpData}(function(){let t="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-eu.svg";switch(a()){case"us":t="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-us.svg";break;case"ca":t="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-ca.svg";break;case"br":t="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-br.svg";break;case"jp":t="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-jp.svg";break;case"be":t="https://www.nespresso.com/shared_res/agility/commons/img/icons/logo-organic-be.png"}})();class f extends HTMLElement{constructor(){super(),this.props={},this.pdpData={}}async connectedCallback(){this.props=t(this.attributes),async function(){window.getPDPData=window.getPDPData||h}(),this.pdpData=await m(await window.getPDPData()),this.product=this.pdpData.configuration.eCommerceData.product,this.render()}render(){let t=JSON.parse(JSON.stringify(this.props));""===this.props.copywriting.header_description_1&&(t.copywriting.header_description_1=e(this.product.headline)),""===this.props.copywriting.header_description_2&&(t.copywriting.header_description_2=this.product.aromaticProfileDescription||this.product.roastingDescription||""),""===this.props.copywriting.alternative_logo_text&&(t.copywriting.alternative_logo_text=this.product.name||""),function(t,n,e,i){const a=document.createElement(e);a.setAttribute("data",JSON.stringify(n)),function(t,n,e,i,a=!0){if(a){const n=t.getElementsByTagName(e);n.length>0&&n[0].parentElement&&n[0].parentElement.removeChild(n[0])}t.children.length>=i+1?t.insertBefore(n,t.children[i]):t.appendChild(n)}(t,a,e,i)}(this,t,"nb-context",0)}}customElements.get("nb-pdp-context")||customElements.define("nb-pdp-context",f);export{f as default};
